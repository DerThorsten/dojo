/*
 * 
 *                  xxxxxxx      xxxxxxx
 *                   x:::::x    x:::::x 
 *                    x:::::x  x:::::x  
 *                     x:::::xx:::::x   
 *                      x::::::::::x    
 *                       x::::::::x     
 *                       x::::::::x     
 *                      x::::::::::x    
 *                     x:::::xx:::::x   
 *                    x:::::x  x:::::x  
 *                   x:::::x    x:::::x 
 *              THE xxxxxxx      xxxxxxx TOOLKIT
 *                    
 *                  http://www.goXTK.com
 *                   
 * Copyright (c) 2012 The X Toolkit Developers <dev@goXTK.com>
 *                   
 *    The X Toolkit (XTK) is licensed under the MIT License:
 *      http://www.opensource.org/licenses/mit-license.php
 * 
 *      "Free software" is a matter of liberty, not price.
 *      "Free" as in "free speech", not as in "free beer".
 *                                         - Richard M. Stallman
 * 
 * FUELED BY:
 *  - the wonderful Constructive Solid Geometry library by Evan Wallace (http://madebyevan.com)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/csg/LICENSE
 *
 *  - parts of the Google Closure Library (http://code.google.com/closure/library)
 *    LICENSE: https://raw.github.com/xtk/google-closure-library/master/LICENSE
 *
 *  - zlib.js, the ultimate gzip/zlib javascript implementation (https://github.com/imaya/zlib.js)
 *    LICENSE: https://raw.github.com/imaya/zlib.js/master/LICENSE
 *
 * MORE CREDITS: https://raw.github.com/xtk/X/master/LICENSE
 *
 */
function m(a){throw a;}var p=void 0,r=!0,t=null,u=!1;function aa(){return function(){}}function ba(a){return function(b){this[a]=b}}function v(a){return function(){return this[a]}}var x,ca=this;function ga(){}
function ha(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ia(a){return a!==p}function ja(a){return"array"==ha(a)}function ka(a){var b=ha(a);return"array"==b||"object"==b&&"number"==typeof a.length}function la(a){return"string"==typeof a}function y(a){return"number"==typeof a}function ma(a){return"function"==ha(a)}function oa(a){var b=typeof a;return"object"==b&&a!=t||"function"==b}function pa(a){return a[qa]||(a[qa]=++ra)}var qa="closure_uid_"+(1E9*Math.random()>>>0),ra=0;
function ta(a,b,c){return a.call.apply(a.bind,arguments)}function ua(a,b,c){a||m(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function va(a,b,c){va=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ta:ua;return va.apply(t,arguments)}
function wa(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}var xa=Date.now||function(){return+new Date};function C(a,b){var c=a.split("."),d=ca;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&ia(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}function D(a,b){function c(){}c.prototype=b.prototype;a.B=b.prototype;a.prototype=new c};function za(a,b,c){this.Ua=this.Ta=this.Sa=0;3==arguments.length?(this.Sa=Number(a),this.Ta=Number(b),this.Ua=Number(c)):a instanceof za?(this.Sa=Number(a.x()),this.Ta=Number(a.y()),this.Ua=Number(a.d())):(this.Sa=Number(a[0]),this.Ta=Number(a[1]),this.Ua=Number(a[2]))}
za.prototype={l:function(){return new za(this.Sa,this.Ta,this.Ua)},Zb:function(a){return this.Sa*a.x()+this.Ta*a.y()+this.Ua*a.d()},le:function(a,b){return Aa(this,Ba(Ca(a,this),b))},length:function(){return Math.sqrt(this.Zb(this))},lc:function(a){return new za(this.Ta*a.d()-this.Ua*a.y(),this.Ua*a.x()-this.Sa*a.d(),this.Sa*a.y()-this.Ta*a.x())},x:v("Sa"),y:v("Ta"),d:v("Ua")};function Da(a){var b=a.length();return new za(a.Sa/b,a.Ta/b,a.Ua/b)}
function Ba(a,b){return new za(a.Sa*b,a.Ta*b,a.Ua*b)}function Ca(a,b){return new za(a.Sa-b.x(),a.Ta-b.y(),a.Ua-b.d())}function Aa(a,b){return new za(a.Sa+b.x(),a.Ta+b.y(),a.Ua+b.d())}function Ea(a){return new za(-a.Sa,-a.Ta,-a.Ua)};var E=E||{};E.Yj=r;E.Ea=function(a){eval("X.DEV === undefined")||window.console.time(a)};E.xa=function(a){eval("X.DEV === undefined")||window.console.timeEnd(a)};window["X.counter"]=new function(){this.Gh=0;this.Rj=function(){return this.Gh++}};function Fa(a,b){for(var c in b){var d=b.__lookupGetter__(c),e=b.__lookupSetter__(c);c in a||(d||e?(d&&a.__defineGetter__(c,d),e&&a.__defineSetter__(c,e)):a[c]=b[c])}}var Ga=window.th;
Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return f.apply(this instanceof c?this:a||window,e.concat(d.call(arguments)))}function c(){}"function"!==typeof this&&m(new TypeError("Function.prototype.bind - what is trying to be bound is not callable"));var d=Array.prototype.slice,e=d.call(arguments,1),f=this;c.prototype=this.prototype;b.prototype=new c;return b});
for(var Ia=0,Ja=["ms","moz","webkit","o"],Ka=0;Ka<Ja.length&&!window.requestAnimationFrame;++Ka)window.requestAnimationFrame=window[Ja[Ka]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[Ja[Ka]+"CancelAnimationFrame"]||window[Ja[Ka]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a){var b=Date.now(),c=Math.max(0,16-(b-Ia)),d=window.setTimeout(function(){a(b+c)},c);Ia=b+c;return d});
window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)});
"slice"in ArrayBuffer.prototype||(ArrayBuffer.prototype.slice=function(a,b){a===p&&m(Error("Not enough arguments."));var c=b||this.byteLength;0>a&&(a=this.byteLength+a);0>c&&(c=this.byteLength+c);c<a&&(c=a=0);0>a&&(a=0);0>c&&(c=0);a>this.byteLength&&(a=this.byteLength);c>this.byteLength&&(c=this.byteLength);for(var d=new ArrayBuffer(c-a),e=new Uint8Array(this),f=new Uint8Array(d),g=a,h=0;g<c;++g,++h)f[h]=e[g];return d});C("$",Ga);C("Function.prototype.bind",Function.prototype.bind);
C("window.requestAnimationFrame",window.requestAnimationFrame);C("window.cancelAnimationFrame",window.cancelAnimationFrame);var La=0;function Ma(){}x=Ma.prototype;x.key=0;x.pc=u;x.$d=u;x.wa=function(a,b,c,d,e,f){ma(a)?this.Jg=r:a&&a.handleEvent&&ma(a.handleEvent)?this.Jg=u:m(Error("Invalid listener argument"));this.$b=a;this.Zg=b;this.src=c;this.type=d;this.capture=!!e;this.hf=f;this.$d=u;this.key=++La;this.pc=u};x.handleEvent=function(a){return this.Jg?this.$b.call(this.hf||this.src,a):this.$b.handleEvent.call(this.$b,a)};function Na(a,b){for(var c in a)b.call(p,a[c],c,a)}function Oa(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}var Pa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Qa(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Pa.length;f++)c=Pa[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};function Sa(a){if(!Ta.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(Va,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Wa,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Xa,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Ya,"&quot;"));return a}var Va=/&/g,Wa=/</g,Xa=/>/g,Ya=/\"/g,Ta=/[&<>\"]/;var Za,$a,ab,bb,cb,db,eb;function fb(){return ca.navigator?ca.navigator.userAgent:t}function gb(){return ca.navigator}bb=ab=$a=Za=u;var ib;if(ib=fb()){var jb=gb();Za=0==ib.indexOf("Opera");$a=!Za&&-1!=ib.indexOf("MSIE");ab=!Za&&-1!=ib.indexOf("WebKit");bb=!Za&&!ab&&"Gecko"==jb.product}var kb=Za,lb=$a,mb=bb,nb=ab,qb,rb=gb();qb=rb&&rb.platform||"";cb=-1!=qb.indexOf("Mac");db=-1!=qb.indexOf("Win");eb=-1!=qb.indexOf("Linux");var sb=!!gb()&&-1!=(gb().appVersion||"").indexOf("X11");
function tb(){var a=ca.document;return a?a.documentMode:p}var ub;a:{var vb="",wb;if(kb&&ca.opera)var xb=ca.opera.version,vb="function"==typeof xb?xb():xb;else if(mb?wb=/rv\:([^\);]+)(\)|;)/:lb?wb=/MSIE\s+([^\);]+)(\)|;)/:nb&&(wb=/WebKit\/(\S+)/),wb)var yb=wb.exec(fb()),vb=yb?yb[1]:"";if(lb){var zb=tb();if(zb>parseFloat(vb)){ub=String(zb);break a}}ub=vb}var Ab={};
function Bb(a){var b;if(!(b=Ab[a])){b=0;for(var c=String(ub).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",j=RegExp("(\\d*)(\\D*)","g"),k=RegExp("(\\d*)(\\D*)","g");do{var l=j.exec(g)||["","",""],n=k.exec(h)||["","",""];if(0==l[0].length&&0==n[0].length)break;b=((0==l[1].length?0:parseInt(l[1],10))<(0==n[1].length?0:parseInt(n[1],10))?-1:(0==l[1].length?0:parseInt(l[1],
10))>(0==n[1].length?0:parseInt(n[1],10))?1:0)||((0==l[2].length)<(0==n[2].length)?-1:(0==l[2].length)>(0==n[2].length)?1:0)||(l[2]<n[2]?-1:l[2]>n[2]?1:0)}while(0==b)}b=Ab[a]=0<=b}return b}var Cb=ca.document,Db=!Cb||!lb?p:tb()||("CSS1Compat"==Cb.compatMode?parseInt(ub,10):5);var Eb=!lb||lb&&9<=Db,Gb=lb&&!Bb("9");!nb||Bb("528");mb&&Bb("1.9b")||lb&&Bb("8")||kb&&Bb("9.5")||nb&&Bb("528");mb&&!Bb("8")||lb&&Bb("9");var Hb=Array.prototype,Ib=Hb.indexOf?function(a,b,c){return Hb.indexOf.call(a,b,c)}:function(a,b,c){c=c==t?0:0>c?Math.max(0,a.length+c):c;if(la(a))return!la(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Jb=Hb.forEach?function(a,b,c){Hb.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=la(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Lb=Hb.map?function(a,b,c){return Hb.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=
la(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},Mb=Hb.some?function(a,b,c){return Hb.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=la(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return r;return u};function Nb(a,b){var c=Ib(a,b);0<=c&&Hb.splice.call(a,c,1)}function Ob(a,b,c){return 2>=arguments.length?Hb.slice.call(a,b):Hb.slice.call(a,b,c)};function Pb(){0!=Qb&&(this.gl=Error().stack,pa(this))}var Qb=0;function Rb(a,b){this.type=a;this.currentTarget=this.target=b}x=Rb.prototype;x.oc=u;x.defaultPrevented=u;x.pe=r;x.stopPropagation=function(){this.oc=r};x.preventDefault=function(){this.defaultPrevented=r;this.pe=u};function Sb(a){Sb[" "](a);return a}Sb[" "]=ga;function Tb(a,b){a&&this.wa(a,b)}D(Tb,Rb);x=Tb.prototype;x.target=t;x.relatedTarget=t;x.offsetX=0;x.offsetY=0;x.clientX=0;x.clientY=0;x.screenX=0;x.screenY=0;x.button=0;x.keyCode=0;x.charCode=0;x.ctrlKey=u;x.altKey=u;x.shiftKey=u;x.metaKey=u;x.xj=u;x.mb=t;
x.wa=function(a,b){var c=this.type=a.type;Rb.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(mb){var e;a:{try{Sb(d.nodeName);e=r;break a}catch(f){}e=u}e||(d=t)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=nb||a.offsetX!==p?a.offsetX:a.layerX;this.offsetY=nb||a.offsetY!==p?a.offsetY:a.layerY;this.clientX=a.clientX!==p?a.clientX:a.pageX;this.clientY=a.clientY!==p?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.xj=cb?a.metaKey:a.ctrlKey;this.state=a.state;this.mb=a;a.defaultPrevented&&this.preventDefault();delete this.oc};x.stopPropagation=function(){Tb.B.stopPropagation.call(this);this.mb.stopPropagation?this.mb.stopPropagation():this.mb.cancelBubble=r};
x.preventDefault=function(){Tb.B.preventDefault.call(this);var a=this.mb;if(a.preventDefault)a.preventDefault();else if(a.returnValue=u,Gb)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};x.si=v("mb");var Ub={},Vb={},Wb={},Xb={};function K(a,b,c,d,e){if(ja(b)){for(var f=0;f<b.length;f++)K(a,b[f],c,d,e);return t}a=Yb(a,b,c,u,d,e);b=a.key;Ub[b]=a;return b}
function Yb(a,b,c,d,e,f){b||m(Error("Invalid event type"));e=!!e;var g=Vb;b in g||(g[b]={ka:0,Ia:0});g=g[b];e in g||(g[e]={ka:0,Ia:0},g.ka++);var g=g[e],h=pa(a),j;g.Ia++;if(g[h]){j=g[h];for(var k=0;k<j.length;k++)if(g=j[k],g.$b==c&&g.hf==f){if(g.pc)break;d||(j[k].$d=u);return j[k]}}else j=g[h]=[],g.ka++;var l=Zb,n=Eb?function(a){return l.call(n.src,n.$b,a)}:function(a){a=l.call(n.src,n.$b,a);if(!a)return a},k=n,g=new Ma;g.wa(c,k,a,b,e,f);g.$d=d;k.src=a;k.$b=g;j.push(g);Wb[h]||(Wb[h]=[]);Wb[h].push(g);
a.addEventListener?(a==ca||!a.customEvent_)&&a.addEventListener(b,k,e):a.attachEvent(b in Xb?Xb[b]:Xb[b]="on"+b,k);return g}function $b(a,b,c,d,e){if(ja(b))for(var f=0;f<b.length;f++)$b(a,b[f],c,d,e);else a=Yb(a,b,c,r,d,e),Ub[a.key]=a}function ac(a,b,c,d,e){if(ja(b))for(var f=0;f<b.length;f++)ac(a,b[f],c,d,e);else{d=!!d;a:{f=Vb;if(b in f&&(f=f[b],d in f&&(f=f[d],a=pa(a),f[a]))){a=f[a];break a}a=t}if(a)for(f=0;f<a.length;f++)if(a[f].$b==c&&a[f].capture==d&&a[f].hf==e){ec(a[f].key);break}}}
function ec(a){var b=Ub[a];if(!b||b.pc)return u;var c=b.src,d=b.type,e=b.Zg,f=b.capture;c.removeEventListener?(c==ca||!c.customEvent_)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in Xb?Xb[d]:Xb[d]="on"+d,e);c=pa(c);Wb[c]&&(e=Wb[c],Nb(e,b),0==e.length&&delete Wb[c]);b.pc=r;if(b=Vb[d][f][c])b.Rg=r,fc(d,f,c,b);delete Ub[a];return r}
function fc(a,b,c,d){if(!d.me&&d.Rg){for(var e=0,f=0;e<d.length;e++)d[e].pc?d[e].Zg.src=t:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.Rg=u;0==f&&(delete Vb[a][b][c],Vb[a][b].ka--,0==Vb[a][b].ka&&(delete Vb[a][b],Vb[a].ka--),0==Vb[a].ka&&delete Vb[a])}}function gc(a,b){var c=pa(a),d=Wb[c];if(d){var e=ia(b),f=ia(p);return e&&f?(d=Vb[b],!!d&&!!d[p]&&c in d[p]):!e&&!f?r:Mb(d,function(a){return e&&a.type==b||f&&a.capture==p})}return u}
function hc(a,b,c,d,e){var f=1;b=pa(b);if(a[b]){var g=--a.Ia,h=a[b];h.me?h.me++:h.me=1;try{for(var j=h.length,k=0;k<j;k++){var l=h[k];l&&!l.pc&&(f&=ic(l,e)!==u)}}finally{a.Ia=Math.max(g,a.Ia),h.me--,fc(c,d,b,h)}}return Boolean(f)}function ic(a,b){a.$d&&ec(a.key);return a.handleEvent(b)}
function Zb(a,b){if(a.pc)return r;var c=a.type,d=Vb;if(!(c in d))return r;var d=d[c],e,f;if(!Eb){var g;if(!(g=b))a:{g=["window","event"];for(var h=ca;e=g.shift();)if(h[e]!=t)h=h[e];else{g=t;break a}g=h}e=g;g=r in d;h=u in d;if(g){if(0>e.keyCode||e.returnValue!=p)return r;a:{var j=u;if(0==e.keyCode)try{e.keyCode=-1;break a}catch(k){j=r}if(j||e.returnValue==p)e.returnValue=r}}j=new Tb;j.wa(e,this);e=r;try{if(g){for(var l=[],n=j.currentTarget;n;n=n.parentNode)l.push(n);f=d[r];f.Ia=f.ka;for(var q=l.length-
1;!j.oc&&0<=q&&f.Ia;q--)j.currentTarget=l[q],e&=hc(f,l[q],c,r,j);if(h){f=d[u];f.Ia=f.ka;for(q=0;!j.oc&&q<l.length&&f.Ia;q++)j.currentTarget=l[q],e&=hc(f,l[q],c,u,j)}}else e=ic(a,j)}finally{l&&(l.length=0)}return e}c=new Tb(b,this);return e=ic(a,c)}var jc=0;function kc(a){return a+"_"+jc++};function lc(){Pb.call(this);this.kl={};this.el=this}D(lc,Pb);lc.prototype.customEvent_=r;x=lc.prototype;x.Bf=t;x.Gf=ba("Bf");x.addEventListener=function(a,b,c,d){K(this,a,b,c,d)};x.removeEventListener=function(a,b,c,d){ac(this,a,b,c,d)};
x.dispatchEvent=function(a){var b=a.type||a,c=Vb;if(b in c){if(la(a))a=new Rb(a,this);else if(a instanceof Rb)a.target=a.target||this;else{var d=a;a=new Rb(b,this);Qa(a,d)}var d=1,e,c=c[b],b=r in c,f;if(b){e=[];for(f=this;f;f=f.Bf)e.push(f);f=c[r];f.Ia=f.ka;for(var g=e.length-1;!a.oc&&0<=g&&f.Ia;g--)a.currentTarget=e[g],d&=hc(f,e[g],a.type,r,a)&&a.pe!=u}if(u in c)if(f=c[u],f.Ia=f.ka,b)for(g=0;!a.oc&&g<e.length&&f.Ia;g++)a.currentTarget=e[g],d&=hc(f,e[g],a.type,u,a)&&a.pe!=u;else for(e=this;!a.oc&&
e&&f.Ia;e=e.Bf)a.currentTarget=e,d&=hc(f,e,a.type,u,a)&&a.pe!=u;a=Boolean(d)}else a=r;return a};function L(){lc.call(this);this.f="base";this.ta=window["X.counter"].Rj();this.j=u}D(L,lc);L.prototype.__defineGetter__("classname",v("f"));L.prototype.__defineGetter__("id",v("ta"));C("X.base",L);function mc(a,b){this.Ra=new za(a);this.qa=new za(b)}mc.prototype={l:function(){return new mc(this.Ra.l(),this.qa.l())},nc:function(){this.qa=Ea(this.qa)}};function nc(a,b){this.qa=a;this.Hd=b}nc.prototype={l:function(){return new nc(this.qa.l(),this.Hd)},nc:function(){this.qa=Ea(this.qa);this.Hd=-this.Hd}};function oc(a,b){this.Ib=a;this.ve=b;var c=a[0].Ra,d=a[2].Ra,d=Da(Ca(a[1].Ra,c).lc(Ca(d,c)));this.Qa=new nc(d,d.Zb(c))}oc.prototype={l:function(){var a=this.Ib.map(function(a){return a.l()});return new oc(a,this.ve)},nc:function(){this.Ib.reverse().map(function(a){a.nc()});this.Qa.nc()}};
function pc(a,b,c,d,e,f){for(var g=0,h=[],j=0;j<a.Ib.length;j++){var k=b.qa.Zb(a.Ib[j].Ra)-b.Hd,k=-1E-5>k?2:1E-5<k?1:0,g=g|k;h.push(k)}switch(g){case 0:(0<b.qa.Zb(a.Qa.qa)?c:d).push(a);break;case 1:e.push(a);break;case 2:f.push(a);break;case 3:c=[];d=[];for(j=0;j<a.Ib.length;j++){var l=(j+1)%a.Ib.length,k=h[j],n=h[l],g=a.Ib[j],l=a.Ib[l];2!=k&&c.push(g);1!=k&&d.push(2!=k?g.l():g);3==(k|n)&&(k=(b.Hd-b.qa.Zb(g.Ra))/b.qa.Zb(Ca(l.Ra,g.Ra)),k=new mc(g.Ra.le(l.Ra,k),g.qa.le(l.qa,k)),c.push(k),d.push(k.l()))}3<=
c.length&&e.push(new oc(c,a.ve));3<=d.length&&f.push(new oc(d,a.ve))}};function qc(a){this.ua=this.va=this.Qa=t;this.U=[];a&&rc(this,a)}qc.prototype={l:function(){var a=new qc,b=this.Qa&&this.Qa.l();a.Qa=b;b=this.va&&this.va.l();a.va=b;b=this.ua&&this.ua.l();a.ua=b;a.ue(this.U.map(function(a){return a.l()}));return a},T:function(){for(var a=0;a<this.U.length;a++)this.U[a].nc();this.Qa.nc();this.va&&this.va.T();this.ua&&this.ua.T();a=this.va;this.va=this.ua;this.ua=a},ue:ba("U")};
function rc(a,b){if(b.length){a.Qa||(a.Qa=b[0].Qa.l());for(var c=[],d=[],e=0;e<b.length;e++)pc(b[e],a.Qa,a.U,a.U,c,d);c.length&&(a.va||(a.va=new qc),rc(a.va,c));d.length&&(a.ua||(a.ua=new qc),rc(a.ua,d))}}function sc(a){var b=a.U.slice();a.va&&(b=b.concat(sc(a.va)));a.ua&&(b=b.concat(sc(a.ua)));return b}function tc(a,b){a.U=uc(b,a.U);a.va&&tc(a.va,b);a.ua&&tc(a.ua,b)}
function uc(a,b){if(!a.Qa)return b.slice();for(var c=[],d=[],e=0;e<b.length;e++)pc(b[e],a.Qa,c,d,c,d);a.va&&(c=uc(a.va,c));d=a.ua?uc(a.ua,d):[];return c.concat(d)};function vc(){this.U=[]}function wc(a){var b=new vc;b.ue(a);return b}
vc.prototype={l:function(){var a=new vc;a.ue(this.U.map(function(a){return a.l()}));return a},Nf:function(a){var b=new qc(this.l().U);a=new qc(a.l().U);tc(b,a);tc(a,b);a.T();tc(a,b);a.T();rc(b,sc(a));return wc(sc(b))},ra:function(a){var b=new qc(this.l().U);a=new qc(a.l().U);b.T();tc(b,a);tc(a,b);a.T();tc(a,b);a.T();rc(b,sc(a));b.T();return wc(sc(b))},kf:function(a){var b=new qc(this.l().U);a=new qc(a.l().U);b.T();tc(a,b);a.T();tc(b,a);tc(a,b);rc(b,sc(a));b.T();return wc(sc(b))},inverse:function(){var a=
this.l();a.U.map(function(a){a.nc()});return a},ue:ba("U")};function xc(){L.call(this);this.f="indexer";this.Se=[];this.$k=[];this.Ka={}}D(xc,L);xc.prototype.add=function(a){a==t&&m(Error("Invalid object."));var b=window.JSON.stringify(a);b in this.Ka||(this.Ka[b]=this.Se.length,this.Se.push(a));return this.Ka[b]};xc.prototype.unique=v("Se");function yc(a){L.call(this);this.f="file";this.Td=a;this.j=r}D(yc,L);function zc(){this.pb=this.q=t}zc.prototype.__defineSetter__("file",function(a){if(a==t||ja(a)&&0==a.length)this.q=t;else{if(ja(a)){if(1==a.length){this.q=new yc(a[0]);return}this.q=Lb(a,function(a){var c=new Q;c.q=new yc(a);return c})}else this.q=new yc(a);this.pb=t}});zc.prototype.__defineGetter__("file",function(){return!this.q?"":ja(this.q)?this.q.map(function(a){return a.q.Td}):this.q.Td});
zc.prototype.__defineGetter__("filedata",function(){return ja(this.q)?this.q.map(function(a){return a.pb}):this.pb});zc.prototype.__defineSetter__("filedata",function(a){if(a==t||ja(a)&&0==a.length)this.pb=t;if(ja(a))if(1==a.length)this.pb=a[0];else{var b=this.q.length,c;for(c=0;c<b;c++)this.q[c].pb=a[c]}else this.pb=a});function Ac(a){if("function"==typeof a.xd)return a.xd();if(la(a))return a.split("");if(ka(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return Oa(a)};function Bc(a,b){this.ca={};this.Q=[];var c=arguments.length;if(1<c){c%2&&m(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.Ve(a)}x=Bc.prototype;x.ka=0;x.Pf=0;x.fe=v("ka");x.xd=function(){Dc(this);for(var a=[],b=0;b<this.Q.length;b++)a.push(this.ca[this.Q[b]]);return a};function Ec(a){for(var b=0;b<a.Q.length;b++){var c=a.Q[b];if(Fc(a.ca,c)&&a.ca[c]==u)return r}return u}x.clear=function(){this.ca={};this.Pf=this.ka=this.Q.length=0};
x.remove=function(a){return Fc(this.ca,a)?(delete this.ca[a],this.ka--,this.Pf++,this.Q.length>2*this.ka&&Dc(this),r):u};function Dc(a){if(a.ka!=a.Q.length){for(var b=0,c=0;b<a.Q.length;){var d=a.Q[b];Fc(a.ca,d)&&(a.Q[c++]=d);b++}a.Q.length=c}if(a.ka!=a.Q.length){for(var e={},c=b=0;b<a.Q.length;)d=a.Q[b],Fc(e,d)||(a.Q[c++]=d,e[d]=1),b++;a.Q.length=c}}x.get=function(a,b){return Fc(this.ca,a)?this.ca[a]:b};x.set=function(a,b){Fc(this.ca,a)||(this.ka++,this.Q.push(a),this.Pf++);this.ca[a]=b};
x.Ve=function(a){var b;if(a instanceof Bc)Dc(a),b=a.Q.concat(),a=a.xd();else{b=[];var c=0,d;for(d in a)b[c++]=d;a=Oa(a)}for(c=0;c<b.length;c++)this.set(b[c],a[c])};x.l=function(){return new Bc(this)};x.Mf=function(){for(var a=new Bc,b=0;b<this.Q.length;b++){var c=this.Q[b];a.set(this.ca[c],c)}return a};function Fc(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function Gc(){L.call(this);this.f="colortable";this.Ka=new Bc;Fa(this,new zc)}D(Gc,L);Gc.prototype.add=function(a,b,c,d,e,f){(!y(a)||!y(c)||!y(d)||!y(e)||!y(f))&&m(Error("Invalid color table entry."));this.Ka.set(a,[b,c,d,e,f]);this.j=r};Gc.prototype.get=function(a){return this.Ka.get(a)};C("X.colortable.prototype.get",Gc.prototype.get);function Hc(a,b,c){this.x=ia(a)?a:0;this.y=ia(b)?b:0;this.d=ia(c)?c:0}Hc.prototype.l=function(){return new Hc(this.x,this.y,this.d)};function U(a,b,c){this.x=a;this.y=b;this.d=c}D(U,Hc);x=U.prototype;x.l=function(){return new U(this.x,this.y,this.d)};x.Fb=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.d*this.d)};x.scale=function(a){this.x*=a;this.y*=a;this.d*=a;return this};x.T=function(){this.x=-this.x;this.y=-this.y;this.d=-this.d;return this};x.normalize=function(){return this.scale(1/this.Fb())};x.add=function(a){this.x+=a.x;this.y+=a.y;this.d+=a.d;return this};
x.ra=function(a){this.x-=a.x;this.y-=a.y;this.d-=a.d;return this};function Ic(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.d-b.d;return Math.sqrt(c*c+d*d+e*e)}function Jc(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.d-b.d;return c*c+d*d+e*e}function Kc(a,b){return new U(a.x+b.x,a.y+b.y,a.d+b.d)}function Lc(a,b){return new U(a.y*b.d-a.d*b.y,a.d*b.x-a.x*b.d,a.x*b.y-a.y*b.x)};E.m=U;x=E.m.prototype;x.l=U.prototype.l;x.Fb=U.prototype.Fb;x.scale=U.prototype.scale;x.T=U.prototype.T;x.add=U.prototype.add;x.ra=U.prototype.ra;x.normalize=function(){var a=this.Fb();return 0==a?this.scale(0):this.scale(1/a)};E.m.Zb=function(a,b){return a.x*b.x+a.y*b.y+a.d*b.d};E.m.lc=Lc;E.m.gf=Ic;E.m.le=function(a,b,c){return new U(a.x+c*(b.x-a.x),a.y+c*(b.y-a.y),a.d+c*(b.d-a.d))};E.m.prototype.__defineGetter__("xx",v("x"));E.m.prototype.__defineGetter__("yy",v("y"));
E.m.prototype.__defineGetter__("zz",v("d"));C("X.vector",E.m);C("X.vector.prototype.clone",E.m.prototype.l);C("X.vector.prototype.magnitude",E.m.prototype.Fb);C("X.vector.prototype.scale",E.m.prototype.scale);C("X.vector.prototype.invert",E.m.prototype.T);C("X.vector.prototype.normalize",E.m.prototype.normalize);C("X.vector.prototype.add",E.m.prototype.add);C("X.vector.prototype.subtract",E.m.prototype.ra);C("X.vector.dot",E.m.Zb);C("X.vector.cross",E.m.lc);C("X.vector.distance",E.m.gf);
C("X.vector.lerp",E.m.le);function Mc(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}Mc.prototype.BYTES_PER_ELEMENT=8;Mc.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};Mc.prototype.toString=Array.prototype.join;if("undefined"==typeof Float64Array){try{Mc.BYTES_PER_ELEMENT=8}catch(Nc){}Mc.prototype.BYTES_PER_ELEMENT=Mc.prototype.BYTES_PER_ELEMENT;Mc.prototype.set=Mc.prototype.set;Mc.prototype.toString=Mc.prototype.toString;C("Float64Array",Mc)};function Oc(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}Oc.prototype.BYTES_PER_ELEMENT=4;Oc.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};Oc.prototype.toString=Array.prototype.join;"undefined"==typeof Float32Array&&(Oc.BYTES_PER_ELEMENT=4,Oc.prototype.BYTES_PER_ELEMENT=Oc.prototype.BYTES_PER_ELEMENT,Oc.prototype.set=Oc.prototype.set,Oc.prototype.toString=Oc.prototype.toString,C("Float32Array",Oc));function Pc(){return new Float32Array(3)}function Qc(a,b,c){var d=Pc();d[0]=a;d[1]=b;d[2]=c;return d}function Rc(a,b){var c=a[0],d=a[1],e=a[2],c=1/Math.sqrt(c*c+d*d+e*e);b[0]=a[0]*c;b[1]=a[1]*c;b[2]=a[2]*c};function Sc(){return new Float32Array(4)}function Tc(a,b,c,d){var e=Sc();e[0]=a;e[1]=b;e[2]=c;e[3]=d;return e};function Uc(){return new Float32Array(16)}function Vc(){var a=Uc();a[0]=a[5]=a[10]=a[15]=1;return a}function Wc(a,b,c,d,e,f,g,h,j,k,l,n,q,s,A,z,G){a[0]=b;a[1]=c;a[2]=d;a[3]=e;a[4]=f;a[5]=g;a[6]=h;a[7]=j;a[8]=k;a[9]=l;a[10]=n;a[11]=q;a[12]=s;a[13]=A;a[14]=z;a[15]=G;return a}function Xc(a,b,c){b*=4;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3]}function Yc(a,b,c){b*=4;c[0]=a[b];c[1]=a[b+1];c[2]=a[b+2];c[3]=a[b+3]}function Zc(a,b,c,d,e,f){a[b]=c;a[b+4]=d;a[b+8]=e;a[b+12]=f}
function $c(a,b,c){a[b]=c[0];a[b+4]=c[1];a[b+8]=c[2];a[b+12]=c[3]}function ad(a,b,c){c[0]=a[b];c[1]=a[b+4];c[2]=a[b+8];c[3]=a[b+12]}
function bd(a,b,c){var d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],j=a[5],k=a[6],l=a[7],n=a[8],q=a[9],s=a[10],A=a[11],z=a[12],G=a[13],B=a[14];a=a[15];var I=b[0],w=b[1],H=b[2],F=b[3],J=b[4],S=b[5],N=b[6],O=b[7],ea=b[8],P=b[9],da=b[10],M=b[11],Y=b[12],R=b[13],ya=b[14];b=b[15];c[0]=d*I+h*w+n*H+z*F;c[1]=e*I+j*w+q*H+G*F;c[2]=f*I+k*w+s*H+B*F;c[3]=g*I+l*w+A*H+a*F;c[4]=d*J+h*S+n*N+z*O;c[5]=e*J+j*S+q*N+G*O;c[6]=f*J+k*S+s*N+B*O;c[7]=g*J+l*S+A*N+a*O;c[8]=d*ea+h*P+n*da+z*M;c[9]=e*ea+j*P+q*da+G*M;c[10]=f*ea+k*P+s*da+B*
M;c[11]=g*ea+l*P+A*da+a*M;c[12]=d*Y+h*R+n*ya+z*b;c[13]=e*Y+j*R+q*ya+G*b;c[14]=f*Y+k*R+s*ya+B*b;c[15]=g*Y+l*R+A*ya+a*b;return c}
function cd(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],j=a[6],k=a[7],l=a[8],n=a[9],q=a[10],s=a[11],A=a[12],z=a[13],G=a[14],B=a[15],I=c*h-d*g,w=c*j-e*g,H=c*k-f*g,F=d*j-e*h,J=d*k-f*h,S=e*k-f*j,N=l*z-n*A,O=l*G-q*A,ea=l*B-s*A,P=n*G-q*z,da=n*B-s*z,M=q*B-s*G,Y=I*M-w*da+H*P+F*ea-J*O+S*N;if(0==Y)return u;Y=1/Y;b[0]=(h*M-j*da+k*P)*Y;b[1]=(-d*M+e*da-f*P)*Y;b[2]=(z*S-G*J+B*F)*Y;b[3]=(-n*S+q*J-s*F)*Y;b[4]=(-g*M+j*ea-k*O)*Y;b[5]=(c*M-e*ea+f*O)*Y;b[6]=(-A*S+G*H-B*w)*Y;b[7]=(l*S-q*H+s*w)*Y;b[8]=(g*da-h*
ea+k*N)*Y;b[9]=(-c*da+d*ea-f*N)*Y;b[10]=(A*J-z*H+B*I)*Y;b[11]=(-l*J+n*H-s*I)*Y;b[12]=(-g*P+h*O-j*N)*Y;b[13]=(c*P-d*O+e*N)*Y;b[14]=(-A*F+z*w-G*I)*Y;b[15]=(l*F-n*w+q*I)*Y;return r}function dd(a,b,c){var d=b[0],e=b[1];b=b[2];c[0]=d*a[0]+e*a[4]+b*a[8]+a[12];c[1]=d*a[1]+e*a[5]+b*a[9]+a[13];c[2]=d*a[2]+e*a[6]+b*a[10]+a[14]}
function ed(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];c[0]=d*a[0]+e*a[4]+f*a[8]+b*a[12];c[1]=d*a[1]+e*a[5]+f*a[9]+b*a[13];c[2]=d*a[2]+e*a[6]+f*a[10]+b*a[14];c[3]=d*a[3]+e*a[7]+f*a[11]+b*a[15];return c}function fd(a,b,c,d){var e=a[1]*b+a[5]*c+a[9]*d+a[13],f=a[2]*b+a[6]*c+a[10]*d+a[14],g=a[3]*b+a[7]*c+a[11]*d+a[15];a[12]=a[0]*b+a[4]*c+a[8]*d+a[12];a[13]=e;a[14]=f;a[15]=g;return a}new Float64Array(3);new Float64Array(3);new Float64Array(4);new Float64Array(4);new Float64Array(4);new Float64Array(16);E.g={};E.g.Mg=function(a,b,c,d){c=c.ra(b);c.normalize();d=E.m.lc(c,d);d.normalize();var e=E.m.lc(d,c);e.normalize();c.T();Zc(a,0,d.x,d.y,d.d,0);Zc(a,1,e.x,e.y,e.d,0);Zc(a,2,c.x,c.y,c.d,0);fd(a,-b.x,-b.y,-b.d);return a};E.g.W=function(a,b,c,d){var e=1/(b*a[3]+c*a[7]+d*a[11]+a[15]);return new E.m((b*a[0]+c*a[4]+d*a[8]+a[12])*e,(b*a[1]+c*a[5]+d*a[9]+a[13])*e,(b*a[2]+c*a[6]+d*a[10]+a[14])*e)};
E.g.Pj=function(a,b,c){var d=new Float32Array(4),e=new Float32Array(4);ad(a,b,d);ad(a,c,e);$c(a,b,e);$c(a,c,d);return a};E.g.Oj=function(a,b,c){var d=new Float32Array(4),e=new Float32Array(4);Yc(a,b,d);Yc(a,c,e);Xc(a,b,e);Xc(a,c,d);return a};E.g.yd=Vc;E.g.l=function(a){var b=Uc();b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};
E.g.Mf=function(a,b){if(b==a){var c=a[1],d=a[2],e=a[3],f=a[6],g=a[7],h=a[11];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=c;b[6]=a[9];b[7]=a[13];b[8]=d;b[9]=f;b[11]=a[14];b[12]=e;b[13]=g;b[14]=h}else b[0]=a[0],b[1]=a[4],b[2]=a[8],b[3]=a[12],b[4]=a[1],b[5]=a[5],b[6]=a[9],b[7]=a[13],b[8]=a[2],b[9]=a[6],b[10]=a[10],b[11]=a[14],b[12]=a[3],b[13]=a[7],b[14]=a[11],b[15]=a[15];return b};
E.g.hi=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],j=a[7],k=a[8],l=a[9],n=a[10],q=a[11],s=a[12],A=a[13],z=a[14];a=a[15];return(b*g-c*f)*(n*a-q*z)-(b*h-d*f)*(l*a-q*A)+(b*j-e*f)*(l*z-n*A)+(c*h-d*g)*(k*a-q*s)-(c*j-e*g)*(k*z-n*s)+(d*j-e*h)*(k*A-l*s)};E.g.T=cd;E.g.nf=function(a,b,c,d,e){var f=b/2;b=e-d;var g=Math.sin(f);if(0==b||0==g||0==c)return a;f=Math.cos(f)/g;return Wc(a,f/c,0,0,0,0,f,0,0,0,0,-(e+d)/b,-1,0,0,-(2*d*e)/b,0)};
E.g.Ni=function(a,b,c,d,e,f,g){return Wc(a,2*f/(c-b),0,0,0,0,2*f/(e-d),0,0,(c+b)/(c-b),(e+d)/(e-d),-(g+f)/(g-f),-1,0,0,-(2*g*f)/(g-f),0)};E.g.Oi=function(a,b,c,d,e,f,g){return Wc(a,2/(c-b),0,0,0,0,2/(e-d),0,0,0,0,-2/(g-f),0,-(c+b)/(c-b),-(e+d)/(e-d),-(g+f)/(g-f),1)};E.g.multiply=bd;E.g.Qg=ed;E.g.translate=fd;E.g.scale=function(a,b,c,d){return Wc(a,a[0]*b,a[1]*b,a[2]*b,a[3]*b,a[4]*c,a[5]*c,a[6]*c,a[7]*c,a[8]*d,a[9]*d,a[10]*d,a[11]*d,a[12],a[13],a[14],a[15])};
E.g.rotate=function(a,b,c,d,e){var f=a[0],g=a[1],h=a[2],j=a[3],k=a[4],l=a[5],n=a[6],q=a[7],s=a[8],A=a[9],z=a[10],G=a[11],B=Math.cos(b),I=Math.sin(b),w=1-B;b=c*c*w+B;var H=c*d*w+e*I,F=c*e*w-d*I,J=c*d*w-e*I,S=d*d*w+B,N=d*e*w+c*I,O=c*e*w+d*I;c=d*e*w-c*I;e=e*e*w+B;return Wc(a,f*b+k*H+s*F,g*b+l*H+A*F,h*b+n*H+z*F,j*b+q*H+G*F,f*J+k*S+s*N,g*J+l*S+A*N,h*J+n*S+z*N,j*J+q*S+G*N,f*O+k*c+s*e,g*O+l*c+A*e,h*O+n*c+z*e,j*O+q*c+G*e,a[12],a[13],a[14],a[15])};
E.g.qe=function(a,b){var c=a[4],d=a[5],e=a[6],f=a[7],g=a[8],h=a[9],j=a[10],k=a[11],l=Math.cos(b),n=Math.sin(b);a[4]=c*l+g*n;a[5]=d*l+h*n;a[6]=e*l+j*n;a[7]=f*l+k*n;a[8]=c*-n+g*l;a[9]=d*-n+h*l;a[10]=e*-n+j*l;a[11]=f*-n+k*l;return a};E.g.re=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[8],h=a[9],j=a[10],k=a[11],l=Math.cos(b),n=Math.sin(b);a[0]=c*l+g*-n;a[1]=d*l+h*-n;a[2]=e*l+j*-n;a[3]=f*l+k*-n;a[8]=c*n+g*l;a[9]=d*n+h*l;a[10]=e*n+j*l;a[11]=f*n+k*l;return a};
E.g.se=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],j=a[6],k=a[7],l=Math.cos(b),n=Math.sin(b);a[0]=c*l+g*n;a[1]=d*l+h*n;a[2]=e*l+j*n;a[3]=f*l+k*n;a[4]=c*-n+g*l;a[5]=d*-n+h*l;a[6]=e*-n+j*l;a[7]=f*-n+k*l;return a};C("X.matrix.identity",E.g.yd);C("X.matrix.clone",E.g.l);C("X.matrix.transpose",E.g.Mf);C("X.matrix.determinant",E.g.hi);C("X.matrix.invert",E.g.T);C("X.matrix.multiply",E.g.multiply);C("X.matrix.multiplyByVector",E.g.W);C("X.matrix.multiplyByVec4",E.g.Qg);
C("X.matrix.makePerspective",E.g.nf);C("X.matrix.makeFrustum",E.g.Ni);C("X.matrix.makeOrtho",E.g.Oi);C("X.matrix.makeLookAt",E.g.Mg);C("X.matrix.translate",E.g.translate);C("X.matrix.scale",E.g.scale);C("X.matrix.rotate",E.g.rotate);C("X.matrix.rotateX",E.g.qe);C("X.matrix.rotateY",E.g.re);C("X.matrix.rotateZ",E.g.se);C("X.matrix.swapRows",E.g.Pj);C("X.matrix.swapCols",E.g.Oj);function gd(){L.call(this);this.f="transform";this.N=E.g.yd()}D(gd,L);gd.prototype.__defineGetter__("matrix",v("N"));gd.prototype.__defineSetter__("matrix",function(a){(a==t||!(a instanceof Float32Array))&&m(Error("Invalid matrix."));this.N=a;this.p()});x=gd.prototype;x.qe=function(a){(!y(a)||-360>a||360<a)&&m(Error("Invalid angle."));E.g.qe(this.N,a*Math.PI/180);this.p()};x.re=function(a){(!y(a)||-360>a||360<a)&&m(Error("Invalid angle."));E.g.re(this.N,a*Math.PI/180);this.p()};
x.se=function(a){(!y(a)||-360>a||360<a)&&m(Error("Invalid angle."));E.g.se(this.N,a*Math.PI/180);this.p()};x.nh=function(a){y(a)||m(Error("Invalid distance."));E.g.translate(this.N,a,0,0);this.p()};x.oh=function(a){y(a)||m(Error("Invalid distance."));E.g.translate(this.N,0,a,0);this.p()};x.ph=function(a){y(a)||m(Error("Invalid distance."));E.g.translate(this.N,0,0,a);this.p()};function hd(a,b,c){a.N[b+4*c]*=-1;a.p()}x.oi=function(){hd(this,0,0)};x.pi=function(){hd(this,1,1)};
x.qi=function(){hd(this,2,2)};x.p=function(){this.j=r};C("X.transform",gd);C("X.transform.prototype.rotateX",gd.prototype.qe);C("X.transform.prototype.rotateY",gd.prototype.re);C("X.transform.prototype.rotateZ",gd.prototype.se);C("X.transform.prototype.translateX",gd.prototype.nh);C("X.transform.prototype.translateY",gd.prototype.oh);C("X.transform.prototype.translateZ",gd.prototype.ph);C("X.transform.prototype.flipX",gd.prototype.oi);C("X.transform.prototype.flipY",gd.prototype.pi);
C("X.transform.prototype.flipZ",gd.prototype.qi);C("X.transform.prototype.modified",gd.prototype.p);function id(){L.call(this);this.f="texture";this.ib=this.Lb=this.q=t;this.Ec=this.Fc=0;this.Xc=u;Fa(this,new zc)}D(id,L);id.prototype.__defineSetter__("rawData",function(a){this.ib=a;this.j=r});id.prototype.__defineSetter__("rawDataHeight",function(a){this.Ec=a;this.j=r});id.prototype.__defineSetter__("rawDataWidth",function(a){this.Fc=a;this.j=r});id.prototype.__defineSetter__("grayscale",function(a){this.Xc=a;this.j=r});C("X.texture",id);function V(a,b){L.call(this);this.f="triplets";this.fb=Infinity;this.bb=-Infinity;this.gb=Infinity;this.cb=-Infinity;this.hb=Infinity;this.eb=-Infinity;this.Kd=[0,0,0];this.Yf=r;this.R=0;this.$=new Float32Array(a);b!=t&&(this.$=b.$.subarray(0,b.$.length),this.R=this.$.length,this.fb=b.fb,this.bb=b.bb,this.gb=b.gb,this.cb=b.cb,this.hb=b.hb,this.eb=b.eb,this.Kd=b.Kd.slice(),this.Yf=u)}D(V,L);x=V.prototype;
x.add=function(a,b,c){this.fb=Math.min(this.fb,a);this.bb=Math.max(this.bb,a);this.gb=Math.min(this.gb,b);this.cb=Math.max(this.cb,b);this.hb=Math.min(this.hb,c);this.eb=Math.max(this.eb,c);this.Kd=[(this.fb+this.bb)/2,(this.gb+this.cb)/2,(this.hb+this.eb)/2];this.Yf=u;this.j=r;this.$[this.R++]=a;this.$[this.R++]=b;this.$[this.R++]=c;return this.R/3};x.Gb=function(){if(this.R!=this.$.length){var a=new Float32Array(this.R);a.set(this.$.subarray(0,this.R));this.$=a}};
x.get=function(a){a*=3;return[this.$[a],this.$[a+1],this.$[a+2]]};x.remove=function(){m(Error("Not implemented."))};x.clear=function(){this.$=new Float32Array(this.$.length);this.j=r};V.prototype.__defineGetter__("count",function(){this.Gb();return this.$.length/3});V.prototype.__defineGetter__("length",function(){this.Gb();return this.$.length});C("X.triplets",V);C("X.triplets.prototype.add",V.prototype.add);C("X.triplets.prototype.resize",V.prototype.Gb);C("X.triplets.prototype.get",V.prototype.get);
C("X.triplets.prototype.remove",V.prototype.remove);C("X.triplets.prototype.clear",V.prototype.clear);function jd(){this.Da=kd;this.ea=new gd;this.D=[1,1,1];this.Kc=this.C=this.la=this.n=this.h=t;this.Dc=[];this.F=r;this.Cc=this.jd=1;this.tc=t;this.$c=u;this.pa=1;this.Ba=0;this.hd=r}var kd="TRIANGLES";jd.prototype.__defineSetter__("type",function(a){return this.Da=a});jd.prototype.__defineGetter__("type",v("Da"));jd.prototype.__defineGetter__("texture",function(){this.C||(this.C=new id);return this.C});jd.prototype.__defineGetter__("transform",v("ea"));jd.prototype.__defineGetter__("points",v("h"));
jd.prototype.__defineSetter__("points",ba("h"));jd.prototype.__defineGetter__("normals",v("n"));jd.prototype.__defineSetter__("normals",ba("n"));jd.prototype.__defineGetter__("colors",v("la"));jd.prototype.__defineSetter__("colors",ba("la"));jd.prototype.__defineGetter__("color",v("D"));jd.prototype.__defineSetter__("color",function(a){(a==t||!ja(a)||3!=a.length)&&m(Error("Invalid color."));for(var b=this.c,c=b.length,d=0,d=0;d<c;d++)b[d].color=a;this.D=a;this.j=r});
jd.prototype.__defineGetter__("opacity",v("pa"));jd.prototype.__defineSetter__("opacity",function(a){(!y(a)||1<a||0>a)&&m(Error("Invalid opacity."));for(var b=this.c,c=b.length,d=0,d=0;d<c;d++)b[d]!=t&&(b[d].opacity=a);this.pa=a;this.j=r});jd.prototype.__defineGetter__("caption",v("tc"));jd.prototype.__defineSetter__("caption",function(a){this.tc=a;this.j=r});jd.prototype.__defineGetter__("visible",v("F"));
jd.prototype.__defineSetter__("visible",function(a){for(var b=this.c,c=b.length,d=0,d=0;d<c;d++)b[d]!=t&&(b[d].visible=a);this.F=a;this.j=r});jd.prototype.__defineGetter__("pointsize",v("jd"));jd.prototype.__defineSetter__("pointsize",function(a){y(a)||m(Error("Invalid point size."));this.jd=a;this.j=r});jd.prototype.__defineGetter__("magicmode",v("$c"));jd.prototype.__defineSetter__("magicmode",function(a){"boolean"!=typeof a&&m(Error("Invalid magic mode setting."));this.$c=a;this.j=r});
jd.prototype.__defineGetter__("linewidth",v("Cc"));jd.prototype.__defineSetter__("linewidth",function(a){y(a)||m(Error("Invalid line width."));this.Cc=a;this.j=r});jd.prototype.__defineGetter__("pickable",v("hd"));jd.prototype.__defineSetter__("pickable",function(a){"boolean"!=typeof a&&m(Error("Invalid pickable setting."));this.hd=a;this.j=r});jd.prototype.__defineGetter__("textureCoordinateMap",v("Kc"));jd.prototype.__defineSetter__("textureCoordinateMap",ba("cl"));function ld(){this.Wa=Infinity;this.Z=this.ma=-Infinity;this.aa=Infinity;this.Qb=[0,0,0];this.Ob=[1,1,1]}ld.prototype.__defineGetter__("lowerThreshold",v("Z"));ld.prototype.__defineSetter__("lowerThreshold",ba("Z"));ld.prototype.__defineGetter__("upperThreshold",v("aa"));ld.prototype.__defineSetter__("upperThreshold",ba("aa"));ld.prototype.__defineGetter__("min",v("Wa"));ld.prototype.__defineGetter__("max",v("ma"));ld.prototype.__defineGetter__("minColor",v("Qb"));
ld.prototype.__defineSetter__("minColor",function(a){(a==t||!ja(a)||3!=a.length)&&m(Error("Invalid min. color."));this.Qb=a});ld.prototype.__defineGetter__("maxColor",v("Ob"));ld.prototype.__defineSetter__("maxColor",function(a){(a==t||!ja(a)||3!=a.length)&&m(Error("Invalid max. color."));this.Ob=a});function md(){L.call(this);this.f="scalars";this.Wc=this.H=t;this.kg=r;this.Ce=0;Fa(this,new zc);Fa(this,new ld);this.Qb=[0,1,0];this.Ob=[1,0,0]}D(md,L);md.prototype.__defineGetter__("array",v("H"));md.prototype.__defineSetter__("array",function(a){this.Wc=this.H=a;this.j=r});md.prototype.__defineGetter__("interpolation",v("Ce"));md.prototype.__defineSetter__("interpolation",ba("Ce"));C("X.scalars",md);function W(a){L.call(this);this.f="object";this.c=[];this.I=this.Fa=t;Fa(this,new jd);a!=t&&this.kc(a)}D(W,L);
W.prototype.kc=function(a){this.Da=a.Da;this.ea=new gd;this.ea.N=new Float32Array(a.ea.N);this.D=a.D.slice();a.h&&(this.h=new V(a.h.length,a.h));a.n&&(this.n=new V(a.n.length,a.n));a.la&&(this.la=new V(a.la.length,a.la));this.C=a.C;this.Kc=a.Kc;a.q&&(this.q=new yc((new String(a.q.Td)).toString()));this.pa=a.pa;this.c.length=0;var b=a.c;if(b)for(var c=b.length,d=0,d=0;d<c;d++)this.c.push(new E[b[d].f](b[d]));this.F=a.F;this.jd=a.jd;this.Cc=a.Cc;a.tc&&(this.tc=(new String(a.tc)).toString());this.$c=
a.$c;this.hd=a.hd;this.Dc=a.Dc.slice();this.j=r};W.prototype.__defineGetter__("colortable",function(){this.Fa||(this.Fa=new Gc);return this.Fa});W.prototype.__defineGetter__("scalars",function(){this.I||(this.I=new md);return this.I});W.prototype.__defineGetter__("children",v("c"));W.prototype.p=function(){var a=new pd;a.O=this;this.dispatchEvent(a)};W.prototype.remove=function(){var a=new qd;a.O=this;this.dispatchEvent(a)};
function rd(a,b){(a==t||b==t||!(a instanceof W)||!(b instanceof W))&&m(Error("Fatal: Two valid X.objects are required for comparison."));return 1==a.pa?-1:1==b.pa?1:a.Ba!=t&&b.Ba!=t&&a.Ba>b.Ba?-1:1}C("X.object",W);C("X.object.prototype.modified",W.prototype.p);C("X.object.prototype.remove",W.prototype.remove);function sd(){}function td(a){for(var b=a.h.count,c=[],d=0,d=0;d<b;d+=3){var e=a.h.get(d),f=a.h.get(d+1),g=a.h.get(d+2),h=a.n.get(d),j=a.n.get(d+1),k=a.n.get(d+2),l=a.D;a.la&&0<a.la.length&&(l=a.la.get(d));var n=[];n.push(new mc(e,h));n.push(new mc(f,j));n.push(new mc(g,k));c.push(new oc(n,l))}return wc(c)}
function ud(a,b){(b==t||!(b instanceof vc))&&m(Error("Invalid CSG object."));var c=new xc,d=[];Lb(b.U,function(a){var b=[],g=a.ve,b=Lb(a.Ib,function(a){a.color=g;return c.add(a)});for(a=a=2;a<b.length;a++)d.push([b[0],b[a-1],b[a]])}.bind(a));a.Dh=Lb(c.unique(),function(a){return[a.Ra.x(),a.Ra.y(),a.Ra.d()]});a.Ch=Lb(c.unique(),function(a){return[a.qa.x(),a.qa.y(),a.qa.d()]});a.Bh=Lb(c.unique(),function(a){return!a.color?t:[a.color[0],a.color[1],a.color[2]]});a.h=new V(9*d.length);a.n=new V(9*d.length);
a.la=new V(9*d.length);Lb(d,function(a){var b=a[0],c=a[1];a=a[2];var d=this.Dh,j=this.Ch,k=this.Bh;this.h.add(d[b][0],d[b][1],d[b][2]);this.h.add(d[c][0],d[c][1],d[c][2]);this.h.add(d[a][0],d[a][1],d[a][2]);this.n.add(j[b][0],j[b][1],j[b][2]);this.n.add(j[c][0],j[c][1],j[c][2]);this.n.add(j[a][0],j[a][1],j[a][2]);k[b]&&this.la.add(k[b][0],k[b][1],k[b][2]);k[c]&&this.la.add(k[c][0],k[c][1],k[c][2]);k[a]&&this.la.add(k[a][0],k[a][1],k[a][2])}.bind(a));0==a.la.R&&(a.la=t);a.Da=kd}
sd.prototype.Nf=function(a){(a==t||!(a instanceof vc)&&!(a instanceof W))&&m(Error("Invalid object."));var b=a;a instanceof W&&(b=td(b));a=new W;Fa(a,new sd);ud(a,td(this).Nf(b));return a};sd.prototype.ra=function(a){(a==t||!(a instanceof vc)&&!(a instanceof W))&&m(Error("Invalid object."));var b=a;a instanceof W&&(b=td(b));a=new W;Fa(a,new sd);ud(a,td(this).ra(b));return a};
sd.prototype.kf=function(a){(a==t||!(a instanceof vc)&&!(a instanceof W))&&m(Error("Invalid object."));var b=a;a instanceof W&&(b=td(b));a=new W;Fa(a,new sd);ud(a,td(this).kf(b));return a};sd.prototype.inverse=function(){var a=new W;Fa(a,new sd);ud(a,td(this).inverse());return a};C("X.constructable",sd);C("X.constructable.prototype.intersect",sd.prototype.kf);C("X.constructable.prototype.inverse",sd.prototype.inverse);C("X.constructable.prototype.subtract",sd.prototype.ra);
C("X.constructable.prototype.union",sd.prototype.Nf);function vd(a){Rb.call(this,a);this.f="event"}D(vd,Rb);var wd=kc("pan"),xd=kc("rotate"),yd=kc("zoom"),zd=kc("scroll");kc("render");var Ad=kc("resetview"),Bd=kc("windowlevel"),Cd=kc("modified"),Dd=kc("remove"),Ed=kc("progress"),Fd=kc("hover"),Gd=kc("hover_end"),Hd=kc("computing"),Id=kc("computing_end"),Jd=kc("computing_progress");function Kd(){vd.call(this,Bd);this.He=this.Ue=0}D(Kd,vd);function Ld(){vd.call(this,wd);this.Ba=new E.m(0,0,0)}D(Ld,vd);
function Md(){vd.call(this,xd);this.Ba=new E.m(0,0,0)}D(Md,vd);function Nd(){vd.call(this,yd);this.dc=this.xc=u}D(Nd,vd);function Od(){vd.call(this,zd);this.ja=u}D(Od,vd);function Pd(){vd.call(this,Fd);this.Zd=this.Yd=0}D(Pd,vd);function Qd(){vd.call(this,Gd)}D(Qd,vd);function pd(){vd.call(this,Cd);this.w=this.O=t}D(pd,vd);function qd(){vd.call(this,Dd);this.w=this.O=t}D(qd,vd);function Rd(){vd.call(this,Ed);this.Te=0}D(Rd,vd);C("X.event.events.PAN",wd);C("X.event.events.ROTATE",xd);
C("X.event.events.ZOOM",yd);C("X.event.events.SCROLL",zd);function Sd(){L.call(this);this.f="parser";this.L=t;this.R=0;this.Mh=0<(new Int8Array((new Int16Array([1])).buffer))[0];this.Qd=r;this.bl=-Infinity;this.al=Infinity}D(Sd,L);Sd.prototype.parse=function(){m(Error("The function parse() should be overloaded."))};function Td(a){for(var b=Infinity,c=-Infinity,d=a.length,e=0,e=0;e<d;e++)if(!isNaN(a[e]))var f=a[e],b=Math.min(b,f),c=Math.max(c,f);return[b,c]}
function Ud(a,b,c){b===p&&(b=0);c===p&&(c=a.length);for(var d="",e=0,e=b;e<c;++e)d+=String.fromCharCode(a[e]);return d}
function Z(a,b,c){c!=t||(c=1);var d=1,e=Uint8Array;switch(b){case "schar":e=Int8Array;break;case "ushort":e=Uint16Array;d=2;break;case "sshort":e=Int16Array;d=2;break;case "uint":e=Uint32Array;d=4;break;case "sint":e=Int32Array;d=4;break;case "float":e=Float32Array;d=4;break;case "complex":e=Float64Array;d=8;break;case "double":e=Float64Array,d=8}b=new e(a.L.slice(a.R,a.R+=c*d));if(a.Mh!=a.Qd){a=b;b=new Uint8Array(a.buffer,a.byteOffset,a.byteLength);for(e=0;e<a.byteLength;e+=d)for(var f=e+d-1,g=e;f>
g;f--,g++){var h=b[g];b[g]=b[f];b[f]=h}b=a}return 1==c?b[0]:b}
function Vd(a,b){var c=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE],d=Tc(0,0,0,1),e=Sc();ed(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];d=Tc(0,0,b[2]-1,1);ed(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];d=Tc(0,b[1]-
1,0,1);ed(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];d=Tc(b[0]-1,0,0,1);ed(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];d=Tc(b[0]-1,b[1]-1,0,1);ed(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];
c[5]=e[2]>c[5]?e[2]:c[5];d=Tc(b[0]-1,0,b[2]-1,1);ed(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];d=Tc(0,b[1]-1,b[2]-1,1);ed(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];d=Tc(b[0]-1,b[1]-1,b[2]-1,1);ed(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:
c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];return c}
function Wd(a,b){var c=Vc();if(!(a.length==b.length&&a[0]==b[0]&&a[1]==b[1]&&a[2]==b[2])){var d=Math.acos(a[2]),e=Pc(),f=a[0],g=a[1],h=a[2],j=b[0],k=b[1],l=b[2];e[0]=g*l-h*k;e[1]=h*j-f*l;e[2]=f*k-g*j;Rc(e,e);f=Math.cos(d/2);g=Math.sin(d/2)*e[0];h=Math.sin(d/2)*e[1];d=Math.sin(d/2)*e[2];Zc(c,0,f*f+g*g-h*h-d*d,2*(g*h-f*d),2*(g*d+f*h),0);Zc(c,1,2*(g*h+f*d),f*f+h*h-g*g-d*d,2*(h*d-f*g),0);Zc(c,2,2*(g*d-f*h),2*(h*d+f*g),f*f+d*d-h*h-g*g,0)}d=Uc();cd(c,d);return[c,d]}
function Xd(a,b,c,d,e,f,g,h,j){var k=new Yd;Rc(c,c);for(var l=[],n=[],q=0;6>q;q++)for(var s=Math.floor(q/2),A=(s+1)%3,z=(s+2)%3,G=(4+2*s)%6,B=0;2>B;B++){var I=(2+B+2*s)%6,w=-(c[s]*(e[q]-a[s])+c[A]*(e[I]-a[A]))/c[z]+a[z];if(w>=e[G]&&w<=e[G+1]||w<=e[G]&&w>=e[G+1]){var H=[];H[s]=e[q];H[A]=e[I];H[z]=w;l.push(H)}else H=[],H[s]=e[q],H[A]=e[I],H[z]=w,n.push(H)}a=Qc(0,0,1);a=Wd(c,a);e=a[0];a=a[1];s=[];for(n=0;n<l.length;++n)q=Tc(l[n][0],l[n][1],l[n][2],1),A=Sc(),ed(e,q,A),s.push([A[0],A[1],A[2]]);e=Qc(1,
0,0);l=Pc();dd(a,e,l);n=Qc(0,1,0);e=Pc();dd(a,n,e);q=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE];for(n=n=0;n<s.length;++n)s[n][0]<q[0]&&(q[0]=s[n][0]),s[n][0]>q[1]&&(q[1]=s[n][0]),s[n][1]<q[2]&&(q[2]=s[n][1]),s[n][1]>q[3]&&(q[3]=s[n][1]),s[n][2]<q[4]&&(q[4]=s[n][2]),s[n][2]>q[5]&&(q[5]=s[n][2]);n=Tc(q[0]+(q[1]-q[0])/2,q[2]+(q[3]-q[2])/2,q[4]+(q[5]-q[4])/2,0);s=Sc();bd(a,n,s);A=Math.floor(q[0]);z=Math.ceil(q[1]);A==z&&z++;G=z-A;B=Math.floor(q[2]);
I=Math.ceil(q[3]);w=I-B;H=b[0];b=b[1];var n=Math.ceil(G/H)+1,F=Math.ceil(w/b)+1,J=new Uint8Array(4*n*F),S=new id;S.Fc=n;S.Ec=F;var F=Sc(),N=Tc(0,0,q[4],1),O=Uc();bd(g.yh,a,O);for(var ea=I-0,P=z-0,da=0,M=0,Y=0,R=B,R=B;R<=ea;R+=b){Y++;M=0;N[1]=R;for(n=A;n<=P;n+=H){M++;N[0]=n;ed(O,N,F);var ya=4*da,Ua=Math.floor(F[2]),ob=Math.floor(F[1]),pb=Math.floor(F[0]);if(0<=pb&&pb<g.Y[0]&&0<=ob&&ob<g.Y[1]&&0<=Ua&&Ua<g.Y[2]){var sa=f[Ua][ob][pb],Fb=pb=ob=Ua=0;j?((sa=j.get(sa))||(sa=[0,0.61,0,0,1]),Ua=255*sa[1],ob=
255*sa[2],pb=255*sa[3],Fb=255*sa[4]):g.Id?(Ua=sa[0],ob=sa[1],pb=sa[2],Fb=sa[3]):(Ua=ob=pb=255*(sa/g.ma),Fb=255);J[ya]=Ua;J[++ya]=ob;J[++ya]=pb;J[++ya]=Fb}else J[ya]=0,J[++ya]=0,J[++ya]=0,J[++ya]=0;da++}}S.ib=J;k.C=S;k.Vh=q;k.Ah=a;k.zh=O;k.Ih=B;k.Zk=I;k.Uh=A;k.dl=z;k.$f=M;k.Zf=Y;k.Mc=H;k.A=G;k.wc=b;k.u=w;k.v=[s[0],s[1],s[2]];k.zb=[c[0],c[1],c[2]];k.hc=[l[0],l[1],l[2]];k.ja=[e[0],e[1],e[2]];k.F=u;k.$a=g;k.Va=g.$a!=t&&!h?u:r;k.sc=d;k.lb();k.F=u;return k}
function Zd(a,b,c,d){var e;e=d.ya;for(var f=[],g=[],h=0;6>h;h++){var j=Math.floor(h/2),k=(j+1)%3,l=(j+2)%3,n=(2+2*j)%6,q=(4+2*j)%6,s=(e[h]-b[j])*(1/c[j]);if(Infinity!=s&&-Infinity!=s){var A=b[k]+c[k]*s,s=b[l]+c[l]*s;A>=e[n]&&A<=e[n+1]&&s>=e[q]&&s<=e[q+1]?(n=[],n[j]=e[h],n[k]=A,n[l]=s,f.push(n)):(n=[],n[j]=e[h],n[k]=A,n[l]=s,g.push(n))}}e=[f,g];b=e[0];d.b[a].k=e;e=Ic(new U(b[0][0],b[0][1],b[0][2]),new U(b[1][0],b[1][1],b[1][2]));d.b[a].Wk=e;f=Qc(0,0,1);g=Wd(c,f)[0];h=Tc(d.ze[0],d.ze[1],d.ze[2],0);
f=Sc();ed(g,h,f);g=Sc();h=f[2];g[0]=c[0]*h;g[1]=c[1]*h;g[2]=c[2]*h;g[3]=c[3]*h;0.5>Math.abs(f[0])&&(f[0]=0.5);0.5>Math.abs(f[1])&&(f[1]=0.5);d.b[a].Ya=[Math.abs(f[0]),Math.abs(f[1])];d.b[a].Ic=f[2];d.b[a].z=g;e=Math.floor(Math.abs(e/f[2]));d.ld[a]=e+1;d.b[a].r=e+1;d.b[a].k[0][0][0]>d.b[a].k[0][1][0]?0<g[0]&&(e=d.b[a].k[0][0],d.b[a].k[0][0]=d.b[a].k[0][1],d.b[a].k[0][1]=e):d.b[a].k[0][0][0]<d.b[a].k[0][1][0]?0>g[0]&&(e=d.b[a].k[0][0],d.b[a].k[0][0]=d.b[a].k[0][1],d.b[a].k[0][1]=e):d.b[a].k[0][0][1]>
d.b[a].k[0][1][1]?0<g[1]&&(e=d.b[a].k[0][0],d.b[a].k[0][0]=d.b[a].k[0][1],d.b[a].k[0][1]=e):d.b[a].k[0][0][1]<d.b[a].k[0][1][1]?0>g[1]&&(e=d.b[a].k[0][0],d.b[a].k[0][0]=d.b[a].k[0][1],d.b[a].k[0][1]=e):d.b[a].k[0][0][2]>d.b[a].k[0][1][2]?0<g[2]&&(e=d.b[a].k[0][0],d.b[a].k[0][0]=d.b[a].k[0][1],d.b[a].k[0][1]=e):d.b[a].k[0][0][2]<d.b[a].k[0][1][2]&&0>g[2]&&(e=d.b[a].k[0][0],d.b[a].k[0][0]=d.b[a].k[0][1],d.b[a].k[0][1]=e);d.b[a].Le=-(c[0]*b[0][0]+c[1]*b[0][1]+c[2]*b[0][2])}
function $d(a,b){E.Ea(a.f+".reslice");for(var c=b.L,d=b.Id?4:1,e=1==d,f=b.Y[0],g=b.Y[1],h=b.Y[2],j=b.sb[0],k=b.sb[1],l=b.sb[2],n=f*g*h*d,q=f*g,s=Array(f),A=Array(g),z=Array(h),G=b.e,B=0;B<f;++B)s[B]=new Uint8Array(g*h*d);for(var I=0;I<g;++I)A[I]=new Uint8Array(f*h*d);for(var w=0;w<h;++w)z[w]=new Uint8Array(f*g*d);for(var H=0,F=0;F<n;F+=d){for(var w=Math.floor(H/q),I=Math.floor(H%q/f),B=Math.floor(H%q%f),J=(B+I*g)*d,S=(B+w*f)*d,N=(I+w*g)*d,O=0;O<d;O++)s[B][N+O]=c[F+O],A[I][S+O]=c[F+O],z[w][J+O]=c[F+
O];H++}for(B=0;B<f;++B)c=new Yd,d=new id,d.Fc=g,d.Ec=h,d.ib=s[B],d.Xc=e,c.C=d,c.A=g*k,c.u=h*l,c.v=[B*j,Math.floor(g*k/2),Math.floor(h*l/2)],c.zb=[1,0,0],c.hc=[0,1,0],c.ja=[0,0,1],c.F=u,c.$a=b,c.Va=u,c.lb(),G&&(c.e=b.e.c[0].c[B]),b.c[0].c[B]=c;for(I=0;I<g;++I)c=new Yd,d=new id,d.Fc=f,d.Ec=h,d.ib=A[I],d.Xc=e,c.C=d,c.A=f*j,c.u=h*l,c.v=[Math.floor(f*j/2),I*k,Math.floor(h*l/2)],c.zb=[0,1,0],c.hc=[1,0,0],c.ja=[0,0,1],c.F=u,c.$a=b,c.Va=u,c.lb(),G&&(c.e=b.e.c[1].c[I]),b.c[1].c[I]=c;for(w=0;w<h;++w)c=new Yd,
d=new id,d.Fc=f,d.Ec=g,d.ib=z[w],d.Xc=e,c.C=d,c.A=f*j,c.u=g*k,c.v=[Math.floor(f*j/2),Math.floor(g*k/2),w*l],c.zb=[0,0,1],c.hc=[1,0,0],c.ja=[0,1,0],c.F=u,c.$a=b,c.Va=u,c.lb(),G&&(c.e=b.e.c[2].c[w]),b.c[2].c[w]=c;E.xa(a.f+".reslice")};function ae(){Sd.call(this);this.f="parserLBL"}D(ae,Sd);
ae.prototype.parse=function(a,b,c){E.Ea(this.f+".parse");var d=b.Dc,e=d.length;0==e&&m(Error("No _pointIndices defined on the X.object."));this.L=c;var f=[],g=Z(this,"uchar",c.byteLength),h=g.length,j=u,k=0;for(c=1;c<h;c++)10==g[c-1]?(k=c,j=r):j&&32==g[c]&&(f.push(parseInt(Ud(g,k,c),10)),j=u);g=b.I.H?b.I.H:new Float32Array(e);h=f.length;for(c=0;c<h;c++)g[f[c]]=1;f=new Float32Array(3*e);for(c=h=0;c<e;c++)j=d[c],j>e&&m(Error("Could not find scalar for vertex.")),j=g[j],f[h++]=j,f[h++]=j,f[h++]=j;b.I.H=
g;b.I.Wc=f;b.I.j=r;E.xa(this.f+".parse");d=new pd;d.O=b;d.w=a;this.dispatchEvent(d)};C("X.parserLBL",ae);C("X.parserLBL.prototype.parse",ae.prototype.parse);var be;function ce(a,b){var c;c=a.className;c=la(c)&&c.match(/\S+/g)||[];for(var d=Ob(arguments,1),e=c.length+d.length,f=c,g=0;g<d.length;g++)0<=Ib(f,d[g])||f.push(d[g]);a.className=c.join(" ");return c.length==e};function de(a,b){this.width=a;this.height=b}x=de.prototype;x.l=function(){return new de(this.width,this.height)};x.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};x.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};x.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};x.scale=function(a,b){var c=y(b)?b:a;this.width*=a;this.height*=c;return this};var ee=!lb||lb&&9<=Db;!mb&&!lb||lb&&lb&&9<=Db||mb&&Bb("1.9.1");lb&&Bb("9");function fe(a,b){this.x=ia(a)?a:0;this.y=ia(b)?b:0}x=fe.prototype;x.l=function(){return new fe(this.x,this.y)};function ge(a,b){return new fe(a.x-b.x,a.y-b.y)}x.ceil=function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this};x.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};x.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};
x.translate=function(a,b){a instanceof fe?(this.x+=a.x,this.y+=a.y):(this.x+=a,y(b)&&(this.y+=b));return this};x.scale=function(a,b){var c=y(b)?b:a;this.x*=a;this.y*=c;return this};function he(a){return a?new ie(ke(a)):be||(be=new ie)}function le(a){return la(a)?document.getElementById(a):a}var me={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function ne(a,b,c){return oe(document,arguments)}
function oe(a,b){var c=b[0],d=b[1];if(!ee&&d&&(d.name||d.type)){c=["<",c];d.name&&c.push(' name="',Sa(d.name),'"');if(d.type){c.push(' type="',Sa(d.type),'"');var e={};Qa(e,d);delete e.type;d=e}c.push(">");c=c.join("")}var f=a.createElement(c);d&&(la(d)?f.className=d:ja(d)?ce.apply(t,[f].concat(d)):Na(d,function(a,b){"style"==b?f.style.cssText=a:"class"==b?f.className=a:"for"==b?f.htmlFor=a:b in me?f.setAttribute(me[b],a):0==b.lastIndexOf("aria-",0)||0==b.lastIndexOf("data-",0)?f.setAttribute(b,a):
f[b]=a}));if(2<b.length){d=function(b){b&&f.appendChild(la(b)?a.createTextNode(b):b)};for(c=2;c<b.length;c++){var g=b[c];if(ka(g)&&!(oa(g)&&0<g.nodeType)){var e=Jb,h;a:{if((h=g)&&"number"==typeof h.length){if(oa(h)){h="function"==typeof h.item||"string"==typeof h.item;break a}if(ma(h)){h="function"==typeof h.item;break a}}h=u}if(h)if(h=g.length,0<h){for(var j=Array(h),k=0;k<h;k++)j[k]=g[k];g=j}else g=[];e(g,d)}else d(g)}}return f}function pe(a){return"CSS1Compat"==a.compatMode}
function qe(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function re(a){for(;a&&1!=a.nodeType;)a=a.nextSibling;return a}function se(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}function ke(a){return 9==a.nodeType?a:a.ownerDocument||a.document}function ie(a){this.ha=a||ca.document||document}x=ie.prototype;x.ge=he;
x.t=function(a){return la(a)?this.ha.getElementById(a):a};x.th=ie.prototype.t;x.Nc=function(a,b,c){return oe(this.ha,arguments)};x.createElement=function(a){return this.ha.createElement(a)};x.createTextNode=function(a){return this.ha.createTextNode(String(a))};function te(a){return pe(a.ha)}
function ue(a){var b=a.ha;a=!nb&&pe(b)?b.documentElement:b.body;b=b.parentWindow||b.defaultView;return lb&&Bb("10")&&b.pageYOffset!=a.scrollTop?new fe(a.scrollLeft,a.scrollTop):new fe(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}x.appendChild=function(a,b){a.appendChild(b)};x.contains=se;function ve(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}x=ve.prototype;x.l=function(){return new ve(this.top,this.right,this.bottom,this.left)};x.contains=function(a){return!this||!a?u:a instanceof ve?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom};
x.ceil=function(){this.top=Math.ceil(this.top);this.right=Math.ceil(this.right);this.bottom=Math.ceil(this.bottom);this.left=Math.ceil(this.left);return this};x.floor=function(){this.top=Math.floor(this.top);this.right=Math.floor(this.right);this.bottom=Math.floor(this.bottom);this.left=Math.floor(this.left);return this};x.round=function(){this.top=Math.round(this.top);this.right=Math.round(this.right);this.bottom=Math.round(this.bottom);this.left=Math.round(this.left);return this};
x.translate=function(a,b){a instanceof fe?(this.left+=a.x,this.right+=a.x,this.top+=a.y,this.bottom+=a.y):(this.left+=a,this.right+=a,y(b)&&(this.top+=b,this.bottom+=b));return this};x.scale=function(a,b){var c=y(b)?b:a;this.left*=a;this.right*=a;this.top*=c;this.bottom*=c;return this};function we(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}x=we.prototype;x.l=function(){return new we(this.left,this.top,this.width,this.height)};x.Ig=function(a){var b=Math.max(this.left,a.left),c=Math.min(this.left+this.width,a.left+a.width);if(b<=c){var d=Math.max(this.top,a.top);a=Math.min(this.top+this.height,a.top+a.height);if(d<=a)return this.left=b,this.top=d,this.width=c-b,this.height=a-d,r}return u};
x.contains=function(a){return a instanceof we?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};function xe(a,b){var c=b.x<a.left?a.left-b.x:Math.max(b.x-(a.left+a.width),0),d=b.y<a.top?a.top-b.y:Math.max(b.y-(a.top+a.height),0);return c*c+d*d}x.gf=function(a){return Math.sqrt(xe(this,a))};
x.ceil=function(){this.left=Math.ceil(this.left);this.top=Math.ceil(this.top);this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};x.floor=function(){this.left=Math.floor(this.left);this.top=Math.floor(this.top);this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};x.round=function(){this.left=Math.round(this.left);this.top=Math.round(this.top);this.width=Math.round(this.width);this.height=Math.round(this.height);return this};
x.translate=function(a,b){a instanceof fe?(this.left+=a.x,this.top+=a.y):(this.left+=a,y(b)&&(this.top+=b));return this};x.scale=function(a,b){var c=y(b)?b:a;this.left*=a;this.width*=a;this.top*=c;this.height*=c;return this};function ye(a,b){var c=ke(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,t))?c[b]||c.getPropertyValue(b)||"":""}function ze(a,b){return ye(a,b)||(a.currentStyle?a.currentStyle[b]:t)||a.style&&a.style[b]}function Ae(a){a=a?ke(a):document;return lb&&!(lb&&9<=Db)&&!te(he(a))?a.body:a.documentElement}
function Be(a){var b=a.getBoundingClientRect();lb&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function Ce(a){if(lb&&!(lb&&8<=Db))return a.offsetParent;var b=ke(a),c=ze(a,"position"),d="fixed"==c||"absolute"==c;for(a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=ze(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return t}
function De(a){for(var b=new ve(0,Infinity,Infinity,0),c=he(a),d=c.ha.body,e=c.ha.documentElement,f=!nb&&pe(c.ha)?c.ha.documentElement:c.ha.body;a=Ce(a);)if((!lb||0!=a.clientWidth)&&(!nb||0!=a.clientHeight||a!=d)&&a!=d&&a!=e&&"visible"!=ze(a,"overflow")){var g=Ee(a),h;h=a;if(mb&&!Bb("1.9")){var j=parseFloat(ye(h,"borderLeftWidth"));if(Fe(h))var k=h.offsetWidth-h.clientWidth-j-parseFloat(ye(h,"borderRightWidth")),j=j+k;h=new fe(j,parseFloat(ye(h,"borderTopWidth")))}else h=new fe(h.clientLeft,h.clientTop);
g.x+=h.x;g.y+=h.y;b.top=Math.max(b.top,g.y);b.right=Math.min(b.right,g.x+a.clientWidth);b.bottom=Math.min(b.bottom,g.y+a.clientHeight);b.left=Math.max(b.left,g.x)}d=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,d);b.top=Math.max(b.top,f);c=(c.ha.parentWindow||c.ha.defaultView||window).document;c=pe(c)?c.documentElement:c.body;c=new de(c.clientWidth,c.clientHeight);b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?
b:t}
function Ee(a){var b,c=ke(a),d=ze(a,"position"),e=mb&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new fe(0,0),g=Ae(c);if(a==g)return f;if(a.getBoundingClientRect)b=Be(a),a=ue(he(c)),f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);
if(nb&&"fixed"==ze(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(kb||nb&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=Ce(b))&&b!=c.body&&b!=g;)if(f.x-=b.scrollLeft,!kb||"TR"!=b.tagName)f.y-=b.scrollTop}return f}
function Ge(a){var b=new fe;if(1==a.nodeType){if(a.getBoundingClientRect){var c=Be(a);b.x=c.left;b.y=c.top}else{var c=ue(he(a)),d=Ee(a);b.x=d.x-c.x;b.y=d.y-c.y}if(mb&&!Bb(12)){var e;lb?e="-ms-transform":nb?e="-webkit-transform":kb?e="-o-transform":mb&&(e="-moz-transform");var f;e&&(f=ze(a,e));f||(f=ze(a,"transform"));f?(a=f.match(He),a=!a?new fe(0,0):new fe(parseFloat(a[1]),parseFloat(a[2]))):a=new fe(0,0);b=new fe(b.x+a.x,b.y+a.y)}}else e=ma(a.si),f=a,a.targetTouches?f=a.targetTouches[0]:e&&a.mb.targetTouches&&
(f=a.mb.targetTouches[0]),b.x=f.clientX,b.y=f.clientY;return b}function Ie(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}function Je(a){if("none"!=ze(a,"display"))return Ke(a);var b=a.style,c=b.display,d=b.visibility,e=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";a=Ke(a);b.display=c;b.position=e;b.visibility=d;return a}
function Ke(a){var b=a.offsetWidth,c=a.offsetHeight,d=nb&&!b&&!c;return(!ia(b)||d)&&a.getBoundingClientRect?(a=Be(a),new de(a.right-a.left,a.bottom-a.top)):new de(b,c)}function Le(a,b){a.style.display=b?"":"none"}function Fe(a){return"rtl"==ze(a,"direction")}function Me(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,d=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var e=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=d;return e}
function Ne(a,b){var c=a.currentStyle?a.currentStyle[b]:t;return c?Me(a,c):0}var Oe={thin:2,medium:4,thick:6};function Pe(a,b){if("none"==(a.currentStyle?a.currentStyle[b+"Style"]:t))return 0;var c=a.currentStyle?a.currentStyle[b+"Width"]:t;return c in Oe?Oe[c]:Me(a,c)}var He=/matrix\([0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, ([0-9\.\-]+)p?x?, ([0-9\.\-]+)p?x?\)/;function Qe(a,b){lc.call(this);this.G=a;var c=oa(this.G)&&1==this.G.nodeType?this.G:this.G?this.G.body:t;this.Li=!!c&&Fe(c);this.ml=K(this.G,mb?"DOMMouseScroll":"mousewheel",this,b)}D(Qe,lc);
Qe.prototype.handleEvent=function(a){var b=0,c=0,d=0;a=a.mb;if("mousewheel"==a.type){c=1;if(lb||nb&&(db||Bb("532.0")))c=40;d=Re(-a.wheelDelta,c);ia(a.wheelDeltaX)?(b=Re(-a.wheelDeltaX,c),c=Re(-a.wheelDeltaY,c)):c=d}else d=a.detail,100<d?d=3:-100>d&&(d=-3),ia(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=d:c=d;y(this.Ng)&&(b=Math.min(Math.max(b,-this.Ng),this.Ng));y(this.Og)&&(c=Math.min(Math.max(c,-this.Og),this.Og));this.Li&&(b=-b);b=new Se(d,a,b,c);this.dispatchEvent(b)};
function Re(a,b){return nb&&(cb||eb)&&0!=a%b?a:a/b}function Se(a,b,c,d){b&&this.wa(b,p);this.type="mousewheel";this.detail=a;this.hl=c;this.Oc=d}D(Se,Tb);lb||nb&&Bb("525");function Te(a){L.call(this);this.f="interactor";this.Ja=a;this.Je=this.eg=this.dg=this.fg=this.cg=this.gg=t;this.Ie=r;this.Vb=this.Pb=this.qb=u;this.oa=[0,0];this.De=new E.m(0,0,0);this.Yc=new E.m(0,0,0);this.Kg=0;this.ng=this.Od=t;this.mg=u;this.X={MOUSEWHEEL_ENABLED:r,MOUSECLICKS_ENABLED:r,KEYBOARD_ENABLED:r,HOVERING_ENABLED:r,CONTEXTMENU_ENABLED:u,TOUCH_ENABLED:r,TOUCH_BOUNCING_ENABLED:u}}D(Te,L);Te.prototype.__defineGetter__("config",v("X"));Te.prototype.__defineGetter__("leftButtonDown",v("qb"));
Te.prototype.__defineGetter__("middleButtonDown",v("Pb"));Te.prototype.__defineGetter__("rightButtonDown",v("Vb"));
Te.prototype.wa=function(){this.X.MOUSEWHEEL_ENABLED?(this.Je=new Qe(this.Ja),this.gg=K(this.Je,"mousewheel",this.Bd.bind(this))):(ec(this.gg),this.Je=t);this.X.MOUSECLICKS_ENABLED?(this.cg=K(this.Ja,"mousedown",this.Xi.bind(this)),this.fg=K(this.Ja,"mouseup",this.bj.bind(this))):(ec(this.cg),ec(this.fg));this.Ja.oncontextmenu=this.X.CONTEXTMENU_ENABLED?t:function(){return u};this.X.TOUCH_ENABLED?(this.X.TOUCH_BOUNCING_ENABLED||document.body.addEventListener("touchmove",function(a){a.preventDefault()},
u),this.Sh=K(this.Ja,"touchstart",this.qj.bind(this)),this.Rh=K(this.Ja,"touchmove",this.oj.bind(this)),this.Qh=K(this.Ja,"touchend",this.kj.bind(this))):(ec(this.Sh),ec(this.Rh),ec(this.Qh));ec(this.dg);ec(this.eg);this.dg=K(this.Ja,"mousemove",this.Zi.bind(this));this.eg=K(this.Ja,"mouseout",this.$i.bind(this))};Te.prototype.Xi=function(a){0==a.button?this.qb=r:1==a.button?this.Pb=r:2==a.button&&(this.Vb=r);eval("this.onMouseDown("+this.qb+","+this.Pb+","+this.Vb+")");Ue(this);a.preventDefault()};
Te.prototype.Wi=aa();Te.prototype.bj=function(a){0==a.button?this.qb=u:1==a.button?this.Pb=u:2==a.button&&(this.Vb=u);eval("this.onMouseUp("+this.qb+","+this.Pb+","+this.Vb+")");Ue(this);a.preventDefault()};Te.prototype.__defineGetter__("mousePosition",v("oa"));x=Te.prototype;x.aj=aa();x.$i=function(a){this.Vb=this.Pb=this.qb=this.Ie=u;Ue(this);this.De=new E.m(0,0,0);a.preventDefault()};x.Yi=aa();
x.qj=function(a){a.preventDefault();a.wa(a.mb.targetTouches[0],a.currentTarget);eval("this.onTouchStart("+a.clientX+","+a.clientY+")");this.Yc=new E.m(a.clientX,a.clientY,0);this.ng=setTimeout(this.mj.bind(this,a),500)};x.pj=aa();x.mj=function(a){eval("this.onTouchHover("+a.clientX+","+a.clientY+")");a=new Nd;a.xc=r;a.dc=this instanceof Ve;this.dispatchEvent(a);this.Ud=r};x.lj=aa();function We(a){clearTimeout(a.ng);if(a.Ud){var b=new Nd;b.xc=u;b.dc=a instanceof Ve;a.dispatchEvent(b)}a.Ud=u}
x.kj=function(a){a.preventDefault();eval("this.onTouchEnd()");We(this)};x.jj=aa();
x.oj=function(a){a.preventDefault();this.Ud||We(this);this.touchmoveEvent=a=a.mb;eval("this.onTouchMove(this['touchmoveEvent'])");var b=a.targetTouches;if(1==b.length){a=b[0];var c=[a.clientX,a.clientY];a=new E.m(c[0],c[1],0);var b=c[0]>3*this.Ja.clientWidth/4,d=c[0]<this.Ja.clientWidth/4,e=c[1]<this.Ja.clientHeight/4,c=c[1]>3*this.Ja.clientHeight/4,c=!b&&!d&&!e&&!c,e=this.Yc.ra(a);this.Yc=a.l();if(this.Ud)a=new Ld,5<e.x?e.x=1:-5>e.x&&(e.x=-1),5<e.y?e.y=1:-5>e.y&&(e.y=-1),a.Ba=e,this.dispatchEvent(a);
else if(this instanceof Xe&&(b||d))a=new Od,a.ja=0>e.y,this.dispatchEvent(a);else if(this instanceof Ve||c)e.scale(3),a=new Md,a.Ba=e,this.dispatchEvent(a)}else 2==b.length&&(a=b[0],b=b[1],a=[a.clientX,a.clientY],b=[b.clientX,b.clientY],a=new E.m(a[0],a[1],0),b=new E.m(b[0],b[1],0),e=Jc(a,b),b=e-this.Kg,this.Kg=e,this.Yc.ra(a),this.Yc=a.l(),10<Math.abs(b)&&(a=new Nd,a.xc=0<b,a.dc=this instanceof Ve,this.dispatchEvent(a)))};x.nj=aa();
x.Zi=function(a){this.mousemoveEvent=a;eval("this.onMouseMove(this['mousemoveEvent'])");this.Ie=r;a.preventDefault();var b=a.shiftKey;this.mg=b;this.oa=[a.offsetX,a.offsetY];var c=new E.m(this.oa[0],this.oa[1],0);a=this.De.ra(c);this.De=c.l();this.X.HOVERING_ENABLED&&((0<Math.abs(a.x)||0<Math.abs(a.y)||this.Pb||this.qb||this.Vb)&&Ue(this),this.Od=setTimeout(function(){Ue(this);var a=new Pd;a.Yd=c.x;a.Zd=c.y;this.dispatchEvent(a);this.Od=t}.bind(this),300));0!=a.Fb()&&(this.qb&&!b?(b=new Md,a.scale(3),
b.Ba=a,this.dispatchEvent(b)):this.Pb||this.qb&&b?(b=new Ld,b.Ba=a,this.dispatchEvent(b)):this.Vb&&(b=new Nd,b.xc=0<a.y,b.dc=u,this.dispatchEvent(b)))};function Ue(a){a.Od&&clearTimeout(a.Od);a.dispatchEvent(new Qd)}x.cj=aa();x.Bd=function(a){this.mouseWheelEvent=a;eval("this.onMouseWheel(this['mouseWheelEvent'])");Ue(this);a.preventDefault()};x.Ui=aa();C("X.interactor",Te);C("X.interactor.prototype.init",Te.prototype.wa);C("X.interactor.prototype.onMouseDown",Te.prototype.Wi);
C("X.interactor.prototype.onMouseUp",Te.prototype.aj);C("X.interactor.prototype.onMouseMove",Te.prototype.Yi);C("X.interactor.prototype.onMouseWheel",Te.prototype.cj);C("X.interactor.prototype.onKey",Te.prototype.Ui);C("X.interactor.prototype.onTouchStart",Te.prototype.pj);C("X.interactor.prototype.onTouchMove",Te.prototype.nj);C("X.interactor.prototype.onTouchEnd",Te.prototype.jj);C("X.interactor.prototype.onTouchHover",Te.prototype.lj);function Xe(a){Te.call(this,a);this.f="interactor2D"}D(Xe,Te);Xe.prototype.Bd=function(a){Xe.B.Bd.call(this,a);var b=new Od;a.Oc==t&&(a.Oc=0);b.ja=0>a.Oc;this.dispatchEvent(b)};function Yd(a){W.call(this);this.f="slice";this.v=[0,0,0];this.zb=[0,0,1];this.ja=[0,1,0];this.hc=[1,0,0];this.u=this.A=10;this.Kc=[0,1,0,0,1,1,1,1,1,0,0,0];this.e=this.$a=t;this.Va=r;this.sc=[1,1,1];a!=t&&this.kc(a)}D(Yd,W);Yd.prototype.kc=function(a){this.v=a.v.slice();this.zb=a.zb.slice();this.ja=a.ja.slice();this.A=a.A;this.u=a.u;this.$a=a.$a;this.e=a.e;this.Va=a.Va;this.sc=a.sc;this.Hh=a.Hh;Yd.B.kc.call(this,a)};Yd.prototype.__defineSetter__("height",ba("u"));
Yd.prototype.__defineSetter__("width",ba("A"));Yd.prototype.create=function(){this.lb()};
Yd.prototype.lb=function(){var a=(new U(this.zb[0],this.zb[1],this.zb[2])).normalize(),b=new U(this.ja[0],this.ja[1],this.ja[2]),c=new U(this.hc[0],this.hc[1],this.hc[2]),d=new U(this.v[0],this.v[1],this.v[2]),e=Kc(c.l().T().scale(this.A/2),b.l().T().scale(this.u/2)),f=new U(e.x+d.x,e.y+d.y,e.d+d.d),e=Kc(c.l().T().scale(this.A/2),b.l().scale(this.u/2)),g=new U(e.x+d.x,e.y+d.y,e.d+d.d),e=Kc(c.l().scale(this.A/2),b.l().T().scale(this.u/2)),h=new U(e.x+d.x,e.y+d.y,e.d+d.d),e=Kc(c.l().scale(this.A/2),
b.l().scale(this.u/2)),b=new U(e.x+d.x,e.y+d.y,e.d+d.d);this.h=new V(18);this.n=new V(18);this.h.add(f.x,f.y,f.d);this.h.add(g.x,g.y,g.d);this.h.add(h.x,h.y,h.d);this.h.add(h.x,h.y,h.d);this.h.add(b.x,b.y,b.d);this.h.add(g.x,g.y,g.d);this.n.add(a.x,a.y,a.d);this.n.add(a.x,a.y,a.d);this.n.add(a.x,a.y,a.d);this.n.add(a.x,a.y,a.d);this.n.add(a.x,a.y,a.d);this.n.add(a.x,a.y,a.d);this.Va&&(a=new W,a.h=new V(24),a.n=new V(24),a.h.add(f.x,f.y,f.d),a.h.add(g.x,g.y,g.d),a.h.add(g.x,g.y,g.d),a.h.add(b.x,b.y,
b.d),a.h.add(b.x,b.y,b.d),a.h.add(h.x,h.y,h.d),a.h.add(h.x,h.y,h.d),a.h.add(f.x,f.y,f.d),a.n.add(0,0,0),a.n.add(0,0,0),a.n.add(0,0,0),a.n.add(0,0,0),a.n.add(0,0,0),a.n.add(0,0,0),a.n.add(0,0,0),a.n.add(0,0,0),a.D=[this.sc[0],this.sc[1],this.sc[2]],a.Da="LINES",a.Cc=2,this.c.push(a))};C("X.slice",Yd);C("X.slice.prototype.create",Yd.prototype.create);function Q(a){W.call(this);this.f="volume";this.v=[0,0,0];this.Y=[10,10,10];this.ya=[1,1,1];this.ld=[10,10,10];this.sb=[1,1,1];this.Lb=[];this.Ac=this.Cb=this.zc=this.Bb=this.yc=this.Ab=0;this.pd=new W;this.qd=new W;this.rd=new W;this.Xd=this.Na=u;this.P=-1;this.Wd=[];this.e=t;this.Va=r;this.ga=Infinity;this.fa=-Infinity;this.lg=r;this.ma=0;this.L=this.sa=t;Fa(this,new zc);Fa(this,new ld);a!=t&&this.kc(a)}D(Q,W);
Q.prototype.kc=function(a){this.v=a.v.slice();this.Y=a.Y.slice();this.sb=a.sb.slice();this.Ab=a.Ab;this.yc=a.yc;this.Bb=a.Bb;this.zc=a.zc;this.Cb=a.Cb;this.Ac=a.Ac;this.Vf=a.Vf.slice();this.pd=new W(a.pd);this.qd=new W(a.qd);this.rd=new W(a.rd);this.ma=a.ma;this.L=a.L;this.Na=a.Na;this.Xd=a.Xd;this.P=a.P;this.e=a.e;this.Va=a.Va;Q.B.kc.call(this,a)};
Q.prototype.lb=function(a){this.c.length=0;this.pd.c.length=0;this.qd.c.length=0;this.rd.c.length=0;this.c.push(this.pd);this.c.push(this.qd);this.c.push(this.rd);this.za=a.Tc;this.ze=a.Uc;this.yb=a.Sc;this.rc=a.wb;this.yh=a.xb;this.ma=a.max;this.L=a.data;this.j=r};
Q.prototype.p=function(a){a="undefined"!==typeof a?a:r;if(0<this.c.length){this.Na!=this.Xd&&(!this.Na&&-1!=this.P&&(this.c[this.P].visible=u),this.j=r,this.Xd=this.Na);if(!this.F)return;for(var b=0,b=0;3>b;b++){var c=this.c[b],d=0,e=0;0==b?(d=this.Ab,e=this.yc,this.yc=this.Ab):1==b?(d=this.Bb,e=this.zc,this.zc=this.Bb):2==b&&(d=this.Cb,e=this.Ac,this.Ac=this.Cb);if(this.c[b].c[parseInt(d,10)]==t){var f=Pc();f[0]=this.b[b].k[0][0][0]+this.b[b].z[0]*parseInt(d,10);f[1]=this.b[b].k[0][0][1]+this.b[b].z[1]*
parseInt(d,10);f[2]=this.b[b].k[0][0][2]+this.b[b].z[2]*parseInt(d,10);if(this.ba){var g=Xd(f,this.b[b].Ya,this.b[b].i,this.b[b].D,this.ya,this.e.sa,this.e,this.e.ba,t);this.e.c[b].c[parseInt(d,10)]=g;this.e.c[b].p(r)}f=Xd(f,this.b[b].Ya,this.b[b].i,this.b[b].D,this.ya,this.sa,this,r,t);this.ba&&(f.e=f.C,f.e=this.e.c[b].c[parseInt(d,10)].C);c.c[parseInt(d,10)]=f;this.c[b].p(r)}e=c.c[parseInt(e,10)];this.Na||(e.visible=u);c=c.c[parseInt(d,10)];c.visible=r;c.pa=1;this.Na&&b!=this.P&&(c.visible=u,c.pa=
0)}this.Na&&-1!=this.P&&Ye(this,this.P)}a&&Q.B.p.call(this)};Q.prototype.__defineGetter__("dimensions",v("Y"));Q.prototype.__defineSetter__("dimensions",ba("Y"));Q.prototype.__defineGetter__("spacing",v("sb"));Q.prototype.__defineSetter__("spacing",ba("sb"));Q.prototype.__defineGetter__("bbox",v("ya"));Q.prototype.__defineGetter__("range",v("ld"));Q.prototype.__defineGetter__("dimensionsRAS",v("Vf"));Q.prototype.__defineGetter__("volumeRendering",v("Na"));
Q.prototype.__defineSetter__("volumeRendering",function(a){this.Na=a;this.p(u)});Q.prototype.__defineGetter__("visible",v("F"));Q.prototype.__defineSetter__("visible",function(a){if(a)this.F=a,this.p(u);else{for(var b=this.c,c=b.length,d=0,d=0;d<c;d++)b[d].visible=a;this.F=a;this.j=r}});Q.prototype.__defineGetter__("center",v("v"));Q.prototype.__defineSetter__("center",function(a){(a==t||!ja(a)||3!=a.length)&&m(Error("Invalid center."));this.v=a});
Q.prototype.__defineGetter__("volumeRenderingCache",v("Wd"));Q.prototype.__defineSetter__("volumeRenderingCache",function(a){(a==t||!ja(a)||!(3>=a.length))&&m(Error("Invalid volumeRederingCache."));this.Wd=a});Q.prototype.__defineGetter__("image",v("Lb"));Q.prototype.__defineGetter__("labelmap",function(){this.e||(this.e=new ef(this));return this.e});Q.prototype.__defineGetter__("indexX",v("Ab"));Q.prototype.__defineSetter__("indexX",function(a){y(a)&&(0<=a&&a<this.pd.c.length)&&(this.Ab=a,this.p(u))});
Q.prototype.__defineGetter__("indexY",v("Bb"));Q.prototype.__defineSetter__("indexY",function(a){y(a)&&(0<=a&&a<this.qd.c.length)&&(this.Bb=a,this.p(u))});Q.prototype.__defineGetter__("indexZ",v("Cb"));Q.prototype.__defineSetter__("indexZ",function(a){y(a)&&(0<=a&&a<this.rd.c.length)&&(this.Cb=a,this.p(u))});Q.prototype.__defineGetter__("windowLow",v("ga"));Q.prototype.__defineSetter__("windowLow",ba("ga"));Q.prototype.__defineGetter__("windowHigh",v("fa"));
Q.prototype.__defineSetter__("windowHigh",ba("fa"));Q.prototype.__defineGetter__("borders",v("Va"));Q.prototype.__defineSetter__("borders",ba("Va"));Q.prototype.__defineGetter__("reslicing",v("lg"));Q.prototype.__defineSetter__("reslicing",ba("lg"));Q.prototype.__defineSetter__("xNormX",function(a){this.b[0].i[0]=a});Q.prototype.__defineGetter__("xNormX",function(){return this.b[0].i[0]});Q.prototype.__defineSetter__("xNormY",function(a){this.b[0].i[1]=a});Q.prototype.__defineGetter__("xNormY",function(){return this.b[0].i[1]});
Q.prototype.__defineSetter__("xNormZ",function(a){this.b[0].i[2]=a});Q.prototype.__defineGetter__("xNormZ",function(){return this.b[0].i[2]});Q.prototype.__defineSetter__("xColor",function(a){this.b[0].D=a});Q.prototype.__defineGetter__("xColor",function(){return this.b[0].D});Q.prototype.__defineSetter__("yNormX",function(a){this.b[1].i[0]=a});Q.prototype.__defineGetter__("yNormX",function(){return this.b[1].i[0]});Q.prototype.__defineSetter__("yNormY",function(a){this.b[1].i[1]=a});
Q.prototype.__defineGetter__("yNormY",function(){return this.b[1].i[1]});Q.prototype.__defineSetter__("yNormZ",function(a){this.b[1].i[2]=a});Q.prototype.__defineGetter__("yNormZ",function(){return this.b[1].i[2]});Q.prototype.__defineSetter__("yColor",function(a){this.b[1].D=a});Q.prototype.__defineGetter__("yColor",function(){return this.b[1].D});Q.prototype.__defineSetter__("zNormX",function(a){this.b[2].i[0]=a});Q.prototype.__defineGetter__("zNormX",function(){return this.b[2].i[0]});
Q.prototype.__defineSetter__("zNormY",function(a){this.b[2].i[1]=a});Q.prototype.__defineGetter__("zNormY",function(){return this.b[2].i[1]});Q.prototype.__defineSetter__("zNormZ",function(a){this.b[2].i[2]=a});Q.prototype.__defineGetter__("zNormZ",function(){return this.b[2].i[2]});Q.prototype.__defineSetter__("zColor",function(a){this.b[2].D=a});Q.prototype.__defineGetter__("zColor",function(){return this.b[2].D});
Q.prototype.Hj=function(a){this.c[a].visible=u;for(var b=0;b<this.c[a].c.length;b++)"undefined"!=typeof this.c[a].c[b]&&(this.ba&&(this.e.c[a].c[b].remove(),this.e.c[a].c[b]=t),this.c[a].c[b].remove(),this.c[a].c[b]=t);Rc(this.b[a].i,this.b[a].i);Zd(a,this.b[a].nd,this.b[a].i,this);this.c[a].c=[];this.c[a].c=Array(this.b[a].r);this.ba&&(b=Xd(this.b[a].nd,this.b[a].Ya,this.b[a].i,this.b[a].D,this.ya,this.e.sa,this.e,this.e.ba,this.e.Fa.Ka),this.e.c[a].c=[],this.e.c[a].c=Array(this.b[a].r),this.e.c[a].c[Math.floor(this.b[a].r/
2)]=b,this.e.c[a].p());b=Xd(this.b[a].nd,this.b[a].Ya,this.b[a].i,this.b[a].D,this.ya,this.sa,this,r,t);this.ba&&(b.e=b.C,b.e=this.e.c[a].c[Math.floor(this.b[a].r/2)].C);this.c[a].c[Math.floor(this.b[a].r/2)]=b;0==a?(this.Ab=Math.floor(this.b[a].r/2),this.yc=Math.floor(this.b[a].r/2)):1==a?(this.Bb=Math.floor(this.b[a].r/2),this.zc=Math.floor(this.b[a].r/2)):(this.Cb=Math.floor(this.b[a].r/2),this.Ac=Math.floor(this.b[a].r/2));this.c[a].p();this.c[a].c[Math.floor(this.b[a].r/2)].F=r};
function Ye(a,b){if(!a.Vk)if(!a.Na||!a.j&&b==a.P)a.P=b;else if(-1==a.Wd.indexOf(b))a.Wd.push(b),setTimeout(function(){var a=t;0<=this.P&&(a=this.c[this.P],a.visible=u);var a=this.c[b],c=a.c.length,d=Math.floor(c/4),e;for(e=0;e<1*d;e++){if(a.c[e]==t){var k=Pc();k[0]=this.b[b].k[0][0][0]+this.b[b].z[0]*e;k[1]=this.b[b].k[0][0][1]+this.b[b].z[1]*e;k[2]=this.b[b].k[0][0][2]+this.b[b].z[2]*e;if(this.ba){var l=Xd(k,this.b[b].Ya,this.b[b].i,this.b[b].D,this.ya,this.e.sa,this.e,this.e.ba,this.e.Fa.Ka);this.e.c[b].c[e]=
l;this.e.c[b].p(r)}k=Xd(k,this.b[b].Ya,this.b[b].i,this.b[b].D,this.ya,this.sa,this,r,t);k.c[0].F=u;this.ba&&(k.e=k.C,k.e=this.e.c[b].c[e].C);a.c[e]=k}a.c[e].F=r}setTimeout(function(){for(;e<2*d;e++){if(a.c[e]==t){var k=Pc();k[0]=this.b[b].k[0][0][0]+this.b[b].z[0]*e;k[1]=this.b[b].k[0][0][1]+this.b[b].z[1]*e;k[2]=this.b[b].k[0][0][2]+this.b[b].z[2]*e;if(this.ba){var l=Xd(k,this.b[b].Ya,this.b[b].i,this.b[b].D,this.ya,this.e.sa,this.e,this.e.ba,this.e.Fa.Ka);this.e.c[b].c[e]=l;this.e.c[b].p(r)}k=
Xd(k,this.b[b].Ya,this.b[b].i,this.b[b].D,this.ya,this.sa,this,r,t);k.c[0].F=u;this.ba&&(k.e=k.C,k.e=this.e.c[b].c[e].C);a.c[e]=k}a.c[e].F=r}setTimeout(function(){for(;e<3*d;e++){if(a.c[e]==t){var k=Pc();k[0]=this.b[b].k[0][0][0]+this.b[b].z[0]*e;k[1]=this.b[b].k[0][0][1]+this.b[b].z[1]*e;k[2]=this.b[b].k[0][0][2]+this.b[b].z[2]*e;if(this.ba){var l=Xd(k,this.b[b].Ya,this.b[b].i,this.b[b].D,this.ya,this.e.sa,this.e,this.e.ba,this.e.Fa.Ka);this.e.c[b].c[e]=l;this.e.c[b].p(r)}k=Xd(k,this.b[b].Ya,this.b[b].i,
this.b[b].D,this.ya,this.sa,this,r,t);k.c[0].F=u;this.ba&&(k.e=k.C,k.e=this.e.c[b].c[e].C);a.c[e]=k}a.c[e].F=r}setTimeout(function(){for(e=3*d;e<c;e++){if(a.c[e]==t){var k=Pc();k[0]=this.b[b].k[0][0][0]+this.b[b].z[0]*e;k[1]=this.b[b].k[0][0][1]+this.b[b].z[1]*e;k[2]=this.b[b].k[0][0][2]+this.b[b].z[2]*e;if(this.ba){var l=Xd(k,this.b[b].Ya,this.b[b].i,this.b[b].D,this.ya,this.e.sa,this.e,this.e.ba,this.e.Fa.Ka);this.e.c[b].c[e]=l;this.e.c[b].p(r)}k=Xd(k,this.b[b].Ya,this.b[b].i,this.b[b].D,this.ya,
this.sa,this,r,t);k.c[0].F=u;this.ba&&(k.e=k.C,k.e=this.e.c[b].c[e].C);a.c[e]=k}a.c[e].F=r}setTimeout(function(){this.c[b].p(r);this.P=b;this.j=u}.bind(this),10)}.bind(this),10)}.bind(this),10)}.bind(this),10)}.bind(a),10);else{if(-1!=a.P){var c=a.c[a.P];c.visible=u}var c=a.c[b],d=c.c.length,e;for(e=0;e<d;e++)c.c[e].F=r;a.P=b;a.j=u}}Q.prototype.tf=aa();Q.prototype.vf=aa();Q.prototype.uf=aa();C("X.volume",Q);C("X.volume.prototype.modified",Q.prototype.p);C("X.volume.prototype.sliceInfoChanged",Q.prototype.Hj);
C("X.volume.prototype.onComputing",Q.prototype.tf);C("X.volume.prototype.onComputingProgress",Q.prototype.vf);C("X.volume.prototype.onComputingEnd",Q.prototype.uf);function ff(){Sd.call(this);this.f="parserOFF"}D(ff,Sd);
ff.prototype.parse=function(a,b,c){function d(){j===e&&m(Error("End of file reached unexpectedly."));for(var a=j;a<e;++a)if(10===f[a]){var b=Ud(f,j,a);j=a+1;return b}j=e;return Ud(f,j,e-1)}E.Ea(this.f+".parse");this.L=c;var e=c.byteLength,f=Z(this,"uchar",e);c=[];b.h=new V(e);b.n=new V(e);for(var g=b.h,h=b.n,j=0,k=d(),k=("OFF"===k?d():k).split(" "),l=k[0],k=k[1];l--;){var n=d(),n=n.split(" ");c.push([parseFloat(n[0]),parseFloat(n[1]),parseFloat(n[2])])}for(;k--;){var n=d(),n=n.split(" "),q=c[parseInt(n[1],
10)],l=c[parseInt(n[2],10)],n=c[parseInt(n[3],10)];g.add(q[0],q[1],q[2]);g.add(l[0],l[1],l[2]);g.add(n[0],n[1],n[2]);q=new U(q[0],q[1],q[2]);n=new U(n[0],n[1],n[2]);l=Lc((new U(l[0],l[1],l[2])).ra(q),n.ra(q));l.normalize();h.add(l.x,l.y,l.d);h.add(l.x,l.y,l.d);h.add(l.x,l.y,l.d)}E.xa(this.f+".parse");c=new pd;c.O=b;c.w=a;this.dispatchEvent(c)};C("X.parserOFF",ff);C("X.parserOFF.prototype.parse",ff.prototype.parse);function gf(){Sd.call(this);this.f="parserDCM"}D(gf,Sd);
gf.prototype.parse=function(a,b,c){b.qc={};b.qc.mf=0;this.Dd(c,b);if(b.q.length==t||b.na.length==b.q.length){b.qc.mf=b.q.length;var d={};c={};for(var e=0;e<b.na.length;e++)d.hasOwnProperty(b.na[e].series_instance_uid)||(d[b.na[e].series_instance_uid]=[],c[b.na[e].series_instance_uid]={}),c[b.na[e].series_instance_uid].hasOwnProperty(b.na[e].sop_instance_uid)||(c[b.na[e].series_instance_uid][b.na[e].sop_instance_uid]=r,d[b.na[e].series_instance_uid].push(b.na[e]));var f=Object.keys(d)[0],e=d[f],g=
e.length;c={};var h="image_position_patient";1==g?(h="image_position_patient",d[f][0].dist=0):e[0].image_position_patient[0]!=e[1].image_position_patient[0]||e[0].image_position_patient[1]!=e[1].image_position_patient[1]||e[0].image_position_patient[2]!=e[1].image_position_patient[2]?(h="image_position_patient",d=new U(e[0].image_orientation_patient[0],e[0].image_orientation_patient[1],e[0].image_orientation_patient[2]),f=new U(e[0].image_orientation_patient[3],e[0].image_orientation_patient[4],e[0].image_orientation_patient[5]),
d=Lc(d,f),e.map(function(a,b){b.dist=b.image_position_patient[0]*a.x+b.image_position_patient[1]*a.y+b.image_position_patient[2]*a.d;return b}.bind(t,d)),e.sort(function(a,b){return a.dist-b.dist})):e[0].instance_number!=e[1].instance_number?(h="instance_number",e.sort(function(a,b){return a.instance_number-b.instance_number})):window.console.log("Could not resolve the ordering mode");isNaN(e[0].pixel_spacing[0])&&(e[0].pixel_spacing[0]=1);isNaN(e[0].pixel_spacing[1])&&(e[0].pixel_spacing[1]=1);if(1<
g)switch(h){case "image_position_patient":var j=e[0].image_position_patient,d=e[1].image_position_patient,f=d[0]-j[0],k=d[1]-j[1],l=d[2]-j[2];e[0].pixel_spacing[2]=Math.sqrt(f*f+k*k+l*l);break;case "instance_number":e[0].pixel_spacing[2]=1;break;default:window.console.log("Unkown ordering mode - returning: "+h)}else e[0].pixel_spacing[2]=1;d=1;switch(h){case "image_position_patient":var j=e[0].image_position_patient,n=e[g-1].image_position_patient,f=n[0]-j[0],k=n[1]-j[1],l=n[2]-j[2],f=Math.sqrt(f*
f+k*k+l*l),d=d+Math.round(f/e[0].pixel_spacing[2]);break;case "instance_number":d+=Math.abs(e[g-1].instance_number-e[0].instance_number);break;default:window.console.log("Unkown ordering mode - returning: "+h)}j=e[0].columns*e[0].rows;f=j*d;n=t;switch(e[0].We){case 8:n=new Uint8Array(f);break;case 16:n=new Uint16Array(f);break;case 32:n=new Uint32Array(f);default:window.console.log("Unknown number of bits allocated - using default: 32 bits")}b.sb=e[0].pixel_spacing;for(var q=0;q<g;q++){var s=e[q].data,
f=0;switch(h){case "image_position_patient":f=e[q].image_position_patient[0]-e[0].image_position_patient[0];k=e[q].image_position_patient[1]-e[0].image_position_patient[1];l=e[q].image_position_patient[2]-e[0].image_position_patient[2];f=Math.sqrt(f*f+k*k+l*l)/e[0].pixel_spacing[2];break;case "instance_number":f=e[q].instance_number-e[0].instance_number;break;default:window.console.log("Unkown ordering mode - returning: "+h)}n.set(s,f*j)}c.data=n;b.L=n;b.Y=[e[0].columns,e[0].rows,d];c.il=b.Y;d=Td(n);
g=d[0];d=d[1];c.min=b.Wa=b.ga=g;c.max=b.ma=b.fa=d;-Infinity==b.Z&&(b.Z=g);Infinity==b.aa&&(b.aa=d);k=e[0].image_position_patient;g=Uc();switch(h){case "image_position_patient":d=new U(e[0].image_orientation_patient[0],e[0].image_orientation_patient[1],e[0].image_orientation_patient[2]);f=new U(e[0].image_orientation_patient[3],e[0].image_orientation_patient[4],e[0].image_orientation_patient[5]);d=Lc(d,f);Zc(g,0,-e[0].image_orientation_patient[0]*e[0].pixel_spacing[0],-e[0].image_orientation_patient[3]*
e[0].pixel_spacing[1],-d.x*e[0].pixel_spacing[2],-k[0]);Zc(g,1,-e[0].image_orientation_patient[1]*e[0].pixel_spacing[0],-e[0].image_orientation_patient[4]*e[0].pixel_spacing[1],-d.y*e[0].pixel_spacing[2],-k[1]);Zc(g,2,e[0].image_orientation_patient[2]*e[0].pixel_spacing[0],e[0].image_orientation_patient[5]*e[0].pixel_spacing[1],d.d*e[0].pixel_spacing[2],k[2]);Zc(g,3,0,0,0,1);break;case "instance_number":Zc(g,0,-1,0,0,-k[0]);Zc(g,1,-0,-1,-0,-k[1]);Zc(g,2,0,0,1,k[2]);Zc(g,3,0,0,0,1);break;default:window.console.log("Unkown ordering mode - returning: "+
h)}c.wb=g;c.xb=Uc();cd(c.wb,c.xb);h=Tc(0,0,0,1);e=Sc();ed(g,h,e);h=Tc(1,1,1,1);d=Sc();ed(g,h,d);c.Uc=[d[0]-e[0],d[1]-e[1],d[2]-e[2]];e=Vd(g,[b.Y[0],b.Y[1],b.Y[2]]);c.Sc=[e[1]-e[0]+1,e[3]-e[2]+1,e[5]-e[4]+1];c.Tc=[e[0],e[2],e[4]];b.lb(c);b.Lb=$d(this,b)}c=new pd;c.O=b;c.w=a;this.dispatchEvent(c)};
function hf(a,b,c,d){switch(c){case 16975:case 20819:case 20053:case 22351:c=function(a){for(var b="",c=128;1<=c;c/=2)b+=a&c?"1":"0";return b};d=a[b++];a=a[b++];d=parseInt(c((a&65280)>>8)+c(a&255)+(c((d&65280)>>8)+c(d&255)),2);4294967295==d&&(d=0);b+=d/2;break;default:b+=d/2}return b}
gf.prototype.Dd=function(a,b){this.L=a;if("undefined"==typeof b.na||b.na==t)b.na=[];for(var c={pixel_spacing:[0.1,0.1,Infinity],image_orientation_patient:[1,0,0,0,1,0],image_position_patient:[0,0,0],transfer_syntax_uid:"no_transfer_syntax_uid"},d=Z(this,"ushort",this.L.byteLength),e=66,f=t,g=t,h=t,j=t;e<d.length;)switch(f=d[e++],g=d[e++],h=d[e++],j=d[e++],"1.2.840.10008.1.2"==c.transfer_syntax_uid&&0==j&&(j=h),f){case 2:switch(g){case 16:for(var k="",f=f=0;f<j/2;f++)h=d[e++],g=h&255,h=(h&65280)>>
8,k+=String.fromCharCode(g),k+=String.fromCharCode(h);c.transfer_syntax_uid=k.replace(/\0/g,"");break;default:e=hf(d,e,h,j)}break;case 40:switch(g){case 16:c.rows=d[e];e+=j/2;break;case 17:c.columns=d[e];e+=j/2;break;case 256:c.We=d[e];e+=j/2;break;case 257:c.bits_stored=d[e];e+=j/2;break;case 2:c.number_of_images=d[e];e+=j/2;break;case 48:k="";for(f=0;f<j/2;f++)h=d[e++],g=h&255,h=(h&65280)>>8,k+=String.fromCharCode(g),k+=String.fromCharCode(h);k=k.split("\\");c.pixel_spacing=[parseFloat(k[0]),parseFloat(k[1]),
Infinity];break;default:e=hf(d,e,h,j)}break;case 32:switch(g){case 14:c.series_instance_uid="";for(f=0;f<j/2;f++)h=d[e++],g=h&255,h=(h&65280)>>8,c.series_instance_uid+=String.fromCharCode(g),c.series_instance_uid+=String.fromCharCode(h);break;case 19:k="";for(f=0;f<j/2;f++)h=d[e++],g=h&255,h=(h&65280)>>8,k+=String.fromCharCode(g),k+=String.fromCharCode(h);c.instance_number=parseInt(k,10);break;case 50:k="";for(f=0;f<j/2;f++)h=d[e++],g=h&255,h=(h&65280)>>8,k+=String.fromCharCode(g),k+=String.fromCharCode(h);
k=k.split("\\");c.image_position_patient=[parseFloat(k[0]),parseFloat(k[1]),parseFloat(k[2])];break;case 55:k="";for(f=0;f<j/2;f++)h=d[e++],g=h&255,h=(h&65280)>>8,k+=String.fromCharCode(g),k+=String.fromCharCode(h);k=k.split("\\");c.image_orientation_patient=[parseFloat(k[0]),parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3]),parseFloat(k[4]),parseFloat(k[5])];break;default:e=hf(d,e,h,j)}break;case 65534:switch(g){default:j=0,e+=j/2}break;case 8:switch(g){case 24:c.sop_instance_uid="";for(f=0;f<j/
2;f++)h=d[e++],g=h&255,h=(h&65280)>>8,c.sop_instance_uid+=String.fromCharCode(g),c.sop_instance_uid+=String.fromCharCode(h);break;default:e=hf(d,e,h,j)}break;case 16:switch(g){case 8720:for(f=0;f<j/2;f++)e++;break;default:e=hf(d,e,h,j)}break;default:e=hf(d,e,h,j)}switch(c.We){case 8:c.data=new Uint8Array(c.columns*c.rows);break;case 16:c.data=new Uint16Array(c.columns*c.rows);break;case 32:c.data=new Uint32Array(c.columns*c.rows)}this.R=this.L.byteLength-2*c.columns*c.rows;d=t;switch(c.We){case 8:d=
Z(this,"uchar",c.columns*c.rows);break;case 16:d=Z(this,"ushort",c.columns*c.rows);break;case 32:d=Z(this,"uint",c.columns*c.rows)}c.data=d;b.na.push(c);return b};C("X.parserDCM",gf);C("X.parserDCM.prototype.parse",gf.prototype.parse);function jf(){Sd.call(this);this.f="parserVTK"}D(jf,Sd);
jf.prototype.parse=function(a,b,c){E.Ea(this.f+".parse");var d=b.h,e=b.n,f=new Uint8Array(c),g="";b.h=d=new V(c.byteLength);b.n=e=new V(c.byteLength);c=0;for(var h=f.length;c<h;c+=32768)g+=Ud(f,c,Math.min(c+32768,h));f=g.split("\n");g=f.length;this.td=this.ud=t;this.ec=[];this.La=kd;this.Ke=this.Sb=this.Kb=this.Tb=u;c=0;for(h=g%8;h--;)kf(this,f[c]),c++;for(h=0.125*g^0;h--;)kf(this,f[c]),c++,kf(this,f[c]),c++,kf(this,f[c]),c++,kf(this,f[c]),c++,kf(this,f[c]),c++,kf(this,f[c]),c++,kf(this,f[c]),c++,
kf(this,f[c]),c++;c=this.ud;var f=this.td,g=f.length,j=h=this.ec.length;do{var k=this.ec[h-j],l=k.length,n;for(n=0;n<l&&!("LINES"==this.La&&n+1>=l);n++){var q=parseInt(k[n],10),s=c.get(q);d.add(s[0],s[1],s[2]);var A=q,z=s;"LINES"==this.La?(A=parseInt(k[n+1],10),z=c.get(A),d.add(z[0],z[1],z[2])):"TRIANGLE_STRIPS"==this.La&&(0==n||n==l-1)&&d.add(s[0],s[1],s[2]);q<g?(z=f.get(q),e.add(z[0],z[1],z[2]),"LINES"==this.La?(A=f.get(A),e.add(A[0],A[1],A[2])):"TRIANGLE_STRIPS"==this.La&&(0==n||n==l-1)&&e.add(z[0],
z[1],z[2])):(A=new U(s[0],s[1],s[2]),A.normalize(),e.add(A.x,A.y,A.d),"LINES"==this.La?(A=new U(z[0],z[1],z[2]),A.normalize(),e.add(A.x,A.y,A.d)):"TRIANGLE_STRIPS"==this.La&&(0==n||n==l-1)&&e.add(A.x,A.y,A.d))}j--}while(0<j);b.Da=this.La;E.xa(this.f+".parse");d=new pd;d.O=b;d.w=a;this.dispatchEvent(d)};
function kf(a,b){b=b.replace(/^\s+|\s+$/g,"");var c=b.split(" "),d=c.length,e=c[0];switch(e){case "POINTS":a.Tb=r;a.Kb=u;a.Sb=u;c=parseInt(c[1],10);a.ud=new V(3*c);a.td=new V(3*c);return;case "VERTICES":a.Kb=r;a.Tb=u;a.Sb=u;c=parseInt(c[1],10);3<=c?a.La=kd:1==c?a.La="POINTS":m(Error("This VTK file is not supported!"));a.ec=[];return;case "TRIANGLE_STRIPS":a.Kb=r;a.Tb=u;a.Sb=u;a.La="TRIANGLE_STRIPS";a.ec=[];return;case "LINES":a.Kb=r;a.Tb=u;a.Sb=u;a.La="LINES";a.ec=[];return;case "POLYGONS":a.Kb=r;
a.Tb=u;a.Sb=u;a.La="POLYGONS";a.ec=[];return;case "POINT_DATA":a.Sb=r;a.Tb=u;a.Kb=u;return}if(a.Tb)if(1==d||isNaN(parseFloat(e)))a.Tb=u;else{if(3<=d){var e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]);a.ud.add(e,f,g)}6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.ud.add(e,f,g));9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.ud.add(d,e,c))}else a.Kb?1==d||isNaN(parseFloat(e))?a.Kb=u:(c=c.slice(1),a.ec.push(c)):a.Sb&&("NORMALS"==e?a.Ke=r:1==d||isNaN(parseFloat(e))?
(a.Sb=u,a.Ke=u):a.Ke&&(3<=d&&(e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]),a.td.add(e,f,g)),6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.td.add(e,f,g)),9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.td.add(d,e,c))))}C("X.parserVTK",jf);C("X.parserVTK.prototype.parse",jf.prototype.parse);function lf(){Sd.call(this);this.f="parserFSM";this.Qd=u}D(lf,Sd);
lf.prototype.parse=function(a,b,c){E.Ea(this.f+".parse");this.L=c;var d=b.h,e=b.n;b.Dc=[];var f=b.Dc;c=0;var g;do g=Z(this,"uchar"),c++;while(200>c&&10!=g);Z(this,"uchar");e=Z(this,"uint");c=Z(this,"uint");var h=Z(this,"float",3*e);g=Z(this,"uint",3*c);var j=new Uint32Array(e),k=new Float32Array(9*c);b.h=d=new V(9*c);b.n=e=new V(9*c);var l;for(l=0;l<c;l++){var n=3*l,q=g[n],s=g[n+1],A=g[n+2];f.push(q);f.push(s);f.push(A);j[q]+=1;j[s]+=1;j[A]+=1;var n=3*q,z=3*s,G=3*A,B=h[n],I=h[n+1],w=h[n+2],s=h[z],
A=h[z+1],q=h[z+2],H=h[G],F=h[G+1],J=h[G+2];d.add(B,I,w);d.add(s,A,q);d.add(H,F,J);B=new U(B,I,w);H=new U(H,F,J);s=(new U(s,A,q)).l().ra(B);A=H.l().ra(B);s=Lc(s,A).normalize();k[n]+=s.x;k[n+1]+=s.y;k[n+2]+=s.d;k[z]+=s.x;k[z+1]+=s.y;k[z+2]+=s.d;k[G]+=s.x;k[G+1]+=s.y;k[G+2]+=s.d}for(l=0;l<c;l++)n=3*l,q=g[n],s=g[n+1],A=g[n+2],n=3*q,z=3*s,G=3*A,f=new U(k[z],k[z+1],k[z+2]),h=new U(k[G],k[G+1],k[G+2]),n=(new U(k[n],k[n+1],k[n+2])).scale(1/j[q]).normalize(),f=f.scale(1/j[s]).normalize(),h=h.scale(1/j[A]).normalize(),
e.add(n.x,n.y,n.d),e.add(f.x,f.y,f.d),e.add(h.x,h.y,h.d);c=Z(this,"uchar",this.L.byteLength-this.R);g=t;for(n=0;n<c.length;n++)if(99==c[n]&&114==c[n+1]&&97==c[n+2]&&115==c[n+3]){for(e=g=n+9;10!=c[n]&&n<c.length;)e++,n++;g=Ud(c.subarray(g,e)).split(" ");break}g&&(b.ea.nh(parseFloat(g[0])),b.ea.oh(parseFloat(g[1])),b.ea.ph(parseFloat(g[2])));b.Da=kd;E.xa(this.f+".parse");c=new pd;c.O=b;c.w=a;this.dispatchEvent(c)};C("X.parserFSM",lf);C("X.parserFSM.prototype.parse",lf.prototype.parse);var mf={$e:function(a,b,c){return mf.update(a,0,b,c)},update:function(a,b,c,d){var e=mf.uh,f="number"===typeof c?c:c=0;d="number"===typeof d?d:a.length;b^=4294967295;for(f=d&7;f--;++c)b=b>>>8^e[(b^a[c])&255];for(f=d>>3;f--;c+=8)b=b>>>8^e[(b^a[c])&255],b=b>>>8^e[(b^a[c+1])&255],b=b>>>8^e[(b^a[c+2])&255],b=b>>>8^e[(b^a[c+3])&255],b=b>>>8^e[(b^a[c+4])&255],b=b>>>8^e[(b^a[c+5])&255],b=b>>>8^e[(b^a[c+6])&255],b=b>>>8^e[(b^a[c+7])&255];return(b^4294967295)>>>0}};
mf.uh=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,
3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,
366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,
3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,
1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,
1088359270,936918E3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);function nf(a){var b=a.length,c=0,d=Number.POSITIVE_INFINITY,e,f,g,h,j,k,l,n,q;for(n=0;n<b;++n)a[n]>c&&(c=a[n]),a[n]<d&&(d=a[n]);e=1<<c;f=new Uint32Array(e);g=1;h=0;for(j=2;g<=c;){for(n=0;n<b;++n)if(a[n]===g){k=0;l=h;for(q=0;q<g;++q)k=k<<1|l&1,l>>=1;for(q=k;q<e;q+=j)f[q]=g<<16|n;++h}++g;h<<=1;j<<=1}return[f,c,d]};function of(a,b){this.Xe=[];this.Ye=32768;this.kb=this.vd=this.J=this.Lf=0;this.input=new Uint8Array(a);this.pg=u;this.Ze=pf;this.Gb=u;if(b||!(b={}))b.index&&(this.J=b.index),b.bufferSize&&(this.Ye=b.bufferSize),b.bufferType&&(this.Ze=b.bufferType),b.resize&&(this.Gb=b.resize);switch(this.Ze){case qf:this.ia=32768;this.Pa=new Uint8Array(32768+this.Ye+258);break;case pf:this.ia=0;this.Pa=new Uint8Array(this.Ye);this.mc=this.li;this.sg=this.bi;this.ff=this.fi;break;default:m(Error("invalid inflate mode"))}}
var qf=0,pf=1;
of.prototype.Wb=function(){for(;!this.pg;){var a=rf(this,3);a&1&&(this.pg=r);a>>>=1;switch(a){case 0:var a=this.input,b=this.J,c=this.Pa,d=this.ia,e=p,f=p,g=p,h=c.length,e=p;this.kb=this.vd=0;e=a[b++];e===p&&m(Error("invalid uncompressed block header: LEN (first byte)"));f=e;e=a[b++];e===p&&m(Error("invalid uncompressed block header: LEN (second byte)"));f|=e<<8;e=a[b++];e===p&&m(Error("invalid uncompressed block header: NLEN (first byte)"));g=e;e=a[b++];e===p&&m(Error("invalid uncompressed block header: NLEN (second byte)"));g|=
e<<8;f===~g&&m(Error("invalid uncompressed block header: length verify"));b+f>a.length&&m(Error("input buffer is broken"));switch(this.Ze){case qf:for(;d+f>c.length;)e=h-d,f-=e,c.set(a.subarray(b,b+e),d),d+=e,b+=e,this.ia=d,c=this.mc(),d=this.ia;break;case pf:for(;d+f>c.length;)c=this.mc({yg:2});break;default:m(Error("invalid inflate mode"))}c.set(a.subarray(b,b+f),d);d+=f;this.J=b+=f;this.ia=d;this.Pa=c;break;case 1:this.ff(sf,tf);break;case 2:uf(this);break;default:m(Error("unknown BTYPE: "+a))}}return this.sg()};
var vf=new Uint16Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),wf=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258]),xf=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0]),yf=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577]),zf=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Af=new Uint8Array(288),
Bf,Cf;Bf=0;for(Cf=Af.length;Bf<Cf;++Bf)Af[Bf]=143>=Bf?8:255>=Bf?9:279>=Bf?7:8;var sf=nf(Af),Df=new Uint8Array(30),Ef,Ff;Ef=0;for(Ff=Df.length;Ef<Ff;++Ef)Df[Ef]=5;var tf=nf(Df);function rf(a,b){for(var c=a.vd,d=a.kb,e=a.input,f=a.J,g;d<b;)g=e[f++],g===p&&m(Error("input buffer is broken")),c|=g<<d,d+=8;g=c&(1<<b)-1;a.vd=c>>>b;a.kb=d-b;a.J=f;return g}
function Gf(a,b){for(var c=a.vd,d=a.kb,e=a.input,f=a.J,g=b[0],h=b[1],j;d<h;)j=e[f++],j===p&&m(Error("input buffer is broken")),c|=j<<d,d+=8;e=g[c&(1<<h)-1];g=e>>>16;a.vd=c>>g;a.kb=d-g;a.J=f;return e&65535}
function uf(a){function b(a,b,c){var d,e,f;for(f=0;f<a;)switch(d=Gf(this,b),d){case 16:for(d=3+rf(this,2);d--;)c[f++]=e;break;case 17:for(d=3+rf(this,3);d--;)c[f++]=0;e=0;break;case 18:for(d=11+rf(this,7);d--;)c[f++]=0;e=0;break;default:e=c[f++]=d}return c}var c=rf(a,5)+257,d=rf(a,5)+1,e=rf(a,4)+4,f=new Uint8Array(vf.length),g;for(g=0;g<e;++g)f[vf[g]]=rf(a,3);e=nf(f);f=new Uint8Array(c);g=new Uint8Array(d);a.ff(nf(b.call(a,c,e,f)),nf(b.call(a,d,e,g)))}x=of.prototype;
x.ff=function(a,b){var c=this.Pa,d=this.ia;this.vg=a;for(var e=c.length-258,f,g,h;256!==(f=Gf(this,a));)if(256>f)d>=e&&(this.ia=d,c=this.mc(),d=this.ia),c[d++]=f;else{f-=257;h=wf[f];0<xf[f]&&(h+=rf(this,xf[f]));f=Gf(this,b);g=yf[f];0<zf[f]&&(g+=rf(this,zf[f]));d>=e&&(this.ia=d,c=this.mc(),d=this.ia);for(;h--;)c[d]=c[d++-g]}for(;8<=this.kb;)this.kb-=8,this.J--;this.ia=d};
x.fi=function(a,b){var c=this.Pa,d=this.ia;this.vg=a;for(var e=c.length,f,g,h;256!==(f=Gf(this,a));)if(256>f)d>=e&&(c=this.mc(),e=c.length),c[d++]=f;else{f-=257;h=wf[f];0<xf[f]&&(h+=rf(this,xf[f]));f=Gf(this,b);g=yf[f];0<zf[f]&&(g+=rf(this,zf[f]));d+h>e&&(c=this.mc(),e=c.length);for(;h--;)c[d]=c[d++-g]}for(;8<=this.kb;)this.kb-=8,this.J--;this.ia=d};
x.mc=function(){var a=new Uint8Array(this.ia-32768),b=this.ia-32768,c=this.Pa;a.set(c.subarray(32768,a.length));this.Xe.push(a);this.Lf+=a.length;c.set(c.subarray(b,b+32768));this.ia=32768;return c};x.li=function(a){var b=this.input.length/this.J+1|0,c=this.input,d=this.Pa;a&&("number"===typeof a.yg&&(b=a.yg),"number"===typeof a.Wh&&(b+=a.Wh));2>b?(a=(c.length-this.J)/this.vg[2],a=258*(a/2)|0,a=a<d.length?d.length+a:d.length<<1):a=d.length*b;a=new Uint8Array(a);a.set(d);return this.Pa=a};
x.sg=function(){var a=0,b=this.Pa,c=this.Xe,d,e=new Uint8Array(this.Lf+(this.ia-32768)),f,g,h,j;if(0===c.length)return this.Pa.subarray(32768,this.ia);f=0;for(g=c.length;f<g;++f){d=c[f];h=0;for(j=d.length;h<j;++h)e[a++]=d[h]}f=32768;for(g=this.ia;f<g;++f)e[a++]=b[f];this.Xe=[];return this.buffer=e};x.bi=function(){var a,b=this.ia;this.Gb?(a=new Uint8Array(b),a.set(this.Pa.subarray(0,b))):a=this.Pa.subarray(0,b);return this.buffer=a};new Uint8Array(256);var Hf;for(Hf=0;256>Hf;++Hf)for(var If=Hf,Jf=7,If=If>>>1;If;If>>>=1)--Jf;var Kf=[],Lf;for(Lf=0;288>Lf;Lf++)switch(r){case 143>=Lf:Kf.push([Lf+48,8]);break;case 255>=Lf:Kf.push([Lf-144+400,9]);break;case 279>=Lf:Kf.push([Lf-256+0,7]);break;case 287>=Lf:Kf.push([Lf-280+192,8]);break;default:m("invalid literal: "+Lf)}
function Mf(){var a=Nf;switch(r){case 3===a:return[257,a-3,0];case 4===a:return[258,a-4,0];case 5===a:return[259,a-5,0];case 6===a:return[260,a-6,0];case 7===a:return[261,a-7,0];case 8===a:return[262,a-8,0];case 9===a:return[263,a-9,0];case 10===a:return[264,a-10,0];case 12>=a:return[265,a-11,1];case 14>=a:return[266,a-13,1];case 16>=a:return[267,a-15,1];case 18>=a:return[268,a-17,1];case 22>=a:return[269,a-19,2];case 26>=a:return[270,a-23,2];case 30>=a:return[271,a-27,2];case 34>=a:return[272,a-
31,2];case 42>=a:return[273,a-35,3];case 50>=a:return[274,a-43,3];case 58>=a:return[275,a-51,3];case 66>=a:return[276,a-59,3];case 82>=a:return[277,a-67,4];case 98>=a:return[278,a-83,4];case 114>=a:return[279,a-99,4];case 130>=a:return[280,a-115,4];case 162>=a:return[281,a-131,5];case 194>=a:return[282,a-163,5];case 226>=a:return[283,a-195,5];case 257>=a:return[284,a-227,5];case 258===a:return[285,a-258,0];default:m("invalid length: "+a)}}var Of=[],Nf,Pf;
for(Nf=3;258>=Nf;Nf++)Pf=Mf(),Of[Nf]=Pf[2]<<24|Pf[1]<<16|Pf[0];new Uint32Array(Of);function Qf(){};function Rf(a){this.input=a;this.J=0;this.member=[]}
Rf.prototype.Wb=function(){for(var a=this.input.length;this.J<a;){var b=new Qf,c=p,d=p,e=p,f=c=e=p,g=p,c=c=p,h=this.input,d=this.J;b.Eg=h[d++];b.Fg=h[d++];(31!==b.Eg||139!==b.Fg)&&m(Error("invalid file signature:",b.Eg,b.Fg));b.rg=h[d++];switch(b.rg){case 8:break;default:m(Error("unknown compression method: "+b.rg))}b.ee=h[d++];c=h[d++]|h[d++]<<8|h[d++]<<16|h[d++]<<24;b.ol=new Date(1E3*c);b.sl=h[d++];b.pl=h[d++];0<(b.ee&4)&&(b.Uj=h[d++]|h[d++]<<8,d+=b.Uj);if(0<(b.ee&8)){g=[];for(f=0;0<(c=h[d++]);)g[f++]=
String.fromCharCode(c);b.name=g.join("")}if(0<(b.ee&16)){g=[];for(f=0;0<(c=h[d++]);)g[f++]=String.fromCharCode(c);b.comment=g.join("")}0<(b.ee&2)&&(b.ci=mf.$e(h,0,d)&65535,b.ci!==(h[d++]|h[d++]<<8)&&m(Error("invalid header crc16")));c=h[h.length-4]|h[h.length-3]<<8|h[h.length-2]<<16|h[h.length-1]<<24;h.length-d-4-4<512*c&&(e=c);d=new of(h,{index:d,bufferSize:e});b.data=e=d.Wb();d=d.J;b.fl=c=(h[d++]|h[d++]<<8|h[d++]<<16|h[d++]<<24)>>>0;mf.$e(e)!==c&&m(Error("invalid CRC-32 checksum: 0x"+mf.$e(e).toString(16)+
" / 0x"+c.toString(16)));b.ll=c=(h[d++]|h[d++]<<8|h[d++]<<16|h[d++]<<24)>>>0;(e.length&4294967295)!==c&&m(Error("invalid input size: "+(e.length&4294967295)+" / "+c));this.member.push(b);this.J=d}a=this.member;b=e=d=0;for(h=a.length;b<h;++b)e+=a[b].data.length;e=new Uint8Array(e);for(b=0;b<h;++b)e.set(a[b].data,d),d+=a[b].data.length;return e};function Sf(){Sd.call(this);this.f="parserMGZ";this.Qd=u}D(Sf,Sd);
Sf.prototype.parse=function(a,b,c,d){E.Ea(this.f+".parse");d&&(c=(new Rf(new Uint8Array(c))).Wb(),c=c.buffer);d=this.Dd(c);var e=[d.pf,d.qf,d.rf];b.Y=e;var f=d.qh;b.sb=f;c=d.min;var g=d.max;b.Wa=b.ga=c;b.ma=b.fa=g;-Infinity==b.Z&&(b.Z=c);Infinity==b.aa&&(b.aa=g);c=Uc();Zc(c,0,d.ab[0][0],d.ab[1][0],d.ab[2][0],0);Zc(c,1,d.ab[0][1],d.ab[1][1],d.ab[2][1],0);Zc(c,2,d.ab[0][2],d.ab[1][2],d.ab[2][2],0);Zc(c,3,0,0,0,1);for(var g=e[0]/2,h=e[1]/2,j=e[2]/2,e=[0,0,0],k=0;3>k;++k)e[k]=d.ab[3][k]-(c[k+0]*f[0]*
g+c[k+4]*f[1]*h+c[k+8]*f[2]*j);f=e[1];g=e[2];c[12]=e[0];c[13]=f;c[14]=g;c[15]=1;d.wb=c;d.xb=Uc();cd(d.wb,d.xb);e=Tc(0,0,0,1);f=Sc();ed(c,e,f);g=Tc(1,1,1,1);e=Sc();ed(c,g,e);c=Vd(c,b.Y);d.Uc=[e[0]-f[0],e[1]-f[1],e[2]-f[2]];d.Sc=[c[1]-c[0]+1,c[3]-c[2]+1,c[5]-c[4]+1];d.Tc=[c[0],c[2],c[4]];b.lb(d);E.xa(this.f+".parse");b.Lb=$d(this,b);d=new pd;d.O=b;d.w=a;this.dispatchEvent(d)};
Sf.prototype.Dd=function(a){this.L=a;a={version:0,xh:0,vh:0,ri:0,wh:0,pf:0,qf:0,rf:0,Si:0,type:0,ji:0,gh:0,ek:t,ab:t,qh:t,data:t,min:Infinity,max:-Infinity};a.version=Z(this,"uint");a.pf=Z(this,"uint");a.qf=Z(this,"uint");a.rf=Z(this,"uint");a.Si=Z(this,"uint");a.type=Z(this,"uint");a.ji=Z(this,"uint");a.gh=Z(this,"ushort");if(0<a.gh){a.qh=Z(this,"float",3);var b=[];b.push(Z(this,"float",3));b.push(Z(this,"float",3));b.push(Z(this,"float",3));b.push(Z(this,"float",3));a.ab=b}this.R=284;b=a.pf*a.qf*
a.rf;switch(a.type){case 0:a.data=Z(this,"uchar",b);break;case 1:a.data=Z(this,"uint",b);break;case 3:a.data=Z(this,"float",b);break;case 4:a.data=Z(this,"ushort",b);break;default:m(Error("Unsupported MGH/MGZ data type: "+a.type))}b=Td(a.data);a.min=b[0];a.max=b[1];this.R+16<this.L.byteLength&&(a.xh=Z(this,"float"),a.ri=Z(this,"float"),a.vh=Z(this,"float"),a.wh=Z(this,"float"));return a};C("X.parserMGZ",Sf);C("X.parserMGZ.prototype.parse",Sf.prototype.parse);function Tf(){Sd.call(this);this.f="parserCRV";this.Qd=u}D(Tf,Sd);
Tf.prototype.parse=function(a,b,c){E.Ea(this.f+".parse");var d=b.Dc;0==d.length&&m(Error("No _pointIndices defined on the X.object."));this.L=c;this.R=3;var e=Z(this,"uint");Z(this,"uint");Z(this,"uint");var f=0,g=0,h=0,j=0,k=0,l=0,n=0,q=0,s=0,A=0,z=0;c=Array(2);var G=Array(2),B=Z(this,"float",e),I;for(I=0;I<e;I++){var w=B[I];0==I&&(c[0]=G[0]=w);0<=w?(f++,j+=w):(g++,h+=w);s+=w;z++;G[0]=Math.max(w,G[0]);c[0]=Math.min(w,c[0]);B[I]=w}0!=f&&(k=j/f);0!=g&&(l=h/g);0!=z&&(A=s/z);for(z=s=h=j=0;z<e;z++)w=
B[z],I=0,0<=w?(I=Math.pow(w-k,2),j+=I):(I=Math.pow(w-l,2),h+=I),I=Math.pow(w-A,2),s+=I;1<f&&(n=Math.sqrt(j/(f-1)));1<g&&(q=Math.sqrt(h/(g-1)));c[1]=l-2.5*q;G[1]=k+2.5*n;e=d.length;f=new Float32Array(3*e);for(z=0;z<e;z++)g=B[d[z]],h=3*z,f[h]=g,f[h+1]=g,f[h+2]=g;b.I.Wa=c[1];b.I.ma=G[1];-Infinity==b.I.Z&&(b.I.Z=c[1]);Infinity==b.I.aa&&(b.I.aa=G[1]);b.I.H=B;b.I.Wc=f;b.I.j=r;E.xa(this.f+".parse");d=new pd;d.O=b;d.w=a;this.dispatchEvent(d)};C("X.parserCRV",Tf);C("X.parserCRV.prototype.parse",Tf.prototype.parse);function Uf(a,b){var c,d;this.input=a;this.J=0;if(b||!(b={}))b.index&&(this.J=b.index),b.verify&&(this.Tj=b.verify);c=a[this.J++];d=a[this.J++];switch(c&15){case 8:this.method=8;break;default:m(Error("unsupported compression method"))}0!==((c<<8)+d)%31&&m(Error("invalid fcheck flag:"+((c<<8)+d)%31));d&32&&m(Error("fdict flag is not supported"));this.hh=new of(a,{index:this.J,bufferSize:b.bufferSize,bufferType:b.bufferType,resize:b.resize})}
Uf.prototype.Wb=function(){var a=this.input,b;b=this.hh.Wb();this.J=this.hh.J;if(this.Tj){var a=(a[this.J++]<<24|a[this.J++]<<16|a[this.J++]<<8|a[this.J++])>>>0,c=b;if("string"===typeof c){var c=c.split(""),d,e;d=0;for(e=c.length;d<e;d++)c[d]=(c[d].charCodeAt(0)&255)>>>0}d=1;e=0;for(var f=c.length,g,h=0;0<f;){g=1024<f?1024:f;f-=g;do d+=c[h++],e+=d;while(--g);d%=65521;e%=65521}a!==(e<<16|d)>>>0&&m(Error("invalid adler-32 checksum"))}return b};function Vf(){Sd.call(this);this.f="parserRAW"}D(Vf,Sd);
Vf.prototype.parse=function(a,b,c,d){E.Ea(this.f+".parse");d&&(c=(new Uf(new Uint8Array(c))).Wb(),c=c.buffer);d={};d.data=new Uint8Array(c);var e=Td(d.data);c=e[0];e=e[1];d.min=b.Wa=b.ga=c;d.max=b.ma=b.fa=e;-Infinity==b.Z&&(b.Z=c);Infinity==b.aa&&(b.aa=e);e=Vc();d.wb=e;d.xb=Vc();var f=Tc(0,0,0,1);c=Sc();ed(e,f,c);var g=Tc(1,1,1,1),f=Sc();ed(e,g,f);e=Vd(e,b.Y);d.Uc=[f[0]-c[0],f[1]-c[1],f[2]-c[2]];d.Sc=[e[1]-e[0]+1,e[3]-e[2]+1,e[5]-e[4]+1];d.Tc=[e[0],e[2],e[4]];b.s=[0,0,0];b.lb(d);E.xa(this.f+".parse");
E.Ea(this.f+".reslice_old");b.ba=b.e!=t;b.Fa&&(b.Sf=b.Fa.Ka);b.ql=[0,0,0];b.s=[b.za[0]+(b.yb[0]-1)/2,b.za[1]+(b.yb[1]-1)/2,b.za[2]+(b.yb[2]-1)/2];b.ya=[Math.min(b.za[0],b.za[0]+b.yb[0]-1),Math.max(b.za[0],b.za[0]+b.yb[0]-1),Math.min(b.za[1],b.za[1]+b.yb[1]-1),Math.max(b.za[1],b.za[1]+b.yb[1]-1),Math.min(b.za[2],b.za[2]+b.yb[2]-1),Math.max(b.za[2],b.za[2]+b.yb[2]-1)];b.b=[{},{},{}];d=Qc(b.s[0],b.s[1],b.s[2]);b.b[0].nd=d;c=Qc(1,0,0);Rc(c,c);b.b[0].i=c;e=[1,0,0];b.b[0].D=e;Zd(0,d,c,b);b.c[0].c=Array(b.b[0].r);
d[0]=b.b[0].k[0][0][0]+b.b[0].z[0]*Math.floor(b.b[0].r/2);d[1]=b.b[0].k[0][0][1]+b.b[0].z[1]*Math.floor(b.b[0].r/2);d[2]=b.b[0].k[0][0][2]+b.b[0].z[2]*Math.floor(b.b[0].r/2);b.Ab=Math.floor(b.b[0].r/2);b.yc=Math.floor(b.b[0].r/2);d=Qc(b.s[0],b.s[1],b.s[2]);b.b[1].nd=d;c=Qc(0,1,0);Rc(c,c);b.b[1].i=c;e=[0,1,0];b.b[1].D=e;Zd(1,d,c,b);b.c[1].c=Array(b.b[1].r);d[0]=b.b[1].k[0][0][0]+b.b[1].z[0]*Math.floor(b.b[1].r/2);d[1]=b.b[1].k[0][0][1]+b.b[1].z[1]*Math.floor(b.b[1].r/2);d[2]=b.b[1].k[0][0][2]+b.b[1].z[2]*
Math.floor(b.b[1].r/2);b.Bb=Math.floor(b.b[1].r/2);b.zc=Math.floor(b.b[1].r/2);d=Qc(b.s[0],b.s[1],b.s[2]);b.b[2].nd=d;c=Qc(0,0,1);Rc(c,c);b.b[2].i=c;e=[0,0.392,0.804];b.b[2].D=e;Zd(2,d,c,b);b.c[2].c=Array(b.b[2].r);d[0]=b.b[2].k[0][0][0]+b.b[2].z[0]*Math.floor(b.b[2].r/2);d[1]=b.b[2].k[0][0][1]+b.b[2].z[1]*Math.floor(b.b[2].r/2);d[2]=b.b[2].k[0][0][2]+b.b[2].z[2]*Math.floor(b.b[2].r/2);b.Cb=Math.floor(b.b[2].r/2);b.Ac=Math.floor(b.b[2].r/2);E.xa(this.f+".reslice_old");$d(this,b);d=new pd;d.O=b;d.w=
a;this.dispatchEvent(d)};C("X.parserRAW",Vf);C("X.parserRAW.prototype.parse",Vf.prototype.parse);function Wf(){Sd.call(this);this.f="parserIMAGE"}D(Wf,Sd);Wf.prototype.parse=function(a,b,c,d){c instanceof ArrayBuffer||m(Error());for(var e=new Uint8Array(c),f=e.length,g=Array(f);f--;)g[f]=String.fromCharCode(e[f]);e=window.btoa(g.join(""));f=new Image;$b(f,"load",this.vj.bind(this,f,a,b,c,d));f.src="data:image/"+d+";base64,"+e};Wf.prototype.vj=function(a,b,c){b.Lb=a;b.ib=t;a=new pd;a.O=c;a.w=b;this.dispatchEvent(a)};C("X.parserIMAGE",Wf);C("X.parserIMAGE.prototype.parse",Wf.prototype.parse);function Xf(){Sd.call(this);this.f="parserLUT"}D(Xf,Sd);
Xf.prototype.parse=function(a,b,c){E.Ea(this.f+".parse");this.L=c;c=Z(this,"uchar",c.byteLength);var d=c.length,e=0,f;for(f=0;f<d;f++)if(10==c[f]){var g=Ud(c,e,f),e=f+1,g=g.replace(/^\s+|\s+$/g,"");"#"!=g[0]&&(g=g.split(" "),g=g.filter(function(a){return""!=a}),6==g.length&&(g[2]=parseInt(g[2],10)/255,g[3]=parseInt(g[3],10)/255,g[4]=parseInt(g[4],10)/255,g[5]=parseInt(g[5],10)/255,a.add(parseInt(g[0],10),g[1],g[2],g[3],g[4],g[5],10)))}E.xa(this.f+".parse");c=new pd;c.O=b;c.w=a;this.dispatchEvent(c)};
C("X.parserLUT",Xf);C("X.parserLUT.prototype.parse",Xf.prototype.parse);function Yf(){Sd.call(this);this.f="parserNRRD"}D(Yf,Sd);
Yf.prototype.parse=function(a,b,c){E.Ea(this.f+".parse");this.L=c;c=Z(this,"uchar",c.byteLength);var d=c.length,e=t,f=0,g;for(g=1;g<d;g++)if(10==c[g-1]&&10==c[g]){e=Ud(c,0,g-2);f=g+1;break}var h,j,k,l,d=e.split(/\r?\n/),e=0;for(g=d.length;e<g;e++)if(h=d[e],h.match(/NRRD\d+/))this.Ki=r;else if(!h.match(/^#/)&&(l=h.match(/(.*):(.*)/)))j=l[1].trim(),h=l[2].trim(),(k=this.ni[j])?k.call(this,h):this[j]=h;this.Ki||m(Error("Not an NRRD file"));"raw"!==this.encoding&&("gzip"!==this.encoding&&"gz"!==this.encoding)&&
m(Error("Only raw or gz/gzip encoding is allowed"));if(!this.da&&(this.da=[new U(1,0,0),new U(0,1,0),new U(0,0,1)],this.Jf)){d=[];for(l=0;2>=l;l++)d.push(!isNaN(this.Jf[l])?this.da[l].scale(this.Jf[l]):p)}f=c.subarray(f);if("gzip"==this.encoding||"gz"==this.encoding)f=(new Rf(new Uint8Array(f))).Wb();f=f.buffer;c={data:t,min:Infinity,max:-Infinity};c.data=new this.Jb(f);l=Td(c.data);f=c.min=l[0];l=c.max=l[1];b.Wa=b.ga=f;b.ma=b.fa=l;b.Y=[this.Hf[0],this.Hf[1],this.Hf[2]];d=(new U(this.da[0][0],this.da[0][1],
this.da[0][2])).Fb();e=(new U(this.da[1][0],this.da[1][1],this.da[1][2])).Fb();g=(new U(this.da[2][0],this.da[2][1],this.da[2][2])).Fb();b.sb=[d,e,g];-Infinity==b.Z&&(b.Z=f);Infinity==b.aa&&(b.aa=l);d=l=1;"left-posterior-superior"==this.Mj&&(d=l=-1);f=Vc();Zc(f,0,l*this.da[0][0],l*this.da[1][0],l*this.da[2][0],l*this.If[0]);Zc(f,1,d*this.da[0][1],d*this.da[1][1],d*this.da[2][1],d*this.If[1]);Zc(f,2,1*this.da[0][2],1*this.da[1][2],1*this.da[2][2],1*this.If[2]);Zc(f,3,0,0,0,1);c.wb=f;c.xb=Uc();cd(c.wb,
c.xb);d=Tc(0,0,0,1);l=Sc();ed(f,d,l);e=Tc(1,1,1,1);d=Sc();ed(f,e,d);f=Vd(f,b.Y);c.Uc=[d[0]-l[0],d[1]-l[1],d[2]-l[2]];c.Sc=[f[1]-f[0]+1,f[3]-f[2]+1,f[5]-f[4]+1];c.Tc=[f[0],f[2],f[4]];b.lb(c);E.xa(this.f+".parse");b.Lb=$d(this,b);c=new pd;c.O=b;c.w=a;this.dispatchEvent(c)};
Yf.prototype.ni={type:function(a){switch(a){case "uchar":case "unsigned char":case "uint8":case "uint8_t":this.Jb=Uint8Array;break;case "signed char":case "int8":case "int8_t":this.Jb=Int8Array;break;case "short":case "short int":case "signed short":case "signed short int":case "int16":case "int16_t":this.Jb=Int16Array;break;case "ushort":case "unsigned short":case "unsigned short int":case "uint16":case "uint16_t":this.Jb=Uint16Array;break;case "int":case "signed int":case "int32":case "int32_t":this.Jb=
Int32Array;break;case "uint":case "unsigned int":case "uint32":case "uint32_t":this.Jb=Uint32Array;break;case "float":this.Jb=Float32Array;break;case "double":this.Jb=Float64Array;break;default:m(Error("Unsupported NRRD data type: "+a))}return this.type=a},endian:function(a){return this.jl=a},encoding:function(a){return this.encoding=a},dimension:function(a){return this.Xb=parseInt(a,10)},sizes:function(a){var b,c,d,e;d=a.split(/\s+/);e=[];b=0;for(c=d.length;b<c;b++)a=d[b],e.push(parseInt(a,10));
return this.Hf=e},space:function(a){return this.Mj=a},"space origin":function(a){return this.If=a.split("(")[1].split(")")[0].split(",")},"space directions":function(a){var b,c;a=a.match(/\(.*?\)/g);var d,e,f;f=[];d=0;for(e=a.length;d<e;d++)c=a[d],f.push(function(){var a,d,e,f;e=c.slice(1,-1).split(/,/);f=[];a=0;for(d=e.length;a<d;a++)b=e[a],f.push(parseFloat(b));return f}());return this.da=f},spacings:function(a){var b;b=a.split(/\s+/);var c,d,e;e=[];c=0;for(d=b.length;c<d;c++)a=b[c],e.push(parseFloat(a));
return this.Jf=e}};C("X.parserNRRD",Yf);C("X.parserNRRD.prototype.parse",Yf.prototype.parse);function Zf(){Sd.call(this);this.f="parserSTL"}D(Zf,Sd);
Zf.prototype.parse=function(a,b,c){E.Ea(this.f+".parse");this.L=c;var d=b.h,e=b.n;if("solid"==Ud(Z(this,"uchar",5))){b.h=d=new V(c.byteLength);b.n=e=new V(c.byteLength);var f=d,d=e,e=Z(this,"uchar",c.byteLength-5);c=e.length;var g=u,h=u,j=0,k;for(k=0;k<c;k++)if(10==e[k]){if(g||h){var l=Ud(e,j,k).split(" "),h=parseFloat(l[0]),n=parseFloat(l[1]),l=parseFloat(l[2]);g?(d.add(h,n,l),d.add(h,n,l),d.add(h,n,l)):f.add(h,n,l);h=g=u}}else 32==e[k-1]&&(102==e[k]?(j=k+=13,g=r):118==e[k]&&(j=k+=7,h=r))}else{this.R=
80;f=Z(this,"uint");b.h=d=new V(9*f);b.n=e=new V(9*f);for(c=c=0;c<f;c++)g=Z(this,"float",12),j=g[0],k=g[1],h=g[2],e.add(j,k,h),e.add(j,k,h),e.add(j,k,h),d.add(g[3],g[4],g[5]),d.add(g[6],g[7],g[8]),d.add(g[9],g[10],g[11]),this.R+=2}E.xa(this.f+".parse");f=new pd;f.O=b;f.w=a;this.dispatchEvent(f)};C("X.parserSTL",Zf);C("X.parserSTL.prototype.parse",Zf.prototype.parse);function $f(){Sd.call(this);this.f="parserNII"}D($f,Sd);
$f.prototype.parse=function(a,b,c){var d=c,e=-1,e="undefined"==typeof DataView?(new Int32Array(c,0,1))[0]:(new DataView(c,0)).getInt32(0,r);348!=e&&(d=(new Rf(new Uint8Array(d))).Wb(),d=d.buffer);c=this.Dd(d);d=c.min;e=c.max;b.Wa=b.ga=d;b.ma=b.fa=e;-Infinity==b.Z&&(b.Z=d);Infinity==b.aa&&(b.aa=e);d=Uc();Zc(d,3,0,0,0,1);if(0<c.Df){var e=0,f=c.dh,g=c.eh,h=c.fh,j=1,k=1,l=1,n=c.$g,q=c.ah,s=c.bh,e=1-(f*f+g*g+h*h);1E-7>e?(e=1/Math.sqrt(f*f+g*g+h*h),f*=e,g*=e,h*=e,e=0):e=Math.sqrt(e);0<c.nb[1]&&(j=c.nb[1]);
0<c.nb[2]&&(k=c.nb[2]);0<c.nb[2]&&(l=c.nb[3]);0>c.nb[0]&&(l=-l);Zc(d,0,(e*e+f*f-g*g-h*h)*j,2*(f*g-e*h)*k,2*(f*h+e*g)*l,n);Zc(d,1,2*(f*g+e*h)*j,(e*e+g*g-f*f-h*h)*k,2*(g*h-e*f)*l,q);Zc(d,2,2*(f*h-e*g)*j,2*(g*h+e*f)*k,(e*e+h*h-g*g-f*f)*l,s)}else 0<c.ih?(e=c.kh,f=c.lh,g=c.mh,Zc(d,0,e[0],e[1],e[2],e[3]),Zc(d,1,f[0],f[1],f[2],f[3]),Zc(d,2,g[0],g[1],g[2],g[3])):0==c.Df?(Zc(d,0,c.nb[1],0,0,0),Zc(d,1,0,c.nb[2],0,0),Zc(d,2,0,0,c.nb[3],0)):window.console.log("UNKNOWN METHOD IN PARSER NII");c.wb=d;c.xb=Uc();
cd(c.wb,c.xb);f=Tc(0,0,0,1);e=Sc();ed(d,f,e);g=Tc(1,1,1,1);f=Sc();ed(d,g,f);g=[c.Xb[1],c.Xb[2],c.Xb[3]];d=Vd(d,g);c.Uc=[f[0]-e[0],f[1]-e[1],f[2]-e[2]];c.Sc=[d[1]-d[0]+1,d[3]-d[2]+1,d[5]-d[4]+1];c.Tc=[d[0],d[2],d[4]];b.Y=g;b.lb(c);b.Lb=$d(this,b);c=new pd;c.O=b;c.w=a;this.dispatchEvent(c)};
$f.prototype.Dd=function(a){this.L=a;a={Gj:0,di:t,ei:t,mi:0,Ej:0,zj:0,ii:t,Xb:t,Gi:0,Hi:0,Ii:0,Ei:0,ef:0,Zh:0,Lj:0,nb:t,rh:0,Dj:0,Cj:0,Kj:0,Ij:t,Vj:t,$h:0,ai:0,Jj:0,Qj:0,ti:0,ui:0,gi:t,Yh:t,Df:0,ih:0,dh:0,eh:0,fh:0,$g:0,ah:0,bh:0,kh:t,lh:t,mh:t,Fi:t,Mi:t,data:t,min:Infinity,max:-Infinity};a.Gj=Z(this,"uint");a.di=Z(this,"uchar",10);a.ei=Z(this,"uchar",18);a.mi=Z(this,"uint");a.Ej=Z(this,"ushort");a.zj=Z(this,"uchar");a.ii=Z(this,"uchar");a.Xb=Z(this,"ushort",8);a.Gi=Z(this,"float");a.Hi=Z(this,"float");
a.Ii=Z(this,"float");a.Ei=Z(this,"ushort");a.ef=Z(this,"ushort");a.Zh=Z(this,"ushort");a.Lj=Z(this,"ushort");a.nb=Z(this,"float",8);a.rh=Z(this,"float");a.Dj=Z(this,"float");a.Cj=Z(this,"float");a.Kj=Z(this,"ushort");a.Ij=Z(this,"uchar");a.Vj=Z(this,"uchar");a.$h=Z(this,"float");a.ai=Z(this,"float");a.Jj=Z(this,"float");a.Qj=Z(this,"float");a.ti=Z(this,"uint",1);a.ui=Z(this,"uint",1);a.gi=Z(this,"uchar",80);a.Yh=Z(this,"uchar",24);a.Df=Z(this,"ushort");a.ih=Z(this,"ushort");a.dh=Z(this,"float");a.eh=
Z(this,"float");a.fh=Z(this,"float");a.$g=Z(this,"float");a.ah=Z(this,"float");a.bh=Z(this,"float");a.kh=Z(this,"float",4);a.lh=Z(this,"float",4);a.mh=Z(this,"float",4);a.Fi=Z(this,"uchar",16);a.Mi=Z(this,"uchar",4);this.R=parseInt(a.rh,10);var b=a.Xb[1]*a.Xb[2]*a.Xb[3];switch(a.ef){case 2:a.data=Z(this,"uchar",b);break;case 4:a.data=Z(this,"sshort",b);break;case 8:a.data=Z(this,"sint",b);break;case 16:a.data=Z(this,"float",b);break;case 32:a.data=Z(this,"complex",b);break;case 64:a.data=Z(this,"double",
b);break;case 256:a.data=Z(this,"schar",b);break;case 512:a.data=Z(this,"ushort",b);break;case 768:a.data=Z(this,"uint",b);break;default:m(Error("Unsupported NII data type: "+a.ef))}b=Td(a.data);a.min=b[0];a.max=b[1];return a};C("X.parserNII",$f);C("X.parserNII.prototype.parse",$f.prototype.parse);function ag(){Sd.call(this);this.f="parserTRK"}D(ag,Sd);
ag.prototype.parse=function(a,b,c){E.Ea(this.f+".parse");var d=b.h,e=b.n,f=b.la;this.L=c;Z(this,"uchar",6);Z(this,"ushort",3);var g=Z(this,"float",3);Z(this,"float",3);var h=Z(this,"ushort");Z(this,"uchar",200);Z(this,"ushort");Z(this,"uchar",200);c=Z(this,"float",16);Z(this,"uchar",444);Z(this,"uchar",4);Z(this,"uchar",4);Z(this,"float",6);Z(this,"uchar",2);Z(this,"uchar");Z(this,"uchar");Z(this,"uchar");Z(this,"uchar");Z(this,"uchar");Z(this,"uchar");var j=Z(this,"uint");Z(this,"uint");var k=Z(this,
"uint"),l=[],n=[],q=Infinity,s=-Infinity,A=t,z=t,G=t,B=t,e=d=t,I=Z(this,"uint",(this.L.byteLength-1E3)/4);this.R=k;for(var w=Z(this,"float",(this.L.byteLength-1E3)/4),H=0,k=f=0;k<j;k++){for(var F=I[H],J=new V(3*F),S=0,N=0;N<F;N++){var O=w[H+3*N+N*h+1],ea=w[H+3*N+N*h+2],P=w[H+3*N+N*h+3],O=O/g[0],ea=ea/g[1],P=P/g[2];J.add(O,ea,P);if(0<N)var da=J.get(N-1),S=S+Math.sqrt(Math.pow(O-da[0],2)+Math.pow(ea-da[1],2)+Math.pow(P-da[2],2));N<F-1&&(f+=6)}H+=3*F+F*h+1;N=J.fb;F=J.bb;O=J.gb;ea=J.cb;P=J.hb;da=J.eb;
if(!A||N<A)A=N;if(!z||F>z)z=F;if(!G||O<G)G=O;if(!B||ea>B)B=ea;if(!d||P<d)d=P;if(!e||da>e)e=da;l.push(J);n.push(S)}g=(A+z)/2;G=(G+B)/2;h=(d+e)/2;B=new Float32Array(f);b.h=d=new V(f);b.n=e=new V(f);b.la=f=new V(f);for(k=A=0;k<j;k++){z=l[k];I=z.count;S=n[k];q=Math.min(q,S);s=Math.max(s,S);for(N=0;N<I-1;N++){H=z.get(N);w=z.get(N+1);d.add(H[0],H[1],H[2]);d.add(w[0],w[1],w[2]);var J=H[0]-g,F=H[1]-G,O=H[2]-h,ea=Math.sqrt(J*J+F*F+O*O),P=w[0]-g,da=w[1]-G,M=w[2]-h,Y=Math.sqrt(P*P+da*da+M*M);e.add(J/ea,F/ea,
O/ea);e.add(P/Y,da/Y,M/Y);w=[Math.abs(w[0]-H[0]),Math.abs(w[1]-H[1]),Math.abs(w[2]-H[2])];H=Math.sqrt(w[0]*w[0]+w[1]*w[1]+w[2]*w[2]);w[0]/=H;w[1]/=H;w[2]/=H;f.add(w[0],w[1],w[2]);f.add(w[0],w[1],w[2]);B[A++]=S;B[A++]=S;B[A++]=S;B[A++]=S;B[A++]=S;B[A++]=S}}b.Da="LINES";j=new md;j.Wa=q;j.ma=s;j.Z=q;j.aa=s;j.Wc=B;j.kg=u;j.j=r;b.I=j;q=u;for(k=0;16>k;k++)if(0!=c[k]){q=r;break}q==u&&(c[0]=c[5]=c[10]=c[15]=1);E.xa(this.f+".parse");E.g.Mf(c,b.ea.N);c=new pd;c.O=b;c.w=a;this.dispatchEvent(c)};
C("X.parserTRK",ag);C("X.parserTRK.prototype.parse",ag.prototype.parse);function bg(){Sd.call(this);this.f="parserOBJ"}D(bg,Sd);
bg.prototype.parse=function(a,b,c){E.Ea(this.f+".parse");this.L=c;c=c.byteLength;var d=Z(this,"uchar",c),e=[];b.h=new V(c);b.n=new V(c);var f=b.h,g=b.n,h=0,j;for(j=0;j<c;++j)if(10==d[j]){var k=Ud(d,h,j).replace(/\s{2,}/g," ").split(" ");if("v"==k[0])e.push([parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3])]);else if("f"==k[0]){var l=e[parseInt(k[1],10)-1],h=e[parseInt(k[2],10)-1],k=e[parseInt(k[3],10)-1];f.add(l[0],l[1],l[2]);f.add(h[0],h[1],h[2]);f.add(k[0],k[1],k[2]);l=new U(l[0],l[1],l[2]);k=
new U(k[0],k[1],k[2]);h=Lc((new U(h[0],h[1],h[2])).ra(l),k.ra(l));h.normalize();g.add(h.x,h.y,h.d);g.add(h.x,h.y,h.d);g.add(h.x,h.y,h.d)}h=j+1}E.xa(this.f+".parse");c=new pd;c.O=b;c.w=a;this.dispatchEvent(c)};C("X.parserOBJ",bg);C("X.parserOBJ.prototype.parse",bg.prototype.parse);function cg(){L.call(this);this.f="loader";this.Bc=new Bc;this.kd=0}D(cg,L);function dg(a,b){a.kd+=b/a.Bc.fe()/3;a.kd=Math.min(1,a.kd);var c=new Rd;c.Te=a.kd;a.dispatchEvent(c)}function eg(a){a=a.q.Td;var b=a.split(".").pop().toUpperCase();b==a.toUpperCase()&&(b="");b in fg||m(Error("The "+b+" file format is not supported."));return[a,b,fg[b][0],fg[b][1],fg[b][2]]}
cg.prototype.load=function(a,b){(!a||!b)&&m(Error("No container or object to load."));if(!Fc(this.Bc.ca,a.ta)||this.Bc.get(a.ta)){this.Bc.set(a.ta,u);var c=eg(a)[0];if(a.pb!=t)this.parse(t,a,b);else{var d=new XMLHttpRequest;K(d,"abort",this.xg.bind(this,d,a,b));K(d,"error",this.xg.bind(this,d,a,b));K(d,"load",this.parse.bind(this,d,a,b));d.open("GET",c,r);d.responseType="arraybuffer";d.send(t)}}};
cg.prototype.parse=function(a,b,c){dg(this,1);setTimeout(function(){var d=eg(b),e=d[3],d=new d[2];$b(d,Cd,this.complete.bind(this));var f=b.pb;f==t&&(f=a.response,b.pb=f);d.parse(b,c,f,e)}.bind(this),100)};cg.prototype.complete=function(a){dg(this,1);setTimeout(function(){var b=a.w,c=a.O;b.q.j=u;b.j=r;c.p();this.Bc.set(b.ta,r)}.bind(this),100)};cg.prototype.xg=function(a,b,c){m(Error("Loading failed: ",b,c))};
var fg={OBJ:[bg,t],OFF:[ff,t],STL:[Zf,t],VTK:[jf,t],TRK:[ag,t],FSM:[lf,t],INFLATED:[lf,t],SMOOTHWM:[lf,t],SPHERE:[lf,t],PIAL:[lf,t],ORIG:[lf,t],NRRD:[Yf,t],NII:[$f,t],GZ:[$f,t],DCM:[gf,t],DICOM:[gf,t],"":[gf,t],CRV:[Tf,t],LABEL:[ae,t],MGH:[Sf,u],MGZ:[Sf,r],RAW:[Vf,u],RZ:[Vf,r],TXT:[Xf,t],LUT:[Xf,t],PNG:[Wf,"png"],JPG:[Wf,"jpeg"],JPEG:[Wf,"jpeg"],GIF:[Wf,"gif"]};function gg(a,b){(!y(a)||!y(b))&&m(Error("A camera needs valid width and height values."));L.call(this);this.f="camera";this.fc=new E.m(0,100,0);this.vc=new E.m(0,0,0);this.ja=new E.m(0,0,1);this.A=a;this.u=b;this.o=this.ne(this.fc,this.vc)}D(gg,L);gg.prototype.observe=function(a){(a==t||!(a instanceof Te))&&m(Error("Could not observe the interactor."));K(a,xd,this.gj.bind(this));K(a,wd,this.dj.bind(this));K(a,yd,this.tj.bind(this))};
gg.prototype.gj=function(a){a instanceof Md||m(Error("Received no valid rotate event."));this.rotate(a.Ba)};gg.prototype.tj=function(a){a instanceof Nd||m(Error("Received no valid zoom event."));a.xc?this.Qf(a.dc):this.Rf(a.dc)};gg.prototype.dj=function(a){a instanceof Ld||m(Error("Received no valid pan event."));this.Af(a.Ba)};gg.prototype.__defineGetter__("view",v("o"));
gg.prototype.__defineSetter__("view",function(a){(a==t||!(a instanceof Float32Array))&&m(Error("Invalid view matrix."));this.o=a});gg.prototype.__defineGetter__("position",function(){return[this.fc.x,this.fc.y,this.fc.d]});gg.prototype.__defineSetter__("position",function(a){(a==t||!ja(a)||3!=a.length)&&m(Error("Invalid position."));this.fc=new E.m(a[0],a[1],a[2]);this.reset()});gg.prototype.__defineGetter__("focus",function(){return[this.vc.x,this.vc.y,this.vc.d]});
gg.prototype.__defineSetter__("focus",function(a){(a==t||!ja(a)||3!=a.length)&&m(Error("Invalid focus"));this.vc=new E.m(a[0],a[1],a[2]);this.reset()});gg.prototype.__defineGetter__("up",function(){return[this.ja.x,this.ja.y,this.ja.d]});gg.prototype.__defineSetter__("up",function(a){(a==t||!ja(a)||3!=a.length)&&m(Error("Invalid up vector."));this.ja=new E.m(a[0],a[1],a[2]);this.reset()});x=gg.prototype;x.reset=function(){this.o=this.ne(this.fc,this.vc)};
x.rotate=function(a){ja(a)&&2==a.length?a=new E.m(a[0],a[1],0):a instanceof E.m||m(Error("Invalid distance vector for rotate operation."));return a};x.Af=function(a){ja(a)&&2==a.length?a=new E.m(a[0],a[1],0):a instanceof E.m||m(Error("Invalid distance vector for pan operation."));this.o[12]-=a.x;this.o[13]+=a.y};x.Qf=function(a){var b=20;a!=t&&!a&&(b=1);this.o[14]+=b};x.Rf=function(a){var b=20;a!=t&&!a&&(b=1);this.o[14]-=b};
x.ne=function(a,b){(!(a instanceof E.m)||!(b instanceof E.m))&&m(Error("3D vectors required for calculating the view."));return E.g.yd()};C("X.camera",gg);C("X.camera.prototype.pan",gg.prototype.Af);C("X.camera.prototype.rotate",gg.prototype.rotate);C("X.camera.prototype.zoomIn",gg.prototype.Qf);C("X.camera.prototype.zoomOut",gg.prototype.Rf);function hg(a){function b(a,b,d){b=2*b*Math.PI;b=Aa(Ba(j,Math.cos(b)),Ba(k,Math.sin(b)));a=Aa(Aa(c,Ba(e,a)),Ba(b,f));d=Aa(Ba(b,1-Math.abs(d)),Ba(g,d));return new mc(a,d)}this.U=[];a=a||{};var c=new za(a.start||[0,-1,0]),d=new za(a.end||[0,1,0]),e=Ca(d,c),f=a.tb||1;a=a.na||16;for(var g=Da(e),h=0.5<Math.abs(g.y()),j=Da((new za(h,!h,0)).lc(g)),k=Da(j.lc(g)),h=new mc(c,Ea(g)),d=new mc(d,Da(g)),l=[],n=0;n<a;n++){var q=n/a,s=(n+1)/a;l.push(new oc([h,b(0,q,-1),b(0,s,-1)]));l.push(new oc([b(0,s,0),b(0,q,
0),b(1,q,0),b(1,s,0)]));l.push(new oc([d,b(1,s,1),b(1,q,1)]))}return wc(l)}D(hg,vc);function ig(){W.call(this);this.f="cylinder";this.Re=[-10,-10,-10];this.Be=[10,10,10];this.gc=10;this.Za=32;Fa(this,new sd)}D(ig,W);ig.prototype.__defineGetter__("start",v("Re"));ig.prototype.__defineSetter__("start",function(a){(a==t||!ja(a)||3!=a.length)&&m(Error("Invalid start"));this.Re=a});ig.prototype.__defineGetter__("end",v("Be"));ig.prototype.__defineSetter__("end",function(a){(a==t||!ja(a)||3!=a.length)&&m(Error("Invalid end"));this.Be=a});ig.prototype.__defineGetter__("radius",v("gc"));
ig.prototype.__defineSetter__("radius",function(a){y(a)||m(Error("Invalid radius."));this.gc=a});ig.prototype.p=function(){ud(this,new hg({start:this.Re,end:this.Be,tb:this.gc,na:this.Za}));ig.B.p.call(this)};C("X.cylinder",ig);C("X.cylinder.prototype.modified",ig.prototype.p);function jg(a){function b(a,b){a*=2*Math.PI;b*=Math.PI;var e=new za(Math.cos(a)*Math.sin(b),Math.cos(b),Math.sin(a)*Math.sin(b));g.push(new mc(Aa(c,Ba(e,d)),e))}this.U=[];a=a||{};var c=new za(a.af||[0,0,0]),d=a.tb||1,e=a.na||16;a=a.Nj||8;for(var f=[],g=[],h=0;h<e;h++)for(var j=0;j<a;j++)g=[],b(h/e,j/a),0<j&&b((h+1)/e,j/a),j<a-1&&b((h+1)/e,(j+1)/a),b(h/e,(j+1)/a),f.push(new oc(g));return wc(f)}D(jg,vc);function kg(){W.call(this);this.f="sphere";this.v=[0,0,0];this.gc=5;this.Za=32;this.Nh=16;Fa(this,new sd)}D(kg,W);kg.prototype.__defineGetter__("center",v("v"));kg.prototype.__defineSetter__("center",function(a){(a==t||!ja(a)||3!=a.length)&&m(Error("Invalid center"));this.v=a});kg.prototype.__defineGetter__("radius",v("gc"));kg.prototype.__defineSetter__("radius",function(a){y(a)||m(Error("Invalid radius."));this.gc=a});
kg.prototype.p=function(){ud(this,new jg({af:this.v,tb:this.gc,na:this.Za,Nj:this.Nh}));kg.B.p.call(this)};C("X.sphere",kg);C("X.sphere.prototype.modified",kg.prototype.p);function ef(a){Q.call(this);this.f="labelmap";this.$a=a;this.Qe=new Float32Array([-255,-255,-255,-255]);this.Id=u;this.Yk=this.Xk=this.Tk=t}D(ef,Q);ef.prototype.p=function(){var a=new pd;a.O=this;this.dispatchEvent(a);this.$a.p()};ef.prototype.__defineSetter__("use32bit",ba("Id"));
ef.prototype.__defineSetter__("showOnly",function(a){var b=[-1,-1,-1,-1];a!=t&&(ja(a)&&4==a.length?b=a:(this.Fa||m(Error("No colortable assigned.")),b=this.Fa.Ka.get(a).slice(1,5)));this.Qe=new Float32Array([Math.floor(255*b[0]),Math.floor(255*b[1]),Math.floor(255*b[2]),Math.floor(255*b[3])])});C("X.labelmap",ef);function lg(a){this.U=[];a=a||{};var b=new za(a.af||[0,0,0]),c=!a.tb?[1,1,1]:a.tb.length?a.tb:[a.tb,a.tb,a.tb];return wc([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(a){return new oc(a[0].map(function(e){e=new za(b.x()+c[0]*(2*!!(e&1)-1),b.y()+c[1]*(2*!!(e&2)-1),b.d()+c[2]*(2*!!(e&4)-1));return new mc(e,new za(a[1]))}))}))}D(lg,vc);function mg(){W.call(this);this.f="cube";this.v=[0,0,0];this.Ge=this.Fe=this.Ee=20;this.Kc=[0,1,1,1,1,0,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,1,1,1,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0];Fa(this,new sd)}D(mg,W);mg.prototype.__defineGetter__("center",v("v"));mg.prototype.__defineSetter__("center",function(a){(a==t||!ja(a)||3!=a.length)&&m(Error("Invalid center"));this.v=a});mg.prototype.__defineGetter__("lengthX",v("Ee"));
mg.prototype.__defineSetter__("lengthX",function(a){y(a)||m(Error("Invalid lengthX."));this.Ee=a});mg.prototype.__defineGetter__("lengthY",v("Fe"));mg.prototype.__defineSetter__("lengthY",function(a){y(a)||m(Error("Invalid lengthY."));this.Fe=a});mg.prototype.__defineGetter__("lengthZ",v("Ge"));mg.prototype.__defineSetter__("lengthZ",function(a){y(a)||m(Error("Invalid lengthZ."));this.Ge=a});mg.prototype.p=function(){ud(this,new lg({af:this.v,tb:[this.Ee/2,this.Fe/2,this.Ge/2]}));mg.B.p.call(this)};
C("X.cube",mg);C("X.cube.prototype.modified",mg.prototype.p);function Ve(a){Te.call(this,a);this.f="interactor3D";this.Uk=u}D(Ve,Te);Ve.prototype.Bd=function(a){Ve.B.Bd.call(this,a);var b=new Nd;a.Oc==t&&(a.Oc=0);b.xc=0>a.Oc;b.dc=r;this.dispatchEvent(b)};function ng(a){L.call(this);this.f="array";this.H=[];this.Tf=a}D(ng,L);function og(a,b,c){for(var d=0;4>d;d++)if(a[d+0]!==b[d+c])return u;return r}ng.prototype.add=function(a){this.H.push(a);return r};ng.prototype.remove=function(a){a=this.H.indexOf(a);-1<a&&this.H.splice(a,1);return r};ng.prototype.clear=function(){this.H.length=0};
function pg(a,b,c){var d=c-b;if(!(2>d)){d=b+Math.floor(d/2);pg(a,b,d);for(pg(a,d,c);b<d;++b)if(0<a.Tf(a.H[b],a.H[d])){var e=a.H[b];a.H[b]=a.H[d];for(var f=a,g=d,h=c;g+1<h&&0>f.Tf(f.H[g+1],e);){var j=f,k=g+1,l=j.H[g];j.H[g]=j.H[k];j.H[k]=l;++g}f.H[g]=e}}}ng.prototype.sort=function(){pg(this,0,this.H.length)};function qg(a,b){gg.call(this,a,b);this.f="camera2D"}D(qg,gg);qg.prototype.rotate=function(a){a=qg.B.rotate.call(this,a);var b=new Kd;0<a.x?b.Ue--:0>a.x&&b.Ue++;0<a.y?b.He++:0>a.y&&b.He--;this.dispatchEvent(b)};qg.prototype.Qf=function(a){var b=20;a!=t&&!a&&(b=0.02);this.o[14]+=b};qg.prototype.Rf=function(a){var b=20;a!=t&&!a&&(b=0.02);this.o[14]-=b};
qg.prototype.Af=function(a){ja(a)&&2==a.length?a=new E.m(a[0],a[1],0):a instanceof E.m||m(Error("Invalid distance vector for pan operation."));this.o[12]-=a.x/this.o[14];this.o[13]+=a.y/this.o[14]};function rg(a,b){gg.call(this,a,b);this.f="camera3D";this.Wf=45;this.Ne=E.g.nf(E.g.yd(),this.Wf,a/b,1,1E4)}D(rg,gg);rg.prototype.rotate=function(a){a=rg.B.rotate.call(this,a);var b=-a.x/5*Math.PI/180;a=-a.y/5*Math.PI/180;var c=new E.m(this.o[1],this.o[5],this.o[9]),d=new E.m(this.o[0],this.o[4],this.o[8]);c.normalize();d.normalize();E.g.rotate(this.o,b,c.x,c.y,c.d);E.g.rotate(this.o,a,d.x,d.y,d.d)};rg.prototype.ne=function(a,b){var c=rg.B.ne.call(this,a,b);E.g.Mg(c,a,b,this.ja);return c};
function sg(a,b,c,d){var e=new Float32Array(4),f=new Float32Array(4),g=new Float32Array(16),h=new Float32Array(16);new Float32Array(16);E.g.multiply(a.Ne,a.o,h);E.g.T(h,g);e[0]=b;e[1]=c;e[2]=2*d-1;e[3]=1;E.g.Qg(g,e,f);f[3]=1/f[3];f[0]*=f[3];f[1]*=f[3];f[2]*=f[3];return f}C("X.camera3D",rg);function tg(a){Pb.call(this);this.Eb=a;this.Q=[]}D(tg,Pb);var ug=[];function vg(a,b,c,d,e){ja(c)||(ug[0]=c,c=ug);for(var f=0;f<c.length;f++){var g=K(b,c[f],d||a,e||u,a.Eb||a);a.Q.push(g)}}tg.prototype.Ef=function(){Jb(this.Q,ec);this.Q.length=0};tg.prototype.handleEvent=function(){m(Error("EventHandler.handleEvent not implemented"))};function wg(){}wg.zg=function(){return wg.Hg?wg.Hg:wg.Hg=new wg};wg.prototype.Ri=0;wg.zg();function xg(a){lc.call(this);this.Yb=a||he();this.Bj=yg}D(xg,lc);xg.prototype.Ci=wg.zg();var yg=t;x=xg.prototype;x.Gg=t;x.Qc=u;x.G=t;x.Bj=t;x.Cd=t;x.wd=t;x.bf=t;x.t=v("G");x.Gf=function(a){this.Cd&&this.Cd!=a&&m(Error("Method not supported"));xg.B.Gf.call(this,a)};x.ge=v("Yb");x.Nc=function(){this.G=this.Yb.createElement("div")};x.ac=function(a){this.bc(a)};
x.bc=function(a,b){this.Qc&&m(Error("Component already rendered"));this.G||this.Nc();a?a.insertBefore(this.G,b||t):this.Yb.ha.body.appendChild(this.G);(!this.Cd||this.Cd.Qc)&&this.ce()};x.ce=function(){function a(a){!a.Qc&&a.t()&&a.ce()}this.Qc=r;this.wd&&Jb(this.wd,a,p)};x.de=function(){function a(a){a.Qc&&a.de()}this.wd&&Jb(this.wd,a,p);this.vi&&this.vi.Ef();this.Qc=u};
x.removeChild=function(a,b){if(a){var c=la(a)?a:a.Gg||(a.Gg=":"+(a.Ci.Ri++).toString(36)),d;this.bf&&c?(d=this.bf,d=(c in d?d[c]:p)||t):d=t;a=d;c&&a&&(d=this.bf,c in d&&delete d[c],Nb(this.wd,a),b&&(a.de(),a.G&&qe(a.G)),c=a,c==t&&m(Error("Unable to set parent component")),c.Cd=t,xg.B.Gf.call(c,t))}a||m(Error("Child is not in parent component"));return a};function zg(){lc.call(this)}D(zg,lc);x=zg.prototype;x.Of=0;x.Ad=0;x.of=100;x.wg=0;x.Kf=1;x.Ji=u;x.Qi=u;x.Gd=function(a){a=Ag(this,a);this.Of!=a&&(this.Of=a+this.wg>this.of?this.of-this.wg:a<this.Ad?this.Ad:a,!this.Ji&&!this.Qi&&this.dispatchEvent("change"))};x.je=function(){return Ag(this,this.Of)};x.ie=function(){return Ag(this,this.Ad)};x.he=function(){return Ag(this,this.of)};function Ag(a,b){return a.Kf==t?b:a.Ad+Math.round((b-a.Ad)/a.Kf)*a.Kf};function Bg(a){xg.call(this,a);this.Ed=new zg;K(this.Ed,"change",this.wi,u,this)}D(Bg,xg);var Pg={vertical:"progress-bar-vertical",horizontal:"progress-bar-horizontal"};x=Bg.prototype;x.Nc=function(){this.ub=this.ge().Nc("div","progress-bar-thumb");var a=Pg[this.Xg];this.G=this.ge().Nc("div",a,this.ub);Qg(this);a=this.ie();this.t().setAttribute("aria-valuemin",a);a=this.he();this.t().setAttribute("aria-valuemax",a)};
x.ce=function(){Bg.B.ce.call(this);lb&&7>ub&&K(this.t(),"resize",this.xe,u,this);this.xe();var a=this.t();a.setAttribute("role","progressbar");a.setAttribute("aria-live","polite")};x.de=function(){Bg.B.de.call(this);lb&&7>ub&&ac(this.t(),"resize",this.xe,u,this)};x.je=function(){return this.Ed.je()};x.Gd=function(a){this.Ed.Gd(a);this.t()&&Qg(this)};function Qg(a){var b=a.je();a.t().setAttribute("aria-valuenow",b)}x.ie=function(){return this.Ed.ie()};x.he=function(){return this.Ed.he()};x.Xg="horizontal";
x.wi=function(){this.xe();this.dispatchEvent("change")};x.xe=function(){if(this.ub){var a=this.ie(),b=this.he(),a=(this.je()-a)/(b-a),b=Math.round(100*a);"vertical"==this.Xg?lb&&7>ub?(this.ub.style.top=0,this.ub.style.height="100%",b=this.ub.offsetHeight,a=Math.round(a*b),this.ub.style.top=b-a+"px",this.ub.style.height=a+"px"):(this.ub.style.top=100-b+"%",this.ub.style.height=b+"%"):this.ub.style.width=b+"%"}};function Rg(a,b){a==t&&m(Error("No valid parent element."));b==t&&m(Error("Invalid initial value."));Bg.call(this);this.f="progressbar";this.Xa=a;this.Me="";this.Ld=this.Db=t;this.cc=[];var c;c=".progress-bar-horizontal {\n  position: relative;\n  border: 1px solid #949dad;\n";c+="  background: white;\n";c+="  padding: 1px;\n";c+="  overflow: hidden;\n";c+="  margin: 2px;\n";c+="  width: 100px;\n";c+="  height: 5px;\n";c+="}";var d;d=".progress-bar-thumb {\n  position: relative;\n  background: #F62217;\n";
d+="  overflow: hidden;\n";d+="  width: 0%;\n";d+="  height: 100%;\n";d+="}";var e;e=".progress-bar-thumb-done {\n  background: #57E964;\n}";this.cc=[c,d,e];this.Gd(b);this.jf()}D(Rg,Bg);
Rg.prototype.jf=function(){var a=ye(this.Xa,"position");if("static"==a||""==a)this.Me=this.Xa.style.position,this.Xa.style.position="relative";var a=document.getElementsByTagName("head")[0],b=ne("style");b.type="text/css";b.media="screen";var c=document.createTextNode(String(this.cc[0])),d=document.createTextNode(String(this.cc[1])),e=document.createTextNode(String(this.cc[2]));a.appendChild(b);b.appendChild(c);b.appendChild(d);b.appendChild(e);this.Db=b;this.ac(this.Xa);a=this.t();a.style.position=
"absolute";a.style.top=(this.Xa.clientHeight-5)/2+"px";a.style.left=(this.Xa.clientWidth-100)/2+"px";a.classList.add("xtk-progress-bar")};function Sg(a){var b=a.t().style.top,c=a.t().style.left;qe(a.t());var d=new Rg(a.Xa,100),e=d.t();e.style.position="absolute";e.style.top=b;e.style.left=c;e.classList.add("xtk-progress-bar");(e.firstElementChild!=p?e.firstElementChild:re(e.firstChild)).classList.add("progress-bar-thumb-done");a.Ld=d}
Rg.prototype.zd=function(){this.Db&&qe(this.Db);this.t()&&qe(this.t());this.Ld&&qe(this.Ld.t());this.Ld=this.Db=t;this.Me&&(this.Xa.style.position=this.Me)};function Tg(a,b,c){ma(a)?c&&(a=va(a,c)):a&&"function"==typeof a.handleEvent?a=va(a.handleEvent,a):m(Error("Invalid listener argument"));return 2147483647<b?-1:ca.setTimeout(a,b||0)};function Ug(){L.call(this);this.f="renderer";this.w=window.document.body;this.A=this.w.clientWidth;this.u=this.w.clientHeight;this.S=this.K=this.Aa=t;this.rb=new ng(rd);this.jb=[];this.V=t;this.Sd=this.Zc=this.Rd=u;this.a=this.Ub=this.Ga=t;this.X={PROGRESSBAR_ENABLED:r,INTERMEDIATE_RENDERING:u,SLICENAVIGATORS:r};this.ye=-1;window.console.log("XTK release 10 -- 2014-03-02 21:54:40 -- http://www.goXTK.com -- @goXTK")}D(Ug,L);x=Ug.prototype;
x.tf=function(){window.cancelAnimationFrame(this.ye);this.X.PROGRESSBAR_ENABLED&&(this.Ub=new Rg(this.w,3))};x.uf=function(){this.X.PROGRESSBAR_ENABLED&&this.Ub&&(Sg(this.Ub),this.Jd=Tg(function(){this.Jd=t;this.Ub&&(this.Ub.zd(),this.Ub=t);this.Zc=this.Sd=r;this.ac()}.bind(this),700))};x.vf=function(a){this.Ub&&this.Ub.Gd(100*a.Te)};x.ej=function(a){this.Ga&&this.Ga.Gd(100*a.Te)};x.Vi=function(a){a!=t&&a instanceof pd&&a.O&&this.vb(a.O)};x.fj=function(a){a!=t&&a instanceof qd&&a.O&&this.remove(a.O)};
x.xf=function(a){(a==t||!(a instanceof Pd))&&m(Error("Invalid hover event."))};x.yf=function(){var a=le(this.w);this.A=a.clientWidth;this.u=a.clientHeight;a=le(this.Aa);a.width=this.A;a.height=this.u;"renderer3D"==this.f&&(this.a.viewport(0,0,this.A,this.u),this.K.Ne=E.g.nf(E.g.yd(),this.K.Wf,this.Aa.width/this.Aa.height,1,1E4))};x.zf=function(a){(a==t||!(a instanceof Od))&&m(Error("Invalid scroll event."))};Ug.prototype.__defineGetter__("config",v("X"));
Ug.prototype.__defineGetter__("interactor",v("S"));Ug.prototype.__defineGetter__("camera",v("K"));Ug.prototype.__defineGetter__("loadingCompleted",v("Zc"));Ug.prototype.__defineGetter__("container",v("w"));Ug.prototype.__defineSetter__("container",function(a){a==t&&m(Error("An ID to a valid container (<div>..) is required."));var b=a;la(b)&&(b=le(a));oa(b)&&1==b.nodeType||m(Error("Could not find the given container."));this.w=b});x=Ug.prototype;x.Fd=function(){this.K.reset()};
x.wa=function(a){var b=ne("canvas");this.w.appendChild(b);this.A=this.w.clientWidth;this.u=this.w.clientHeight;b.width=this.A;b.height=this.u;try{var c=b.getContext(a);c||m(Error())}catch(d){var e="Sorry, "+a+' context is <strong>not supported</strong> on this machine! See <a href="http://crash.goXTK.com" target="_blank">http://crash.goXTK.com</a> for requirements..';this.w.innerHTML='<h3 style="color:red;font-family:sans-serif;">Oooops..</h3><p style="color:red;font-family:sans-serif;">'+e+"</p>";
m(Error(e))}this.V=new cg;K(this.V,Ed,this.ej.bind(this));this.Aa=b;this.a=c;b=new Ve(this.Aa);"2d"==a&&(b=new Xe(this.Aa));b.wa();K(b,Ad,this.Fd.bind(this));K(b,Fd,this.xf.bind(this));K(b,zd,this.zf.bind(this));this.S=b;b=new rg(this.A,this.u);"2d"==a&&(b=new qg(this.A,this.u));b.observe(this.S);this.K=b;K(window,"resize",this.yf,u,this)};x.add=function(a){(a instanceof mg||a instanceof kg||a instanceof ig)&&a.p();this.jb.push(a);this.vb(a)};
x.remove=function(a){(!this.Aa||!this.a)&&m(Error("The renderer was not initialized properly."));if(a!=t){var b=0;if(a!=t){if(a=pa(a),Wb[a]){a=Wb[a];for(var c=a.length-1;0<=c;c--)ec(a[c].key),b++}}else Na(Ub,function(a,c){ec(c);b++})}return u};
x.vb=function(a){(!this.Aa||!this.a)&&m(Error("The renderer was not initialized properly."));a!=t&&(gc(a,Cd)||K(a,Cd,this.Vi.bind(this)),gc(a,Dd)||K(a,Dd,this.fj.bind(this)),gc(a,Hd)||K(a,Hd,this.tf.bind(this)),gc(a,Jd)||K(a,Jd,this.vf.bind(this)),gc(a,Id)||K(a,Id,this.uf.bind(this)))};x.get=function(a){a==t&&m(Error("Invalid object id."));for(var b=this.rb.H,c=b.length,d=0,d=0;d<c;d++)if(b[d].ta==a)return b[d];return t};
x.ac=function(){(!this.Aa||!this.a)&&m(Error("The renderer was not initialized properly."));if(this.jg==t){if(Ec(this.V.Bc)){if(this.X.PROGRESSBAR_ENABLED&&!this.Ga&&(this.Ga=new Rg(this.w,3)),this.Sd=this.Zc=u,this.jg=Tg(function(){this.jg=t;this.ac()}.bind(this),100),!this.X.INTERMEDIATE_RENDERING)return}else if(!this.Zc&&!this.Sd&&(this.Sd=r,eval("this.onShowtime()"),this.Zc=r),this.Ga){this.X.PROGRESSBAR_ENABLED&&(this.Ga&&!this.Jd)&&(Sg(this.Ga),this.Jd=Tg(function(){this.Jd=t;this.Ga&&(this.Ga.zd(),
this.Ga=t);this.ac()}.bind(this),700));return}this.ye=window.requestAnimationFrame(this.ac.bind(this));eval("this.onRender()");this.bc(u,r)}};x.Wg=aa();x.Ug=aa();x.bc=aa();x.ae=function(){window.cancelAnimationFrame(this.ye);this.V&&(delete this.V,this.V=t);this.Ga&&(this.Ga.zd(),delete this.Ga,this.Ga=t);this.rb.clear();delete this.rb;this.jb.length=0;delete this.jb;delete this.V;this.V=t;delete this.K;this.K=t;delete this.S;this.S=t;delete this.a;this.a=t;qe(this.Aa);delete this.Aa;this.Aa=t};function Vg(){L.call(this);this.f="shaders";this.Vd="";var a;a="precision mediump float;\n\n";a+="attribute vec3 vertexPosition;\n";a+="attribute vec3 vertexNormal;\n";a+="attribute vec3 vertexColor;\n";a+="attribute vec2 vertexTexturePos;\n";a+="attribute float vertexScalar;\n";a+="\n";a+="uniform mat4 view;\n";a+="uniform mat4 perspective;\n";a+="uniform vec3 center;\n";a+="uniform mat4 objectTransform;\n";a+="uniform bool useObjectColor;\n";a+="uniform bool useScalars;\n";a+="uniform bool scalarsReplaceMode;\n";
a+="uniform float scalarsMin;\n";a+="uniform float scalarsMax;\n";a+="uniform vec3 scalarsMinColor;\n";a+="uniform vec3 scalarsMaxColor;\n";a+="uniform float scalarsMinThreshold;\n";a+="uniform float scalarsMaxThreshold;\n";a+="uniform int scalarsInterpolation;\n";a+="uniform vec3 objectColor;\n";a+="uniform float pointSize;\n";a+="\n";a+="varying float fDiscardNow;\n";a+="varying vec4 fVertexPosition;\n";a+="varying vec3 fragmentColor;\n";a+="varying vec2 fragmentTexturePos;\n";a+="varying vec3 fVertexNormal;\n";
a+="varying vec3 fTransformedVertexNormal;\n";a+="\n";a+="void main(void) {\n";a+="  fTransformedVertexNormal = mat3(view[0].xyz,view[1].xyz,view[2].xyz) * ";a+="mat3(objectTransform[0].xyz,objectTransform[1].xyz,objectTransform[2].xyz) * ";a+="vertexNormal;\n";a+="  fVertexNormal = vertexNormal;\n";a+="  fDiscardNow = 0.0;\n";a+="  vec3 vertexPosition2 = vertexPosition - center;\n";a+="  fVertexPosition = view * objectTransform * vec4(vertexPosition2, 1.0);\n";a+="  fragmentTexturePos = vertexTexturePos;\n";
a+="  if (useScalars) {\n";a+="    float scalarValue = vertexScalar;\n";a+="    if (scalarValue < scalarsMinThreshold || scalarValue > scalarsMaxThreshold) {\n";a+="      if (scalarsReplaceMode) {\n";a+="        fragmentColor = objectColor;\n";a+="      } else {\n";a+="        fDiscardNow = 1.0;\n";a+="      }\n";a+="    } else {\n";a+="      if (scalarsReplaceMode) {\n";a+="        if (scalarsInterpolation == 1) {\n";a+="            vec3 zeroMaxColor;\n";a+="            vec3 zeroMinColor;\n";a+=
"            zeroMaxColor[0] = scalarsMaxColor[0]*0.33;\n";a+="            zeroMaxColor[1] = scalarsMaxColor[1]*0.33;\n";a+="            zeroMaxColor[2] = scalarsMaxColor[2]*0.33;\n";a+="            zeroMinColor[0] = scalarsMinColor[0]*0.33;\n";a+="            zeroMinColor[1] = scalarsMinColor[1]*0.33;\n";a+="            zeroMinColor[2] = scalarsMinColor[2]*0.33;\n";a+="            if(scalarValue < 0.0) {fragmentColor = scalarValue/(scalarsMin) * scalarsMinColor + (1.0 - scalarValue/(scalarsMin)) * (zeroMinColor);}\n";
a+="            else {fragmentColor = scalarValue/(scalarsMax) * scalarsMaxColor + (1.0 - scalarValue/(scalarsMax)) * (zeroMaxColor);}\n";a+="        } else {\n";a+="            fragmentColor = scalarValue * scalarsMaxColor + (1.0 - scalarValue) * scalarsMinColor;\n";a+="          }\n";a+="      } else {\n";a+="        fragmentColor = vertexColor;\n";a+="      }\n";a+="    }\n";a+="  } else if (useObjectColor) {\n";a+="    fragmentColor = objectColor;\n";a+="  } else {\n";a+="    fragmentColor = vertexColor;\n";
a+="  }\n";a+="  gl_PointSize = pointSize;\n";a+="  gl_Position = perspective * fVertexPosition;\n";this.Vd=a+="}\n";this.Md="";a="precision mediump float;precision mediump int;\n\n";a+="uniform bool usePicking;\n";a+="uniform bool useTexture;\n";a+="uniform bool volumeTexture;\n";a+="uniform bool useLabelMapTexture;\n";a+="uniform sampler2D textureSampler;\n";a+="uniform sampler2D textureSampler2;\n";a+="uniform float objectOpacity;\n";a+="uniform float labelmapOpacity;\n";a+="uniform vec4 labelmapColor;\n";
a+="uniform float volumeLowerThreshold;\n";a+="uniform float volumeUpperThreshold;\n";a+="uniform float volumeScalarMin;\n";a+="uniform float volumeScalarMax;\n";a+="uniform vec3 volumeScalarMinColor;\n";a+="uniform vec3 volumeScalarMaxColor;\n";a+="uniform float volumeWindowLow;\n";a+="uniform float volumeWindowHigh;\n";a+="\n";a+="uniform bool uUse32bit;\n";a+="uniform sampler2D uColorMapSampler;\n";a+="uniform sampler2D uMergeTableKeySampler;\n";a+="uniform sampler2D uMergeTableValueSampler;\n";
a+="uniform sampler2D uThreeDLabels;\n";a+="uniform int uMergeTableLength;\n";a+="uniform float uMaxColors;\n";a+="uniform int uThreeDLabelsLength;\n";a+="uniform bool uUseThreeDLabels;\n";a+="\n";a+="const int MAX = 10000;\n";a+="\n";a+="varying float fDiscardNow;\n";a+="varying vec4 fVertexPosition;\n";a+="varying vec3 fragmentColor;\n";a+="varying vec2 fragmentTexturePos;\n";a+="varying vec3 fVertexNormal;\n";a+="varying vec3 fTransformedVertexNormal;\n";a+="\n";a+="    //\n";a+="    // 32 BIT <-> 8 BIT CONVERSIONS\n";
a+="    //\n";a+="    // convert rgba to a 32 bit value\n";a+="    float unpack (vec4 value) {\n";a+="      // note: little endian\n";a+="      const vec4 bitShifts = vec4( (256.0 * 256.0 * 256.0),\n";a+="                                   (256.0 * 256.0),\n";a+="                                   256.0,\n";a+="                           1);\n";a+="      return dot(value.abgr , bitShifts);\n";a+="    }\n";a+="\n";a+="    // convert 32 bit int to rgba\n";a+="    ivec4 pack (int value) {\n";a+="\n";
a+="      ivec4 o = ivec4(0., 0., 0., 0.);\n";a+="\n";a+="      o.w = (value / (256*256*256));\n";a+="      o.z = ((value-o.w) / (256*256));\n";a+="      o.y = ((value-o.w-o.z) / (256));\n";a+="      o.x = (value-o.y*256-o.z*256*256-o.w*256*256*256);\n";a+="\n";a+="      return o;\n";a+="\n";a+="    }\n";a+="\n";a+="    //\n";a+="    // FLOAT COMPARE FUNCTIONS WITH DELTA\n";a+="    //\n";a+="    bool equals(float id1, float id2) {\n";a+="      return (abs(id1-id2) <= 0.1);\n";a+="    }\n";a+="\n";
a+="    bool larger(float id1, float id2) {\n";a+="\n";a+="      if (equals(id1, id2)) return false;\n";a+="\n";a+="      return id1 > id2;\n";a+="    }\n";a+="\n";a+="    //\n";a+="    // ID LOOKUPS\n";a+="    //\n";a+="    float lookup_id_(float id) {\n";a+="\n";a+="      for (int m=0; m<MAX; m++) {\n";a+="\n";a+="        if (m>uMergeTableLength) break;\n";a+="\n";a+="        vec4 m_key = texture2D(uMergeTableKeySampler, vec2(float(m)/float(uMergeTableLength), 0.));\n";a+="        float m_id = unpack(m_key)*255.;\n";
a+="\n";a+="        // if m_id is larger than our id, then we are done since all entries are sorted\n";a+="        if (larger(m_id, id)) break;\n";a+="\n";a+="        if (equals(id, m_id)) {\n";a+="          // found entry\n";a+="          vec4 m_value = texture2D(uMergeTableValueSampler, vec2(float(m)/float(uMergeTableLength), 0.));\n";a+="          id = unpack(m_value)*255.;\n";a+="\n";a+="          return id;\n";a+="        }\n";a+="\n";a+="      }\n";a+="\n";a+="      return id;\n";a+="\n";a+=
"    }\n";a+="\n";a+="    float lookup_id(float id) {\n";a+="\n";a+="      float new_id = id;\n";a+="\n";a+="      //\n";a+="      // MERGE\n";a+="      //\n";a+="      for (int m=0; m < MAX; m++) {\n";a+="\n";a+="        new_id = lookup_id_(id);\n";a+="\n";a+="        if (equals(new_id, id)) {\n";a+="          break;\n";a+="        } else {\n";a+="          id = new_id;\n";a+="        }\n";a+="\n";a+="      }\n";a+="\n";a+="      return id;\n";a+="\n";a+="    }\n";a+="\n";a+="bool is_3d_label(float id) {\n";
a+="\n";a+="  for(int m=0; m<MAX; m++) {\n";a+="\n";a+="    if (m>uThreeDLabelsLength) break;\n";a+="\n";a+="    vec4 m_key = texture2D(uThreeDLabels, vec2(float(m)/float(uThreeDLabelsLength), 0.));\n";a+="    float m_id = unpack(m_key)*255.;\n";a+="\n";a+="    if (larger(m_id, id)) break;\n";a+="\n";a+="    if (equals(id, m_id)) {\n";a+="      return true;\n";a+="    }\n";a+="\n";a+="  }\n";a+="\n";a+="  return false;\n";a+="\n";a+="}\n";a+="\n";a+="void main(void) {\n";a+=" if (fDiscardNow > 0.0) {\n";
a+="   discard;\n";a+=" }\n";a+=" if (usePicking) {\n";a+="   gl_FragColor = vec4(fragmentColor, 1.0);\n";a+=" } else if (useTexture) {\n";a+="   vec4 texture1 = texture2D(textureSampler,fragmentTexturePos);\n";a+="   vec4 textureSum = texture1;\n";a+="   if (volumeTexture) {\n";a+="     float _windowLow = (volumeWindowLow / volumeScalarMax);\n";a+="     float _windowHigh = (volumeWindowHigh / volumeScalarMax);\n";a+="     vec3 _minrange = vec3(_windowLow,_windowLow,_windowLow);\n";a+="     vec3 _maxrange = vec3(_windowHigh,_windowHigh,_windowHigh);\n";
a+="     vec3 fac = _maxrange - _minrange;\n";a+="     textureSum = vec4((textureSum.r - _minrange)/fac,1);\n";a+="     textureSum = textureSum.r * vec4(volumeScalarMaxColor,1) + (1.0 - textureSum.r) * vec4(volumeScalarMinColor,1);\n";a+="   }\n";a+="   if (useLabelMapTexture) {\n";a+="     vec4 texture2 = texture2D(textureSampler2,fragmentTexturePos);\n";a+="     if (uUse32bit) {\n";a+="       float id = lookup_id(unpack(texture2)*255.);\n";a+="       float normalized_id = mod(id, uMaxColors);\n";
a+="       vec2 colormap_pos = vec2(normalized_id / (uMaxColors - 1.), 0.);\n";a+="       vec4 color = texture2D(uColorMapSampler, colormap_pos);\n";a+="       textureSum = mix(color, textureSum, 1.0 - labelmapOpacity);\n";a+="       if (uUseThreeDLabels && !is_3d_label(id)) {\n";a+="         discard;\n";a+="       }\n";a+="     } else if (texture2.a > 0.0) {\n";a+="         if (labelmapColor.a != -255.0) {\n";a+="           if (all(equal(floor(texture2 * vec4(255)), labelmapColor))) {\n";a+="             if (labelmapOpacity < 1.0) {\n";
a+="               textureSum = mix(texture2, textureSum, 1.0 - labelmapOpacity);\n";a+="             } else {\n";a+="               textureSum = texture2;\n";a+="             }\n";a+="           }\n";a+="         } else {\n";a+="           if (labelmapOpacity < 1.0) {\n";a+="             textureSum = mix(texture2, textureSum, 1.0 - labelmapOpacity);\n";a+="           } else {\n";a+="             textureSum = texture2;\n";a+="           }\n";a+="         }\n";a+="     }\n";a+="   }\n";a+="   if (volumeTexture) {\n";
a+="     float _volumeLowerThreshold = (volumeLowerThreshold / volumeScalarMax);\n";a+="     float _volumeUpperThreshold = (volumeUpperThreshold / volumeScalarMax);\n";a+="   };\n";a+="   gl_FragColor = textureSum;\n";a+="   gl_FragColor.a = objectOpacity;\n";a+=" } else {\n";a+="   vec3 nNormal = normalize(fTransformedVertexNormal);\n";a+="   if (fVertexNormal == vec3(0.0,0.0,0.0)) {\n";a+="     gl_FragColor = vec4(fragmentColor,1.0);\n";a+="     return;\n";a+="   }\n";a+="   vec3 light = vec3(0.0, 0.0, 1.0);\n";
a+="   vec3 lightDirection = vec3(0,0,-10);\n";a+="   lightDirection = normalize(lightDirection);\n";a+="   vec3 eyeDirection = normalize(-fVertexPosition.xyz);\n";a+="   vec3 reflectionDirection = reflect(-lightDirection, nNormal);\n";a+="   float specular = pow(max(dot(reflectionDirection, eyeDirection), 0.0), 10.0);\n";a+="   float diffuse = 0.8 * max(dot(nNormal, light), 0.0);\n";a+="   float ambient = 0.3;\n";a+="   gl_FragColor = vec4(fragmentColor * ambient +\n";a+="                       fragmentColor * diffuse +\n";
a+="                       vec3(0.2, 0.2, 0.2) * specular,\n";a+="                       objectOpacity);\n";a+=" }\n";this.Md=a+="}\n"}D(Vg,L);
var Wg={Gk:"vertexPosition",Fk:"vertexNormal",Ek:"vertexColor",Ik:"vertexTexturePos",Hk:"vertexScalar"},Xg={Jk:"view",jk:"perspective",Wj:"center",ik:"objectTransform",zk:"useObjectColor",gk:"objectColor",Bk:"useScalars",sk:"scalarsReplaceMode",pk:"scalarsMin",mk:"scalarsMax",qk:"scalarsMinColor",nk:"scalarsMaxColor",rk:"scalarsMinThreshold",ok:"scalarsMaxThreshold",lk:"scalarsInterpolation",kk:"pointSize",hk:"objectOpacity",fk:"normal",Ak:"usePicking",Ck:"useTexture",yk:"useLabelMapTexture",$j:"labelmapOpacity",
Zj:"labelmapColor",tk:"textureSampler",uk:"textureSampler2",Kk:"volumeLowerThreshold",Qk:"volumeUpperThreshold",Nk:"volumeScalarMin",Lk:"volumeScalarMax",Ok:"volumeScalarMinColor",Mk:"volumeScalarMaxColor",Sk:"volumeWindowLow",Rk:"volumeWindowHigh",Pk:"volumeTexture",Xj:"uColorMapSampler",bk:"uMergeTableKeySampler",dk:"uMergeTableValueSampler",ck:"uMergeTableLength",xk:"uUse32bit",ak:"uMaxColors",Dk:"uUseThreeDLabels",vk:"uThreeDLabels",wk:"uThreeDLabelsLength"};function Yg(a,b,c){a==t&&m(Error("Invalid GL Buffer."));b==t&&m(Error("Invalid number of items."));c==t&&m(Error("Invalid item size."));L.call(this);this.f="buffer";this.M=a;this.Mb=b;this.Nb=c}D(Yg,L);function Zg(a,b,c,d,e,f,g,h){var j,k;if(j=c.offsetParent){var l="HTML"==j.tagName||"BODY"==j.tagName;if(!l||"static"!=ze(j,"position"))k=Ee(j),l||(l=(l=Fe(j))&&mb?-j.scrollLeft:l&&(!lb||!Bb("8"))&&"visible"!=ze(j,"overflowX")?j.scrollWidth-j.clientWidth-j.scrollLeft:j.scrollLeft,k=ge(k,new fe(l,j.scrollTop)))}j=k||new fe;k=Ee(a);l=Je(a);k=new we(k.x,k.y,l.width,l.height);(l=De(a))&&k.Ig(new we(l.left,l.top,l.right-l.left,l.bottom-l.top));var l=he(a),n=he(c);if(l.ha!=n.ha){var q=l.ha.body,n=n.ha.parentWindow||
n.ha.defaultView,s=new fe(0,0),A=ke(q)?ke(q).parentWindow||ke(q).defaultView:window,z=q;do{var G=A==n?Ee(z):Ge(z);s.x+=G.x;s.y+=G.y}while(A&&A!=n&&(z=A.frameElement)&&(A=A.parent));q=ge(s,Ee(q));lb&&!te(l)&&(q=ge(q,ue(l)));k.left+=q.x;k.top+=q.y}a=(b&4&&Fe(a)?b^2:b)&-5;b=new fe(a&2?k.left+k.width:k.left,a&1?k.top+k.height:k.top);b=ge(b,j);e&&(b.x+=(a&2?-1:1)*e.x,b.y+=(a&1?-1:1)*e.y);var B;if(g&&(B=De(c)))B.top-=j.y,B.right-=j.x,B.bottom-=j.y,B.left-=j.x;return $g(b,c,d,f,B,g,h)}
function $g(a,b,c,d,e,f,g){a=a.l();var h=0,j=(c&4&&Fe(b)?c^2:c)&-5;c=Je(b);g=g?g.l():c.l();if(d||0!=j)j&2?a.x-=g.width+(d?d.right:0):d&&(a.x+=d.left),j&1?a.y-=g.height+(d?d.bottom:0):d&&(a.y+=d.top);if(f){if(e){h=a;d=0;if(65==(f&65)&&(h.x<e.left||h.x>=e.right))f&=-2;if(132==(f&132)&&(h.y<e.top||h.y>=e.bottom))f&=-5;h.x<e.left&&f&1&&(h.x=e.left,d|=1);h.x<e.left&&(h.x+g.width>e.right&&f&16)&&(g.width=Math.max(g.width-(h.x+g.width-e.right),0),d|=4);h.x+g.width>e.right&&f&1&&(h.x=Math.max(e.right-g.width,
e.left),d|=1);f&2&&(d|=(h.x<e.left?16:0)|(h.x+g.width>e.right?32:0));h.y<e.top&&f&4&&(h.y=e.top,d|=2);h.y<=e.top&&(h.y+g.height<e.bottom&&f&32)&&(g.height=Math.max(g.height-(e.top-h.y),0),h.y=0,d|=8);h.y>=e.top&&(h.y+g.height>e.bottom&&f&32)&&(g.height=Math.max(g.height-(h.y+g.height-e.bottom),0),d|=8);h.y+g.height>e.bottom&&f&4&&(h.y=Math.max(e.bottom-g.height,e.top),d|=2);f&8&&(d|=(h.y<e.top?64:0)|(h.y+g.height>e.bottom?128:0));h=d}else h=256;if(h&496)return h}f=a;e=mb&&(cb||sb)&&Bb("1.9");f instanceof
fe?(a=f.x,f=f.y):(a=f,f=p);b.style.left=Ie(a,e);b.style.top=Ie(f,e);if(!(c==g||(!c||!g?0:c.width==g.width&&c.height==g.height)))a=te(he(ke(b))),lb&&(!a||!Bb("8"))?(c=b.style,a?(lb?(a=Ne(b,"paddingLeft"),e=Ne(b,"paddingRight"),f=Ne(b,"paddingTop"),d=Ne(b,"paddingBottom"),a=new ve(f,e,d,a)):(a=ye(b,"paddingLeft"),e=ye(b,"paddingRight"),f=ye(b,"paddingTop"),d=ye(b,"paddingBottom"),a=new ve(parseFloat(f),parseFloat(e),parseFloat(d),parseFloat(a))),lb?(e=Pe(b,"borderLeft"),f=Pe(b,"borderRight"),d=Pe(b,
"borderTop"),b=Pe(b,"borderBottom"),b=new ve(d,f,b,e)):(e=ye(b,"borderLeftWidth"),f=ye(b,"borderRightWidth"),d=ye(b,"borderTopWidth"),b=ye(b,"borderBottomWidth"),b=new ve(parseFloat(d),parseFloat(f),parseFloat(b),parseFloat(e))),c.pixelWidth=g.width-b.left-a.left-a.right-b.right,c.pixelHeight=g.height-b.top-a.top-a.bottom-b.bottom):(c.pixelWidth=g.width,c.pixelHeight=g.height)):(b=b.style,mb?b.MozBoxSizing="border-box":nb?b.WebkitBoxSizing="border-box":b.boxSizing="border-box",b.width=Math.max(g.width,
0)+"px",b.height=Math.max(g.height,0)+"px");return h};function ah(){}ah.prototype.ob=aa();function bh(a,b){this.cf=a instanceof fe?a:new fe(a,b)}D(bh,ah);bh.prototype.ob=function(a,b,c,d){Zg(Ae(a),0,a,b,this.cf,c,t,d)};function ch(a,b,c){this.element=a;this.ug=b;this.uj=c}D(ch,ah);ch.prototype.ob=function(a,b,c){Zg(this.element,this.ug,a,b,p,c,this.uj)};function dh(a,b){lc.call(this);this.Eb=new tg(this);this.Ff(a||t);b&&(this.Rc=b)}D(dh,lc);x=dh.prototype;x.G=t;x.Xh=r;x.og=t;x.Ha=u;x.Fj=u;x.lf=-1;x.Lg=-1;x.Bi=u;x.ki=r;x.Rc="toggle_display";x.t=v("G");x.Ff=function(a){this.Ha&&m(Error("Can not change this state of the popup while showing."));this.G=a};
function eh(a,b){a.we&&a.we.stop();a.ke&&a.ke.stop();if(b){if(!a.Ha&&a.sf()){a.G||m(Error("Caller must call setElement before trying to show the popup"));a.ob();var c=ke(a.G);a.Bi&&vg(a.Eb,c,"keydown",a.Ti,r);if(a.Xh)if(vg(a.Eb,c,"mousedown",a.Tg,r),lb){var d;try{d=c.activeElement}catch(e){}for(;d&&"IFRAME"==d.nodeName;){try{var f=d.contentDocument||d.contentWindow.document}catch(g){break}c=f;d=c.activeElement}vg(a.Eb,c,"mousedown",a.Tg,r);vg(a.Eb,c,"deactivate",a.Sg)}else vg(a.Eb,c,"blur",a.Sg);
"toggle_display"==a.Rc?(a.G.style.visibility="visible",Le(a.G,r)):"move_offscreen"==a.Rc&&a.ob();a.Ha=r;a.we?($b(a.we,"end",a.Vg,u,a),a.we.play()):a.Vg()}}else fh(a)}x.ob=ga;function fh(a,b){if(!a.Ha||!a.dispatchEvent({type:"beforehide",target:b}))return u;a.Eb&&a.Eb.Ef();a.Ha=u;a.Lg=xa();a.ke?($b(a.ke,"end",wa(a.tg,b),u,a),a.ke.play()):a.tg(b);return r}x.tg=function(a){"toggle_display"==this.Rc?this.Fj?Tg(this.Dg,0,this):this.Dg():"move_offscreen"==this.Rc&&(this.G.style.top="-10000px");this.wf(a)};
x.Dg=function(){this.G.style.visibility="hidden";Le(this.G,u)};x.sf=function(){return this.dispatchEvent("beforeshow")};x.Vg=function(){this.lf=xa();this.Lg=-1;this.dispatchEvent("show")};x.wf=function(a){this.dispatchEvent({type:"hide",target:a})};x.Tg=function(a){a=a.target;!se(this.G,a)&&((!this.og||se(this.og,a))&&!(150>xa()-this.lf))&&fh(this,a)};x.Ti=function(a){27==a.keyCode&&fh(this,a.target)&&(a.preventDefault(),a.stopPropagation())};
x.Sg=function(a){if(this.ki){var b=ke(this.G);if(lb||kb){if(a=b.activeElement,!a||se(this.G,a)||"BODY"==a.tagName)return}else if(a.target!=b)return;150>xa()-this.lf||fh(this)}};function gh(a,b){this.yj=4;this.oe=b||p;dh.call(this,a)}D(gh,dh);gh.prototype.ob=function(){if(this.oe){var a=!this.Ha&&"move_offscreen"!=this.Rc,b=this.t();a&&(b.style.visibility="hidden",Le(b,r));this.oe.ob(b,this.yj,this.nl);a&&Le(b,u)}};function hh(a){this.ca=new Bc;a&&this.Ve(a)}function ih(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+pa(a):b.substr(0,1)+a}x=hh.prototype;x.fe=function(){return this.ca.fe()};x.add=function(a){this.ca.set(ih(a),a)};x.Ve=function(a){a=Ac(a);for(var b=a.length,c=0;c<b;c++)this.add(a[c])};x.Ef=function(a){a=Ac(a);for(var b=a.length,c=0;c<b;c++)this.remove(a[c])};x.remove=function(a){return this.ca.remove(ih(a))};x.clear=function(){this.ca.clear()};
x.contains=function(a){a=ih(a);return Fc(this.ca.ca,a)};x.Ig=function(a){var b=new hh;a=Ac(a);for(var c=0;c<a.length;c++){var d=a[c];this.contains(d)&&b.add(d)}return b};x.xd=function(){return this.ca.xd()};x.l=function(){return new hh(this)};function jh(a,b,c){this.Yb=c||(a?he(le(a)):he());gh.call(this,this.Yb.Nc("div",{style:"position:absolute;display:none;"}));this.df=new fe(1,1);this.be=new hh;a&&kh(this,a);if(b!=t)if(a=this.t(),"textContent"in a)a.textContent=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(;c=a.firstChild;)a.removeChild(c);a.appendChild(ke(a).createTextNode(String(b)))}}D(jh,gh);var lh=[];x=jh.prototype;x.Oa=t;x.className="goog-tooltip";
x.jh=500;x.Ai=0;x.ge=v("Yb");function kh(a,b){b=le(b);a.be.add(b);K(b,"mouseover",a.zi,u,a);K(b,"mouseout",a.Ag,u,a);K(b,"mousemove",a.yi,u,a);K(b,"focus",a.xi,u,a);K(b,"blur",a.Ag,u,a)}x.Ff=function(a){var b=this.t();b&&qe(b);jh.B.Ff.call(this,a);a&&(b=this.Yb.ha.body,b.insertBefore(a,b.lastChild))};
x.sf=function(){if(!dh.prototype.sf.call(this))return u;if(this.anchor)for(var a,b=0;a=lh[b];b++)se(a.t(),this.anchor)||eh(a,u);0<=Ib(lh,this)||lh.push(this);a=this.t();a.className=this.className;mh(this);K(a,"mouseover",this.Cg,u,this);K(a,"mouseout",this.Bg,u,this);nh(this);return r};
x.wf=function(){Nb(lh,this);for(var a=this.t(),b,c=0;b=lh[c];c++)b.anchor&&se(a,b.anchor)&&eh(b,u);this.Yg&&oh(this.Yg);ac(a,"mouseover",this.Cg,u,this);ac(a,"mouseout",this.Bg,u,this);this.anchor=p;if(0==(this.Hb?this.Ha?4:1:this.Pc?3:this.Ha?2:0))this.te=u;dh.prototype.wf.call(this)};x.Pg=function(a,b){this.anchor==a&&this.be.contains(this.anchor)&&(this.te||!this.rl?(eh(this,u),this.Ha||(this.anchor=a,this.oe=b||ph(this,0)||p,this.Ha&&this.ob(),eh(this,r))):this.anchor=p);this.Hb=p};
x.Pi=function(a){this.Pc=p;a==this.anchor&&(this.Oa==t||this.Oa!=this.t()&&!this.be.contains(this.Oa))&&(!this.qg||!this.qg.Oa)&&eh(this,u)};function qh(a,b){var c=ue(a.Yb);a.df.x=b.clientX+c.x;a.df.y=b.clientY+c.y}x.zi=function(a){var b=rh(this,a.target);this.Oa=b;mh(this);b!=this.anchor&&(this.anchor=b,this.Hb||(this.Hb=Tg(va(this.Pg,this,b,p),this.jh)),sh(this),qh(this,a))};function rh(a,b){try{for(;b&&!a.be.contains(b);)b=b.parentNode;return b}catch(c){return t}}
x.yi=function(a){qh(this,a);this.te=r};x.xi=function(a){this.Oa=a=rh(this,a.target);this.te=r;if(this.anchor!=a){this.anchor=a;var b=ph(this,1);mh(this);this.Hb||(this.Hb=Tg(va(this.Pg,this,a,b),this.jh));sh(this)}};function ph(a,b){if(0==b){var c=a.df.l();return new uh(c)}return new vh(a.Oa)}function sh(a){if(a.anchor)for(var b,c=0;b=lh[c];c++)se(b.t(),a.anchor)&&(b.qg=a,a.Yg=b)}
x.Ag=function(a){var b=rh(this,a.target),c=rh(this,a.relatedTarget);b!=c&&(b==this.Oa&&(this.Oa=t),nh(this),this.te=u,this.Ha&&(!a.relatedTarget||!se(this.t(),a.relatedTarget))?oh(this):this.anchor=p)};x.Cg=function(){var a=this.t();this.Oa!=a&&(mh(this),this.Oa=a)};x.Bg=function(a){var b=this.t();if(this.Oa==b&&(!a.relatedTarget||!se(b,a.relatedTarget)))this.Oa=t,oh(this)};function nh(a){a.Hb&&(ca.clearTimeout(a.Hb),a.Hb=p)}
function oh(a){if(2==(a.Hb?a.Ha?4:1:a.Pc?3:a.Ha?2:0))a.Pc=Tg(va(a.Pi,a,a.anchor),a.Ai)}function mh(a){a.Pc&&(ca.clearTimeout(a.Pc),a.Pc=p)}function uh(a,b){bh.call(this,a,b)}D(uh,bh);uh.prototype.ob=function(a,b,c){b=Ae(a);b=De(b);c=c?new ve(c.top+10,c.right,c.bottom,c.left+10):new ve(10,0,0,10);$g(this.cf,a,4,c,b,9)&496&&$g(this.cf,a,4,c,b,5)};function vh(a){ch.call(this,a,3)}D(vh,ch);
vh.prototype.ob=function(a,b,c){var d=new fe(10,0);Zg(this.element,this.ug,a,b,d,c,9)&496&&Zg(this.element,2,a,1,d,c,5)};function wh(a,b,c,d){a==t&&m(Error("No valid parent element."));(!y(b)||!y(c))&&m(Error("Invalid coordinates."));(d==t||!(d instanceof Te))&&m(Error("Invalid interactor."));jh.call(this);this.f="caption";this.Xa=a;this.Yd=b;this.Zd=c;this.S=d;this.Db=t;this.cc=[];a=".x-tooltip {\n  background: #C0C0FF;\n  color: #000000;\n";a+="  border: 1px solid infotext;\n";a+="  padding: 1px;\n";a+="  font-family: sans-serif;\n";a+="}";this.cc=[a];$b(d,Gd,this.zd.bind(this));this.jf()}D(wh,jh);
wh.prototype.jf=function(){var a=ye(this.Xa,"position");if("static"==a||""==a)this.Xa.style.position="relative";var a=document.getElementsByTagName("head")[0],b=ne("style");b.type="text/css";b.media="screen";var c=document.createTextNode(String(this.cc[0]));a.appendChild(b);b.appendChild(c);this.Db=b;this.oe=new bh(this.Yd,this.Zd)||p;this.Ha&&this.ob();eh(this,r);kh(this,this.Xa);this.t().classList.add("x-tooltip")};
wh.prototype.zd=function(){eh(this,u);this.Db&&qe(this.Db);this.t()&&qe(this.t());this.Db=t};function xh(){Ug.call(this);this.f="renderer3D";this.cd=this.fd=this.bd=this.ed=this.ad=this.dd=this.Oe=this.Pe=t;this.v=[0,0,0];this.Vc=[0,0,0];this.hg=t;this.Ae=new Bc;this.sd=new Bc;this.jc=new Bc;this.gd=new Bc;this.uc=new Bc;this.Gc=new Bc;this.ic=new Bc;this.Lc=new Bc;this.X={PROGRESSBAR_ENABLED:r,PICKING_ENABLED:r,ORDERING_ENABLED:r,STATISTICS_ENABLED:u,INTERMEDIATE_RENDERING:u}}D(xh,Ug);xh.prototype.__defineGetter__("config",v("X"));x=xh.prototype;
x.Aj=function(){this.cd=this.fd=this.bd=this.ed=this.ad=this.dd=t;this.v=[0,0,0]};x.xf=function(a){xh.B.xf.call(this,a);var b=a.Yd;a=a.Zd;var c=this.Cf(b,a);if(c=this.get(c))if(c=c.tc){var d=Ge(this.w);(new wh(this.w,d.x+b+10,d.y+a+10,this.S)).t().innerHTML=c}};
x.wa=function(){xh.B.wa.call(this,"experimental-webgl");try{if(this.a.viewport(0,0,this.A,this.u),this.a.clearColor(this.Vc[0],this.Vc[1],this.Vc[2],0),this.a.enable(this.a.BLEND),this.a.blendEquation(this.a.FUNC_ADD),this.a.blendFunc(this.a.SRC_ALPHA,this.a.ONE_MINUS_SRC_ALPHA),this.a.enable(this.a.DEPTH_TEST),this.a.depthFunc(this.a.LEQUAL),this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT),this.X.PICKING_ENABLED){var a=this.a.createFramebuffer(),b=this.a.createRenderbuffer(),c=this.a.createTexture();
this.a.bindTexture(this.a.TEXTURE_2D,c);this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGB,this.A,this.u,0,this.a.RGB,this.a.UNSIGNED_BYTE,t);this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_S,this.a.CLAMP_TO_EDGE);this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_T,this.a.CLAMP_TO_EDGE);this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.NEAREST);this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.NEAREST);this.a.bindFramebuffer(this.a.FRAMEBUFFER,
a);this.a.bindRenderbuffer(this.a.RENDERBUFFER,b);this.a.renderbufferStorage(this.a.RENDERBUFFER,this.a.DEPTH_COMPONENT16,this.A,this.u);this.a.bindRenderbuffer(this.a.RENDERBUFFER,t);this.a.framebufferTexture2D(this.a.FRAMEBUFFER,this.a.COLOR_ATTACHMENT0,this.a.TEXTURE_2D,c,0);this.a.framebufferRenderbuffer(this.a.FRAMEBUFFER,this.a.DEPTH_ATTACHMENT,this.a.RENDERBUFFER,b);this.a.bindFramebuffer(this.a.FRAMEBUFFER,t);this.hg=a}}catch(d){m(Error("Exception while accessing GL Context!\n"+d))}a=new Vg;
(this.Aa==t||this.a==t||this.K==t)&&m(Error("Renderer was not initialized properly."));(a==t||!(a instanceof Vg))&&m(Error("Could not add shaders."));b=Object.keys(Xg);Object.keys(Wg).every(function(a){a=Wg[a];return-1!=this.Vd.search(a)||-1!=this.Md.search(a)}.bind(a))||m(Error("Could not find all attributes in the shader sources."));b.every(function(a){a=Xg[a];return-1!=this.Vd.search(a)||-1!=this.Md.search(a)}.bind(a))||m(Error("Could not find all uniforms in the shader sources."));b=this.a.createShader(this.a.FRAGMENT_SHADER);
c=this.a.createShader(this.a.VERTEX_SHADER);this.a.shaderSource(b,a.Md);this.a.shaderSource(c,a.Vd);this.a.compileShader(b);this.a.compileShader(c);this.a.getShaderParameter(b,this.a.COMPILE_STATUS)||m(Error("Fragement Shader compilation failed!\n"+this.a.getShaderInfoLog(b)));this.a.getShaderParameter(c,this.a.COMPILE_STATUS)||m(Error("Vertex Shader compilation failed!\n"+this.a.getShaderInfoLog(c)));var e=this.a.createProgram();this.a.attachShader(e,c);this.a.attachShader(e,b);this.a.linkProgram(e);
this.a.getProgramParameter(e,this.a.LINK_STATUS)||m(Error("Could not create shader program!\n"+this.a.getShaderInfoLog(b)+"\n"+this.a.getShaderInfoLog(c)+"\n"+this.a.getProgramInfoLog(e)));this.a.useProgram(e);this.Oe=e;Object.keys(Wg).forEach(function(a){a=Wg[a];this.Ae.set(a,this.a.getAttribLocation(this.Oe,a));this.a.enableVertexAttribArray(this.Ae.get(a))}.bind(this));Object.keys(Xg).forEach(function(a){a=Xg[a];this.sd.set(a,this.a.getUniformLocation(this.Oe,a))}.bind(this));this.Pe=a};
x.vb=function(a){xh.B.vb.call(this,a);var b=u;if(a!=t){this.get(a.ta)&&(b=r);var c=a.ta,d=a.h,e=a.n,f=a.la,g=a.C,h=a.q,j=a.ea,k=a.Fa,l=a.e,n=a.I;if(l!=t&&l.q!=t&&l.q.j)this.vb(l);else if(l!=t&&l.j&&this.vb(l),k!=t&&k.q!=t&&k.q.j)this.V.load(k,a);else if(g!=t&&g.q!=t&&g.q.j)this.V.load(g,a);else{if(h!=t&&ja(h))if(a.qc!=t){if(a.qc.mf!=h.length||!a.j)return}else{b=0;c=h.length;for(b=0;b<c;b++)this.V.load(h[b],a);return}else{if(h!=t&&h.j){this.V.load(a,a);return}if(n!=t&&n.q!=t&&n.q.j){this.V.load(n,
a);return}}if(0<a.c.length){h=a.c;k=h.length;for(l=l=0;l<k;l++)this.vb(h[l])}if(d){for(h=0;this.Rd;)h++,window.console.log("Possible thread lock avoided: "+h);this.Rd=r;k=a instanceof Yd&&a.$a instanceof ef;b&&(g!=t&&g.j)&&(h=this.ic.get(c),h!=t&&this.a.isBuffer(h.M)&&this.a.deleteBuffer(h.M));h=t;g!=t&&(!b||g.j?(h=a.Kc,h==t&&m(Error("Can not add an object and texture without valid coordinate mapping! Set the textureCoordinateMap!")),l=u,g.ib&&(l=r),this.a.pixelStorei(this.a.UNPACK_FLIP_Y_WEBGL,l),
l=this.a.createTexture(),l.Di=g.Lb,this.Lc.set(g.ta,l),this.a.bindTexture(this.a.TEXTURE_2D,l),g.ib?(l=this.a.RGBA,g.Xc&&(l=this.a.LUMINANCE,this.a.pixelStorei(this.a.UNPACK_ALIGNMENT,1)),this.a.texImage2D(this.a.TEXTURE_2D,0,l,g.Fc,g.Ec,0,l,this.a.UNSIGNED_BYTE,g.ib)):this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,this.a.RGBA,this.a.UNSIGNED_BYTE,l.Di),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_S,this.a.CLAMP_TO_EDGE),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_T,
this.a.CLAMP_TO_EDGE),k?(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.NEAREST),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.NEAREST)):(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.LINEAR),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.LINEAR)),this.a.bindTexture(this.a.TEXTURE_2D,t),l=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,l),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(h),
this.a.STATIC_DRAW),h=new Yg(l,h.length,2),this.ic.set(c,h),g.j=u):h=this.ic.get(c));dg(this.V,0.1);if(k)this.Rd=u,E.xa(this.f+".update"),dg(this.V,0.9);else{if(!b||d.j||j.j){k=j.N;g=E.g.W(k,d.fb,d.gb,d.hb);k=E.g.W(k,d.bb,d.cb,d.eb);if(this.dd===t||g.x<this.dd)this.dd=g.x;if(this.ad===t||k.x>this.ad)this.ad=k.x;if(this.ed===t||g.y<this.ed)this.ed=g.y;if(this.bd===t||k.y>this.bd)this.bd=k.y;if(this.fd===t||g.d<this.fd)this.fd=g.d;if(this.cd===t||k.d>this.cd)this.cd=k.d;this.v=[(this.dd+this.ad)/2,
(this.ed+this.bd)/2,(this.fd+this.cd)/2];j.j=u}b&&d.j&&(j=this.jc.get(c),j!=t&&this.a.isBuffer(j.M)&&this.a.deleteBuffer(j.M));j=t;!b||d.j?(j=this.a.createBuffer(),d.Gb(),this.a.bindBuffer(this.a.ARRAY_BUFFER,j),this.a.bufferData(this.a.ARRAY_BUFFER,d.$,this.a.STATIC_DRAW),j=new Yg(j,d.count,3),d.j=u):j=this.jc.get(c);dg(this.V,0.3);b&&e.j&&(g=this.jc.get(c),g!=t&&this.a.isBuffer(g.M)&&this.a.deleteBuffer(g.M));g=t;!b||e.j?(g=this.a.createBuffer(),e.Gb(),this.a.bindBuffer(this.a.ARRAY_BUFFER,g),this.a.bufferData(this.a.ARRAY_BUFFER,
e.$,this.a.STATIC_DRAW),g=new Yg(g,e.count,3),e.j=u):g=this.gd.get(c);dg(this.V,0.3);b&&(f&&f.j)&&(e=this.uc.get(c),e!=t&&this.a.isBuffer(e.M)&&this.a.deleteBuffer(e.M));e=t;f&&(!b||f.j?(f.length!=d.length&&m(Error("Mismatch between points and point colors.")),e=this.a.createBuffer(),f.Gb(),this.a.bindBuffer(this.a.ARRAY_BUFFER,e),this.a.bufferData(this.a.ARRAY_BUFFER,f.$,this.a.STATIC_DRAW),e=new Yg(e,f.count,3),f.j=u):e=this.uc.get(c));dg(this.V,0.2);b&&(n&&n.j)&&(f=this.Gc.get(c),f!=t&&this.a.isBuffer(f.M)&&
this.a.deleteBuffer(f.M));f=t;n&&(f=n.Wc,!b||n.j?(f.length!=d.length&&m(Error("Mismatch between points and scalars.")),d=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,d),this.a.bufferData(this.a.ARRAY_BUFFER,f,this.a.STATIC_DRAW),f=new Yg(d,f.length,3),n.j=u):f=this.Gc.get(c));dg(this.V,0.1);b||this.rb.add(a);this.jc.set(c,j);this.gd.set(c,g);this.uc.set(c,e);this.ic.set(c,h);this.Gc.set(c,f);this.Rd=a.j=u}}else a.j=u}}};
x.Cf=function(a,b){if(this.X.PICKING_ENABLED){this.bc(r,u);var c=new Uint8Array(4);this.a.readPixels(a,this.u-b,1,1,this.a.RGBA,this.a.UNSIGNED_BYTE,c);return c[0]+255*c[1]+65025*c[2]}return-1};
x.Sj=function(a,b,c,d,e,f,g,h){var j=this.a,k=j.createTexture();j.bindTexture(j.TEXTURE_2D,k);j.texImage2D(j.TEXTURE_2D,0,j.RGBA,e,1,0,j.RGBA,j.UNSIGNED_BYTE,c);j.texParameteri(j.TEXTURE_2D,j.TEXTURE_WRAP_S,j.CLAMP_TO_EDGE);j.texParameteri(j.TEXTURE_2D,j.TEXTURE_WRAP_T,j.CLAMP_TO_EDGE);j.texParameteri(j.TEXTURE_2D,j.TEXTURE_MAG_FILTER,j.NEAREST);j.texParameteri(j.TEXTURE_2D,j.TEXTURE_MIN_FILTER,j.NEAREST);j.bindTexture(j.TEXTURE_2D,t);c=j.createTexture();j.bindTexture(j.TEXTURE_2D,c);j.texImage2D(j.TEXTURE_2D,
0,j.RGBA,e,1,0,j.RGBA,j.UNSIGNED_BYTE,d);j.texParameteri(j.TEXTURE_2D,j.TEXTURE_WRAP_S,j.CLAMP_TO_EDGE);j.texParameteri(j.TEXTURE_2D,j.TEXTURE_WRAP_T,j.CLAMP_TO_EDGE);j.texParameteri(j.TEXTURE_2D,j.TEXTURE_MAG_FILTER,j.NEAREST);j.texParameteri(j.TEXTURE_2D,j.TEXTURE_MIN_FILTER,j.NEAREST);j.bindTexture(j.TEXTURE_2D,t);d=j.createTexture();j.bindTexture(j.TEXTURE_2D,d);j.texImage2D(j.TEXTURE_2D,0,j.RGB,b,1,0,j.RGB,j.UNSIGNED_BYTE,a);j.texParameteri(j.TEXTURE_2D,j.TEXTURE_WRAP_S,j.CLAMP_TO_EDGE);j.texParameteri(j.TEXTURE_2D,
j.TEXTURE_WRAP_T,j.CLAMP_TO_EDGE);j.texParameteri(j.TEXTURE_2D,j.TEXTURE_MAG_FILTER,j.NEAREST);j.texParameteri(j.TEXTURE_2D,j.TEXTURE_MIN_FILTER,j.NEAREST);j.bindTexture(j.TEXTURE_2D,t);a=j.createTexture();j.bindTexture(j.TEXTURE_2D,a);j.texImage2D(j.TEXTURE_2D,0,j.RGB,g,1,0,j.RGB,j.UNSIGNED_BYTE,f);j.texParameteri(j.TEXTURE_2D,j.TEXTURE_WRAP_S,j.CLAMP_TO_EDGE);j.texParameteri(j.TEXTURE_2D,j.TEXTURE_WRAP_T,j.CLAMP_TO_EDGE);j.texParameteri(j.TEXTURE_2D,j.TEXTURE_MAG_FILTER,j.NEAREST);j.texParameteri(j.TEXTURE_2D,
j.TEXTURE_MIN_FILTER,j.NEAREST);j.bindTexture(j.TEXTURE_2D,t);this.Jh=k;this.Lh=c;this.Fh=d;this.Eh=b;this.Kh=e;this.Ph=a;this.Oh=g;this.Th=h};
x.bc=function(a,b){xh.B.bc.call(this,a,b);this.a.viewport(0,0,this.A,this.u);this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);var c=this.rb.H,d=c.length;if(0!=d){a?this.a.bindFramebuffer(this.a.FRAMEBUFFER,this.hg):this.a.bindFramebuffer(this.a.FRAMEBUFFER,t);var e=this.K.Ne,f=this.K.o;this.a.uniformMatrix4fv(this.sd.get("perspective"),u,e);this.a.uniformMatrix4fv(this.sd.get("view"),u,f);var g=this.v;this.a.uniform3f(this.sd.get("center"),parseFloat(g[0]),parseFloat(g[1]),parseFloat(g[2]));
var h,j=this.jb.length;for(h=0;h<j;++h){var k=this.jb[h];if(k instanceof Q){var l=k,n=E.g.W(this.K.o,l.s[0]+l.b[0].i[0],l.s[1]+l.b[0].i[1],l.s[2]+l.b[0].i[2]),q=E.g.W(this.K.o,l.s[0]-l.b[0].i[0],l.s[1]-l.b[0].i[1],l.s[2]-l.b[0].i[2]),s=Math.abs(n.d-q.d),n=E.g.W(this.K.o,l.s[0]+l.b[1].i[0],l.s[1]+l.b[1].i[1],l.s[2]+l.b[1].i[2]),q=E.g.W(this.K.o,l.s[0]-l.b[1].i[0],l.s[1]-l.b[1].i[1],l.s[2]+-l.b[1].i[2]),A=Math.abs(n.d-q.d),n=E.g.W(this.K.o,l.s[0]+l.b[2].i[0],l.s[1]+l.b[2].i[1],l.s[2]+l.b[2].i[2]),q=
E.g.W(this.K.o,l.s[0]-l.b[2].i[0],l.s[1]-l.b[2].i[1],l.s[2]-l.b[2].i[2]),z=Math.max(s,A,Math.abs(n.d-q.d));z==s?Ye(l,0):z==A?Ye(l,1):Ye(l,2)}}if(this.X.ORDERING_ENABLED){var G=u,B=this.jb,I;I=B.length-1;do{var w=B[I];if(w instanceof Q&&w.Na&&-1!=w.P){var H=w.c[w.P].c,F=w.P,J=E.g.W(this.K.o,w.s[0]+w.b[F].z[0],w.s[1]+w.b[F].z[1],w.s[2]+w.b[F].z[2]),S=E.g.W(this.K.o,w.s[0]-w.b[F].z[0],w.s[1]-w.b[F].z[1],w.s[2]-w.b[F].z[2]),N=J.d-S.d,O=Math.max(w.rc[w.P],Math.max(w.rc[w.P+4],w.rc[w.P+8])),ea=Math.min(w.rc[w.P],
Math.min(w.rc[w.P+4],w.rc[w.P+8]));if(0>N*(O+ea))for(var P=0,P=0;P<w.ld[F]-1;P++)H[P]&&(H[P].pa=w.pa,H[P].Ba=w.b[F].Ic*P);else for(P=w.ld[F]-1;0<=P;P--)H[P]&&(H[P].pa=w.pa,H[P].Ba=(w.ld[F]-1)*w.b[F].Ic-w.b[F].Ic*P);G=r}}while(I--);var da=this.rb.H,M;M=da.length-1;do if(w=da[M],w.F&&!(1==w.pa||w instanceof Yd)){var Y=w,R,ya=w.h.Kd,Ua=E.g.W(w.ea.N,ya[0],ya[1],ya[2]),ob=E.g.W(this.K.o,Ua.x,Ua.y,Ua.d),pb=E.m.gf(this.K.fc,ob);R=Math.round(1E3*pb)/1E3;Y.Ba=R;G=r}while(M--);G&&this.rb.sort()}var sa=!a&&
b!=t&&b&&this.X.STATISTICS_ENABLED;if(sa)var Fb=0,bc=0,Ze=0,$e=0;var nd=this.Ae,Bh=nd.get("vertexPosition"),Ch=nd.get("vertexNormal"),Cg=nd.get("vertexColor"),Dg=nd.get("vertexTexturePos"),Eg=nd.get("vertexScalar"),T=this.sd,Fg=T.get("usePicking"),Gg=T.get("useObjectColor"),Dh=T.get("objectColor"),Hg=T.get("useScalars"),Eh=T.get("scalarsReplaceMode"),Fh=T.get("scalarsMin"),Gh=T.get("scalarsMax"),Hh=T.get("scalarsMinColor"),Ih=T.get("scalarsMaxColor"),Jh=T.get("scalarsInterpolation"),Kh=T.get("scalarsMinThreshold"),
Lh=T.get("scalarsMaxThreshold"),Ig=T.get("objectOpacity"),Mh=T.get("labelmapOpacity"),Nh=T.get("labelmapColor"),Jg=T.get("useTexture"),Kg=T.get("useLabelMapTexture"),Oh=T.get("textureSampler"),Ph=T.get("textureSampler2"),Qh=T.get("volumeLowerThreshold"),Rh=T.get("volumeUpperThreshold"),Sh=T.get("volumeScalarMin"),Th=T.get("volumeScalarMax"),Uh=T.get("volumeWindowLow"),Vh=T.get("volumeWindowHigh"),Wh=T.get("volumeScalarMinColor"),Xh=T.get("volumeScalarMaxColor"),Lg=T.get("volumeTexture"),Yh=T.get("objectTransform"),
Zh=T.get("pointSize"),$h=T.get("uColorMapSampler"),ai=T.get("uMaxColors"),bi=T.get("uMergeTableKeySampler"),ci=T.get("uMergeTableValueSampler"),di=T.get("uMergeTableLength"),ei=T.get("uUse32bit"),fi=T.get("uThreeDLabels"),gi=T.get("uThreeDLabelsLength"),hi=T.get("uUseThreeDLabels");h=d;do{var fa=c[d-h];if(fa){var Ha=t;fa instanceof Yd&&fa.$a&&(Ha=fa.$a);if(fa.F&&(!Ha||Ha.F)&&(!a||fa.hd)){var Kb=fa.ta,af=fa.$c,Ra=this.jc.get(Kb),Mg=this.gd.get(Kb),bf=this.uc.get(Kb),cf=this.Gc.get(Kb),df=this.ic.get(Kb);
this.a.bindBuffer(this.a.ARRAY_BUFFER,Ra.M);this.a.vertexAttribPointer(Bh,Ra.Nb,this.a.FLOAT,u,0,0);this.a.bindBuffer(this.a.ARRAY_BUFFER,Mg.M);this.a.vertexAttribPointer(Ch,Mg.Nb,this.a.FLOAT,u,0,0);a?this.a.uniform1i(Fg,r):this.a.uniform1i(Fg,u);if(bf&&!a&&!af)this.a.uniform1i(Gg,u),this.a.bindBuffer(this.a.ARRAY_BUFFER,bf.M),this.a.vertexAttribPointer(Cg,bf.Nb,this.a.FLOAT,u,0,0);else{var Ng=1;af&&!a&&(Ng=0);this.a.uniform1i(Gg,Ng);var je=fa.D;a&&(je=[Math.floor(Kb%65025%255)/255,Math.floor(Kb%
65025/255)/255,Math.floor(Kb/65025)/255]);this.a.uniform3f(Dh,parseFloat(je[0]),parseFloat(je[1]),parseFloat(je[2]));this.a.vertexAttribPointer(Cg,Ra.Nb,this.a.FLOAT,u,0,0)}if(cf&&!a&&!af){this.a.uniform1i(Hg,r);this.a.uniform1i(Eh,fa.I.kg);var cc=fa.I.Qb,dc=fa.I.Ob;this.a.uniform3f(Hh,parseFloat(cc[0]),parseFloat(cc[1]),parseFloat(cc[2]));this.a.uniform3f(Ih,parseFloat(dc[0]),parseFloat(dc[1]),parseFloat(dc[2]));this.a.uniform1f(Kh,parseFloat(fa.I.Z));this.a.uniform1f(Lh,parseFloat(fa.I.aa));this.a.uniform1f(Fh,
parseFloat(fa.I.Wa));this.a.uniform1f(Gh,parseFloat(fa.I.ma));this.a.uniform1i(Jh,parseInt(fa.I.Ce,10));this.a.bindBuffer(this.a.ARRAY_BUFFER,cf.M);this.a.vertexAttribPointer(Eg,cf.Nb,this.a.FLOAT,u,0,0)}else this.a.uniform1i(Hg,u),this.a.vertexAttribPointer(Eg,Ra.Nb,this.a.FLOAT,u,0,0);this.a.uniform1f(Ig,parseFloat(fa.pa));fa.C&&df&&!a?(this.a.uniform1i(Jg,r),this.a.activeTexture(this.a.TEXTURE0),this.a.bindTexture(this.a.TEXTURE_2D,this.Lc.get(fa.C.ta)),this.a.uniform1i(Oh,0),this.a.bindBuffer(this.a.ARRAY_BUFFER,
df.M),this.a.vertexAttribPointer(Dg,df.Nb,this.a.FLOAT,u,0,0),this.a.uniform1i(Lg,u)):(this.a.uniform1i(Jg,u),this.a.vertexAttribPointer(Dg,Ra.Nb,this.a.FLOAT,u,0,0));if(Ha){this.a.uniform1i(Lg,r);this.a.uniform1f(Qh,Ha.Z);this.a.uniform1f(Rh,Ha.aa);this.a.uniform1f(Sh,Ha.Wa);this.a.uniform1f(Th,Ha.ma);cc=Ha.Qb;dc=Ha.Ob;this.a.uniform3f(Wh,parseFloat(cc[0]),parseFloat(cc[1]),parseFloat(cc[2]));this.a.uniform3f(Xh,parseFloat(dc[0]),parseFloat(dc[1]),parseFloat(dc[2]));this.a.uniform1f(Uh,Ha.ga);this.a.uniform1f(Vh,
Ha.fa);var od=Ha.e;this.a.uniform1i(Kg,u);Ha.Na&&this.a.uniform1f(Ig,parseFloat(Ha.pa));if(od&&od.F){var ii=fa.e.C.ta;this.a.uniform1i(Kg,r);this.a.activeTexture(this.a.TEXTURE1);this.a.bindTexture(this.a.TEXTURE_2D,this.Lc.get(ii));this.a.uniform1i(Ph,1);this.a.uniform1f(Mh,od.pa);this.a.uniform4fv(Nh,od.Qe);if(od.Id){this.a.uniform1i(ei,1);var na=this.a;na.activeTexture(na.TEXTURE2);na.bindTexture(na.TEXTURE_2D,this.Fh);na.uniform1i($h,2);na.uniform1f(ai,this.Eh);na.activeTexture(na.TEXTURE3);na.bindTexture(na.TEXTURE_2D,
this.Jh);na.uniform1i(bi,3);na.activeTexture(na.TEXTURE4);na.bindTexture(na.TEXTURE_2D,this.Lh);na.uniform1i(ci,4);na.uniform1i(di,this.Kh);na.activeTexture(na.TEXTURE5);na.bindTexture(na.TEXTURE_2D,this.Ph);na.uniform1i(fi,5);na.uniform1i(gi,this.Oh);na.uniform1i(hi,this.Th)}}}this.a.uniformMatrix4fv(Yh,u,fa.ea.N);var Og=1;"POINTS"==fa.Da&&(Og=fa.jd);this.a.uniform1f(Zh,Og);var Cc=-1;fa.Da==kd?(Cc=this.a.TRIANGLES,sa&&(bc+=Ra.Mb/3)):"LINES"==fa.Da?(this.a.lineWidth(fa.Cc),Cc=this.a.LINES,sa&&(Ze+=
Ra.Mb/2)):"POINTS"==fa.Da?(Cc=this.a.POINTS,sa&&($e+=Ra.Mb)):"TRIANGLE_STRIPS"==fa.Da?(Cc=this.a.TRIANGLE_STRIP,sa&&(bc+=Ra.Mb/3)):"POLYGONS"==fa.Da&&(Cc=0==Ra.Mb%3?this.a.TRIANGLES:this.a.TRIANGLE_FAN,sa&&(bc+=Ra.Mb/3));sa&&(Fb+=Ra.Mb);this.a.drawArrays(Cc,0,Ra.Mb)}}}while(--h);if(sa){var hb="Objects: "+d+" | ",hb=hb+("Vertices: "+Fb+" | "),hb=hb+("Triangles: "+Math.round(bc)+" | "),hb=hb+("Lines: "+Ze+" | "),hb=hb+("Points: "+$e+" | "),hb=hb+("Textures: "+this.Lc.fe());window.console.log(hb)}}};
x.remove=function(a){xh.B.remove.call(this,a);if(0<a.c.length)for(var b=a.c,c=b.length,d=0,d=0;d<c;d++)this.remove(b[d]);b=a.ta;c=this.ic.get(b);c!=t&&this.a.isBuffer(c.M)&&this.a.deleteBuffer(c.M);if(a.C&&(c=this.Lc.get(a.C.ta)))this.a.deleteTexture(c),this.Lc.remove(a.C.ta);c=this.jc.get(b);c!=t&&this.a.isBuffer(c.M)&&this.a.deleteBuffer(c.M);c=this.gd.get(b);c!=t&&this.a.isBuffer(c.M)&&this.a.deleteBuffer(c.M);c=this.uc.get(b);c!=t&&this.a.isBuffer(c.M)&&this.a.deleteBuffer(c.M);c=this.Gc.get(b);
c!=t&&this.a.isBuffer(c.M)&&this.a.deleteBuffer(c.M);this.jc.remove(b);this.gd.remove(b);this.uc.remove(b);this.ic.remove(b);this.Gc.remove(b);this.rb.remove(a);return r};x.ae=function(){this.Pe=t;delete this.Pe;this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);xh.B.ae.call(this)};xh.prototype.__defineGetter__("bgColor",v("Vc"));xh.prototype.__defineSetter__("bgColor",ba("Vc"));
xh.prototype.wj=function(a,b,c,d,e){c!=t||(c=4);d!=t||(d=2);if(e==t){e=this.Cf(a,b);if(-1==e)return t;e=this.get(e);if(!e)return t}var f=sg(this.K,2*(a/this.A)-1,2*((this.u-b)/this.u)-1,0);a=sg(this.K,2*(a/this.A)-1,2*((this.u-b)/this.u)-1,1);f[0]+=this.v[0];f[1]+=this.v[1];f[2]+=this.v[2];a[0]+=this.v[0];a[1]+=this.v[1];a[2]+=this.v[2];b=[e.h.fb,e.h.gb,e.h.hb];var g=[e.h.bb,e.h.gb,e.h.hb],h=[e.h.bb,e.h.cb,e.h.hb],j=[e.h.fb,e.h.cb,e.h.hb],k=[e.h.fb,e.h.cb,e.h.eb],l=[e.h.fb,e.h.gb,e.h.eb],n=[e.h.bb,
e.h.cb,e.h.eb],q=[e.h.bb,e.h.gb,e.h.eb];b=[E.g.W(e.ea.N,b[0],b[1],b[2]),E.g.W(e.ea.N,g[0],g[1],g[2]),E.g.W(e.ea.N,h[0],h[1],h[2]),E.g.W(e.ea.N,j[0],j[1],j[2]),E.g.W(e.ea.N,k[0],k[1],k[2]),E.g.W(e.ea.N,l[0],l[1],l[2]),E.g.W(e.ea.N,n[0],n[1],n[2]),E.g.W(e.ea.N,q[0],q[1],q[2])];var g=[Infinity,-Infinity,Infinity,-Infinity,Infinity,-Infinity],s;for(s in b)s=b[s],g=[Math.min(g[0],s.x),Math.max(g[1],s.x),Math.min(g[2],s.y),Math.max(g[3],s.y),Math.min(g[4],s.d),Math.max(g[5],s.d)];s=g;b=[];g=[];for(h=0;6>
h;h++){var j=Math.floor(h/2),k=(j+1)%3,l=(j+2)%3,q=(2+2*j)%6,A=(4+2*j)%6,z=(s[h]-f[j])*(1/a[j]);Infinity!=z&&-Infinity!=z&&(n=f[k]+a[k]*z,z=f[l]+a[l]*z,n>=s[q]&&n<=s[q+1]&&z>=s[A]&&z<=s[A+1]?(q=[],q[j]=s[h],q[k]=n,q[l]=z,b.push(q)):(q=[],q[j]=s[h],q[k]=n,q[l]=z,g.push(q)))}a=[b,g];a=a[0];if(0==a.length)return t;g=Array(2);for(s=0;2>s;s++)b=a[s],g[s]=Math.sqrt((b[0]-f[0])*(b[0]-f[0])+(b[1]-f[1])*(b[1]-f[1])+(b[2]-f[2])*(b[2]-f[2]));f=b=s=t;g[0]<g[1]?(s=a[0],b=a[1]):(s=a[1],b=a[0]);f=Math.sqrt((s[0]-
b[0])*(s[0]-b[0])+(s[1]-b[1])*(s[1]-b[1])+(s[2]-b[2])*(s[2]-b[2]));f/=c;a=s;s=[b[0]-s[0],b[1]-s[1],b[2]-s[2]];b=Math.sqrt(s[0]*s[0]+s[1]*s[1]+s[2]*s[2]);g=[s[0]/b,s[1]/b,s[2]/b];h=e.h.$;j=h.length;for(s=0;s<f;s+=c){a=[a[0]+c*g[0],a[1]+c*g[1],a[2]+c*g[2]];for(b=0;b<j;b+=3)if(k=h[b],l=h[b+1],n=h[b+2],q=new E.m(k,l,n),q=E.g.W(e.ea.N,k,l,n),Math.sqrt((a[0]-q.x)*(a[0]-q.x)+(a[1]-q.y)*(a[1]-q.y)+(a[2]-q.d)*(a[2]-q.d))<=d)return[q.x,q.y,q.d]}return t};C("X.renderer3D",xh);
C("X.renderer3D.prototype.init",xh.prototype.wa);C("X.renderer3D.prototype.add",xh.prototype.add);C("X.renderer3D.prototype.onShowtime",xh.prototype.Wg);C("X.renderer3D.prototype.onRender",xh.prototype.Ug);C("X.renderer3D.prototype.get",xh.prototype.get);C("X.renderer3D.prototype.render",xh.prototype.ac);C("X.renderer3D.prototype.destroy",xh.prototype.ae);C("X.renderer3D.prototype.remove",xh.prototype.remove);C("X.renderer3D.prototype.resetBoundingBox",xh.prototype.Aj);
C("X.renderer3D.prototype.resetViewAndRender",xh.prototype.Fd);C("X.renderer3D.prototype.pick",xh.prototype.Cf);C("X.renderer3D.prototype.pick3d",xh.prototype.wj);C("X.renderer3D.prototype.updateFromDojo",xh.prototype.Sj);function yh(){W.call(this);this.f="fibers";Fa(this,new zc)}D(yh,W);C("X.fibers",yh);function zh(){Ug.call(this);this.f="renderer2D";this.Ma=t;this.Ca=-1;this.Rb=[];this.ag=this.Pd=this.Xf=this.Nd=t;this.Hc=this.Jc=this.md=this.od=0;this.fa=this.ga=this.aa=this.Z=this.Uf=-1;this.bg=new Float32Array([-255,-255,-255,-255]);this.ig=r}D(zh,Ug);zh.prototype.hj=aa();zh.prototype.rj=aa();zh.prototype.zf=function(a){zh.B.zf.call(this,a);var b=this.jb[0];if(b){var c="",c=0==this.Ca?"indexX":1==this.Ca?"indexY":"indexZ";b[c]=a.ja?b[c]+1:b[c]-1;eval("this.onScroll();")}};
zh.prototype.sj=function(a){var b=this.jb[0];if(b){var c=b.fa-b.ga,d=c/2,e=parseInt(c+c/15*-a.Ue,10);a=parseInt(d+d/15*a.He,10);c==e&&e++;d==a&&a++;b.ga-=parseInt(d-a,10);b.ga-=parseInt(c-e,10);b.ga=Math.max(b.ga,b.Wa);b.fa-=parseInt(d-a,10);b.fa+=parseInt(c-e,10);b.fa=Math.min(b.fa,b.ma);eval("this.onWindowLevel();")}};zh.prototype.__defineGetter__("orientation",v("Ma"));
zh.prototype.__defineSetter__("orientation",function(a){a=a.toUpperCase();"AXIAL"==a?(a="Z",this.Ca=2):"SAGITTAL"==a?(a="X",this.Ca=0):"CORONAL"==a&&(a="Y",this.Ca=1);"X"!=a&&("Y"!=a&&"Z"!=a)&&m(Error("Invalid orientation."));this.Ma=a});zh.prototype.__defineGetter__("radiological",v("ig"));zh.prototype.__defineSetter__("radiological",ba("ig"));x=zh.prototype;
x.wa=function(){this.Ma||m(Error("No 2D orientation set."));zh.B.wa.call(this,"2d");this.a.fillStyle="rgba(50,50,50,0)";this.a.fillRect(0,0,this.Aa.width,this.Aa.height);this.Nd=ne("canvas");this.Pd=ne("canvas");K(this.K,Bd,this.sj.bind(this))};x.yf=function(){zh.B.yf.call(this);Ah(this)};x.Fd=function(){zh.B.Fd.call(this);Ah(this);var a=this.jb[0];a&&(a.fa=a.ma,a.ga=a.Wa)};
x.vb=function(a){zh.B.vb.call(this,a);var b=u;this.get(a.ta)&&(b=r);if(a instanceof Q){var c=a.q,d=a.e,e=a.Fa;if(d!=t&&d.q!=t&&d.q.j)this.vb(d);else if(e!=t&&e.q!=t&&e.q.j)this.V.load(e,a);else{if(c!=t&&ja(c))if(a.qc!=t){if(a.qc.mf!=c.length||b&&!a.j)return}else{b=0;d=c.length;for(b=0;b<d;b++)this.V.load(c[b],a);return}else if(c!=t&&c.j){this.V.load(a,a);return}this.Ca="X"==this.Ma?0:"Y"==this.Ma?1:2;this.Za=a.c[this.Ca].c;e=t;e=0==this.Ca?a.indexX:1==this.Ca?a.indexY:a.indexZ;c=a.c[this.Ca].c[e].$f;
d=a.c[this.Ca].c[e].Zf;this.Jc=a.c[this.Ca].c[e].Mc;this.Hc=a.c[this.Ca].c[e].wc;this.od=c;this.md=d;e=this.Nd;e.width=c;e.height=d;var f=this.Pd;f.width=c;f.height=d;this.Xf=e.getContext("2d");this.ag=f.getContext("2d");b||(this.rb.add(a),Ah(this))}}};function Ah(a){var b=Math.min(a.A/(a.od*a.Jc),a.u/(a.md*a.Hc));a.K.o[14]=b}x.ij=aa();
x.sh=function(a,b){var c=this.jb[0],d=this.K.o,e=t,f=this.od,g=this.md,h=t,j=t;if("Y"==this.Ma)e=this.Za[parseInt(c.indexY,10)],h=e.Mc,j=e.wc,this.Rb[0]="red",this.Rb[1]="blue";else if("Z"==this.Ma)e=this.Za[parseInt(c.indexZ,10)],h=e.Mc,j=e.wc,this.Rb[0]="red",this.Rb[1]="green";else{e=this.Za[parseInt(c.indexX,10)];h=e.wc;j=e.Mc;this.Rb[0]="green";this.Rb[1]="blue";var k=f,f=g,g=k}var l=1*d[12],n=-1*d[13],k=Math.max(d[14],0.6),d=[this.A/2,this.u/2],h=f*h*k,j=g*j*k,q=d[0]-h/2,d=d[1]-j/2,q=q+l*k,
d=d+n*k;return a>q&&a<q+h&&b>d&&b<d+j?(l=(a-q)/h*f,n=(b-d)/j*g,j=e.Vh[4],"X"==this.Ma?(k=f-l,l=n,n=k):"Y"==this.Ma?l=f-l:"Z"==this.Ma&&(l=f-l,n=g-n),l=e.Uh+l*e.Mc,n=e.Ih+n*e.wc,l=Tc(l,n,j,1),f=Uc(),ed(e.zh,l,f),g=Uc(),ed(e.Ah,l,g),e=Math.round((c.b[0].i[0]*g[0]+c.b[0].i[1]*g[1]+c.b[0].i[2]*g[2]+c.b[0].Le)/c.b[0].Ic),e>=c.b[0].r?e=c.b[0].r-1:0>e&&(e=0),l=Math.round((c.b[1].i[0]*g[0]+c.b[1].i[1]*g[1]+c.b[1].i[2]*g[2]+c.b[1].Le)/c.b[1].Ic),l>=c.b[1].r?l=c.b[1].r-1:0>l&&(l=0),n=Math.round((c.b[2].i[0]*
g[0]+c.b[2].i[1]*g[1]+c.b[2].i[2]*g[2]+c.b[2].Le)/c.b[2].Ic),n>=c.b[2].r?n=c.b[2].r-1:0>n&&(n=0),[[e,l,n],[f[0],f[1],f[2]],[g[0],g[1],g[2]]]):t};
x.bc=function(a,b){zh.B.bc.call(this,a,b);if(0!=this.rb.H.length){var c=this.jb[0],d=t,d=0==this.Ca?c.indexX:1==this.Ca?c.indexY:c.indexZ,e=this.Za[parseInt(d,10)].$f,f=this.Za[parseInt(d,10)].Zf;this.Jc=this.Za[parseInt(d,10)].Mc;this.Hc=this.Za[parseInt(d,10)].wc;this.od=e;this.md=f;var g=this.A,h=this.u,j=this.K.o;this.a.save();this.a.clearRect(-g,-h,2*g,2*h);this.a.restore();var k=Math.max(j[14],0.1);this.a.setTransform(k,0,0,k,0,0);var l=1*j[12],j=-1*j[13],n=t;c.e&&(n=c.e.Qe);var q=this.Za[parseInt(d,
10)],s=q.C.ib,q=q.e,A=t;q&&(A=q.ib);var z=this.od,G=this.md,B=this.Xf,I=this.ag,w=B.getImageData(0,0,z,G),H=I.getImageData(0,0,z,G),F=w.data,J=H.data,S=F.length,N=c.ma,O=c.Z,ea=c.aa,P=c.ga/N,da=c.fa/N;if(this.Uf!=d||this.Z!=O||this.aa!=ea||this.ga!=P||this.fa!=da||n&&!og(n,this.bg,0)){var M=this.Nd;M.width=e;M.height=f;M=this.Pd;M.width=e;M.height=f;e=0;do{var M=[0,0,0,0],f=[0,0,0,0],Y=s[e]/255*N,R=s[e],R=(R/255-P)/(da-P),R=255*R;Y>=O&&Y<=ea&&(M=new U(c.Qb[0],c.Qb[1],c.Qb[2]),M=(new U(c.Ob[0],c.Ob[1],
c.Ob[2])).scale(R).add(M.scale(255-R)),M=[Math.floor(M.x),Math.floor(M.y),Math.floor(M.d),255],q&&(-255==n[3]?f=[A[e],A[e+1],A[e+2],A[e+3]]:og(n,A,e)&&(f=[A[e],A[e+1],A[e+2],A[e+3]])));"X"==this.Ma?(F[e]=M[0],F[e+1]=M[1],F[e+2]=M[2],F[e+3]=M[3],J[e]=f[0],J[e+1]=f[1],J[e+2]=f[2],J[e+3]=f[3]):"Y"==this.Ma?(R=Math.floor(e/(4*z)),R=4*R*z+(4*(z-1)-(e-4*R*z)),F[R]=M[0],F[R+1]=M[1],F[R+2]=M[2],F[R+3]=M[3],J[R]=f[0],J[R+1]=f[1],J[R+2]=f[2],J[R+3]=f[3]):(R=S-1-e,F[R-3]=M[0],F[R-2]=M[1],F[R-1]=M[2],F[R]=M[3],
J[R-3]=f[0],J[R-2]=f[1],J[R-1]=f[2],J[R]=f[3]);e+=4}while(e<S);B.putImageData(w,0,0);I.putImageData(H,0,0);this.Uf=d;this.Z=O;this.aa=ea;this.ga=P;this.fa=da;q&&(this.bg=n)}this.a.globalAlpha=1;this.a.translate(g/2/k,h/2/k);"X"==this.Ma&&(this.a.rotate(0.5*Math.PI),d=l,l=j,j=-d);l=-z*this.Jc/2+l;j=-G*this.Hc/2+j;this.a.drawImage(this.Nd,l,j,z*this.Jc,G*this.Hc);q&&c.e.F&&(this.a.globalAlpha=c.e.pa,this.a.drawImage(this.Pd,l,j,z*this.Jc,G*this.Hc));if(this.X.SLICENAVIGATORS&&(this.S.Ie&&this.S.mg&&
!this.S.qb)&&(l=this.S.oa,l=this.sh(l[0],l[1])))c.Ab=l[0][0],c.Bb=l[0][1],c.Cb=l[0][2],c.p(u),this.onSliceNavigation(),this.a.setTransform(1,0,0,1,0,0),this.a.lineWidth=1,this.a.beginPath(),this.a.moveTo(this.S.oa[0],0),this.a.lineTo(this.S.oa[0],this.S.oa[1]-10),this.a.moveTo(this.S.oa[0],this.S.oa[1]+10),this.a.lineTo(this.S.oa[0],this.u),this.a.strokeStyle=this.Rb[0],this.a.stroke(),this.a.closePath(),this.a.beginPath(),this.a.moveTo(0,this.S.oa[1]),this.a.lineTo(this.S.oa[0]-10,this.S.oa[1]),
this.a.moveTo(this.S.oa[0]+10,this.S.oa[1]+0.5),this.a.lineTo(this.A,this.S.oa[1]),this.a.strokeStyle=this.Rb[1],this.a.stroke(),this.a.closePath(),this.a.font="10pt Arial",this.a.textAlign="left",this.a.textBaseline="top",this.a.fillStyle="white",this.a.fillText("RAS: "+l[2][0].toFixed(2)+", "+l[2][1].toFixed(2)+", "+l[2][2].toFixed(2),0,0),z=q=j="undefined","undefined"!=typeof c.sa[l[1][2].toFixed(0)]&&"undefined"!=typeof c.sa[l[1][2].toFixed(0)][l[1][1].toFixed(0)]&&(j=c.sa[l[1][2].toFixed(0)][l[1][1].toFixed(0)][l[1][0].toFixed(0)],
c.ba&&(q=c.e.sa[l[1][2].toFixed(0)][l[1][1].toFixed(0)][l[1][0].toFixed(0)],c.e.Sf&&(z=c.e.Sf.get(q),"undefined"!=typeof z&&(z=z[0])))),this.a.fillText("Background:  "+j+" ("+l[1][0].toFixed(0)+", "+l[1][1].toFixed(0)+", "+l[1][2].toFixed(0)+")",0,15),c.ba&&this.a.fillText("Labelmap:  "+z+" ("+q+")",0,30)}};C("X.renderer2D",zh);C("X.renderer2D.prototype.init",zh.prototype.wa);C("X.renderer2D.prototype.add",zh.prototype.add);C("X.renderer2D.prototype.onShowtime",zh.prototype.Wg);
C("X.renderer2D.prototype.onRender",zh.prototype.Ug);C("X.renderer2D.prototype.onScroll",zh.prototype.hj);C("X.renderer2D.prototype.onWindowLevel",zh.prototype.rj);C("X.renderer2D.prototype.get",zh.prototype.get);C("X.renderer2D.prototype.resetViewAndRender",zh.prototype.Fd);C("X.renderer2D.prototype.xy2ijk",zh.prototype.sh);C("X.renderer2D.prototype.render",zh.prototype.ac);C("X.renderer2D.prototype.destroy",zh.prototype.ae);C("X.renderer2D.prototype.onSliceNavigation",zh.prototype.ij);function ji(){W.call(this);this.f="mesh";Fa(this,new zc)}D(ji,W);C("X.mesh",ji);
